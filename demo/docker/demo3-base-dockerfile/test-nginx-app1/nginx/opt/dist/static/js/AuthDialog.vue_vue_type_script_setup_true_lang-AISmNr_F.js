var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,t=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r;import{g as c,e as i}from"./DeviceManage-aryRM0Sb.js";import{d as u,a8 as n,A as d,a0 as p,H as f,r as v,o as m,g as b,h as g,e as h,b as y,f as j,u as C,ab as w,c as O,J as _,L as x,a9 as P,a1 as k,a6 as V}from"./index-OtYEJMgP.js";const D={class:"dialog-footer"},A=u((I=((e,a)=>{for(var l in a||(a={}))o.call(a,l)&&t(e,l,a[l]);if(r)for(var l of r(a))s.call(a,l)&&t(e,l,a[l]);return e})({},{name:"DeviceAuthDialog"}),a(I,l({__name:"AuthDialog",emits:["register","confirm"],setup(e,{emit:a}){let l="";const r=a,[o,{closeDialog:s}]=n((e=>{const{type:a,data:r}=e;if(l=a,"edit"===a){const{deviceCode:e,resourceIds:a}=r||{};Object.assign(q,{deviceCode:e,resource:a.split(",")})}})),t=d(!1),u=d(null),A={deviceCode:[{required:!0,message:"请填写设备编码！",trigger:"blur"},{max:32,message:"设备编码长度不能超过32位！",trigger:"blur"}],resource:[{required:!0,message:"请选择资源！",trigger:"change"}]},I=[{label:"APP服务",value:"js-zygk-app-api"}],q=p({deviceCode:"",resource:[]}),E=function(){var e;t.value=!1,s(),l="",Object.keys(q).forEach((e=>{q[e]="resource"===e?[]:""})),null==(e=u.value)||e.clearValidate()},R=function(){var e;null==(e=u.value)||e.validate((e=>{return a=this,o=null,s=function*(){if(e){t.value=!0;const{deviceCode:e,resource:a}=q;"add"===l?c({deviceCode:e,resourceIds:a.join(",")}).then((e=>{k!==e&&(V.success("添加成功！"),E(),r("confirm"))})).finally((()=>{t.value=!1})):"edit"===l?i({deviceCode:e,resourceIds:a.join(",")}).then((e=>{k!==e&&(V.success("编辑成功！"),E(),r("confirm"))})).finally((()=>{t.value=!1})):t.value=!1}},new Promise(((e,l)=>{var r=e=>{try{c(s.next(e))}catch(a){l(a)}},t=e=>{try{c(s.throw(e))}catch(a){l(a)}},c=a=>a.done?e(a.value):Promise.resolve(a.value).then(r,t);c((s=s.apply(a,o)).next())}));var a,o,s}))};return f((()=>{E()})),(e,a)=>{const r=v("el-input"),s=v("el-form-item"),c=v("el-option"),i=v("el-select"),n=v("el-button");return m(),b(C(P),{width:"480px","show-fullscreen":!1,"show-close":!1,"close-on-click-modal":!1,"destroy-on-close":"",center:"",onClose:E,onRegister:C(o)},{footer:g((()=>[h("span",D,[y(n,{class:"basic-button",disabled:t.value,onClick:E},{default:g((()=>[j(" 取消 ")])),_:1},8,["disabled"]),y(n,{class:"basic-button",loading:t.value,onClick:R},{default:g((()=>[j(" 保存 ")])),_:1},8,["loading"])])])),default:g((()=>[y(C(w),{ref_key:"refAuthForm",ref:u,model:q,rules:A,"label-width":"120px","label-suffix":"："},{default:g((()=>[y(s,{label:"设备编码",prop:"deviceCode"},{default:g((()=>[y(r,{modelValue:q.deviceCode,"onUpdate:modelValue":a[0]||(a[0]=e=>q.deviceCode=e),clearable:"",maxlength:"32","show-word-limit":"",placeholder:"请填写设备编码",disabled:"edit"===C(l),formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1}),y(s,{label:"资源",prop:"resource"},{default:g((()=>[y(i,{modelValue:q.resource,"onUpdate:modelValue":a[1]||(a[1]=e=>q.resource=e),placeholder:"请选择资源",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:g((()=>[(m(),O(_,null,x(I,(e=>y(c,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["onRegister"])}}}))));var I;export{A as _};
