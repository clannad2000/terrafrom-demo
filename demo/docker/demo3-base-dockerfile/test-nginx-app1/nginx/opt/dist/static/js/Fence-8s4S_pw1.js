var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{d as n,z as i,Y as p,a0 as c,A as u,V as f,r as g,j as d,o as w,c as m,e as h,b as v,h as b,f as y,w as x,u as C,aL as _,v as j,I as k,M as z,a5 as P,a1 as F,a6 as N,X as O,_ as S}from"./index-OtYEJMgP.js";import{a as E,b as R}from"./ElectronicFence-d-yifEca.js";import{u as D}from"./ElectronicFence-HI2dfd04.js";import I from"./FenceEditDialog-O-ca5aKM.js";import"./icon_no_data-JkxAPqfn.js";import"./constants-uiyZ18jc.js";const M={class:"table-container tree-container w-full h-full flex flex-col gap-y-2"},T={class:"flex flex-row items-center"},U={class:"flex-1 flex flex-row"},A=n((B=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&s(e,t,a[t]);if(l)for(var t of l(a))r.call(a,t)&&s(e,t,a[t]);return e})({},{name:"Fence"}),a(B,t({__name:"Fence",setup(e){const[a,{showDialog:t,setDialogProps:l}]=i(),o=p(),r=e=>{D().setFenceParams({type:"view",value:e})},s=c({pageNum:1,pageSize:10,total:0}),n=()=>{L()},S=()=>{s.pageNum=1,L()},A=u(!1),B=p([]),L=P((()=>{return e=this,a=null,t=function*(){A.value=!0;const{pageSize:e,pageNum:a}=s;yield R({pageSize:e,pageNum:a}).then((e=>{if(F!==e){const{rows:a=[],total:t=0}=e;B.value=a,s.total=Number(t)||0}})).finally((()=>{A.value=!1})),O((()=>{var e;B.value.length?(D().setFenceParams({type:"view",value:B.value[0]}),e=B.value[0],o.value.setCurrentRow(e)):D().setFenceParams({type:null,value:{}})}))},new Promise(((l,o)=>{var r=e=>{try{n(t.next(e))}catch(a){o(a)}},s=e=>{try{n(t.throw(e))}catch(a){o(a)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,s);n((t=t.apply(e,a)).next())}));var e,a,t}),1e3),V=()=>{l({title:"创建围栏"}),t(!0,{type:"add",data:null})};return f((()=>{s.pageNum=1,L()})),(e,i)=>{const p=g("el-button"),c=g("el-table-column"),u=g("el-popconfirm"),f=g("el-auto-resizer"),P=g("el-pagination"),O=d("loading");return w(),m("div",M,[h("div",T,[v(p,{class:"basic-button",onClick:V},{default:b((()=>[y(" 创建围栏 ")])),_:1})]),x((w(),m("div",U,[v(f,null,{default:b((({height:e,width:a})=>[v(C(_),{ref_key:"tableRef",ref:o,class:"cursor-pointer",height:e,data:B.value,"show-overflow-tooltip":"",style:j({width:a+"px"}),"highlight-current-row":"",onCurrentChange:r},{default:b((()=>[v(c,{prop:"name",align:"center",label:"围栏名称","min-width":"120","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),v(c,{prop:"shapeType",align:"center",label:"形状","min-width":"120","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:b((({row:e})=>[y(k("1"===e.shapeType?"圆形":"2"===e.shapeType?"多边形":""),1)])),_:1}),v(c,{prop:"fenceMode",align:"center",label:"模式","min-width":"120","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:b((({row:e})=>[y(k("1"===e.fenceMode?"禁止离开":"2"===e.fenceMode?"禁止进入":""),1)])),_:1}),v(c,{prop:"createdByName",align:"center",label:"创建者","min-width":"120","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),v(c,{prop:"enabledFlag",align:"center",label:"启用状态","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:b((({row:e})=>[y(k("1"===e.enabledFlag?"启用":"0"===e.enabledFlag?"未启用":""),1)])),_:1}),v(c,{fixed:"right",label:"操作",width:"120",align:"center"},{default:b((({row:e})=>[v(p,{type:"primary",link:"",onClick:a=>{return o=e,l({title:"编辑围栏"}),void t(!0,{type:"edit",data:o});var o}},{default:b((()=>[y(" 更新 ")])),_:2},1032,["onClick"]),v(u,{title:"是否确认删除?",onConfirm:a=>(e=>{const{id:a}=e;A.value=!0,E({fenceId:a}).then((e=>{F!==e&&(s.pageNum=1,L(),N.success("删除围栏成功!"))})).finally((()=>{A.value=!1}))})(e)},{reference:b((()=>[v(p,{link:"",type:"danger",onClick:i[0]||(i[0]=z((()=>{}),["stop"]))},{default:b((()=>[y(" 删除 ")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:2},1032,["height","data","style"])])),_:1})])),[[O,A.value]]),v(P,{ref:"paginationRef","current-page":s.pageNum,"onUpdate:currentPage":i[1]||(i[1]=e=>s.pageNum=e),"page-size":s.pageSize,"onUpdate:pageSize":i[2]||(i[2]=e=>s.pageSize=e),small:"",background:"",layout:"total, sizes, prev, pager, next",total:s.total,"pager-count":5,"page-sizes":[10,20,30,40,50,100],onSizeChange:S,onCurrentChange:n},null,8,["current-page","page-size","total"]),v(I,{onRegister:C(a),onConfirm:S},null,8,["onRegister"])])}}}))));var B;const L=S(A,[["__scopeId","data-v-81153c28"]]);export{L as default};
