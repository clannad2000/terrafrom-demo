var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o;import{J as p}from"./JobOverview-wJdELtdM.js";import{d as i,A as n,n as c,a0 as m,Y as u,a8 as w,H as g,r as b,o as d,g as f,h as v,e as k,b as h,c as x,J as y,L as j,u as N,a2 as C,f as P,a9 as _,a5 as z,a1 as L}from"./index-OtYEJMgP.js";const O={class:"flex-1 flex flex-col gap-y-4"},R=i((V=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&r(e,l,a[l]);if(o)for(var l of o(a))t.call(a,l)&&r(e,l,a[l]);return e})({},{name:"ImportantJobPlanStatDialog"}),a(V,l({__name:"StatDialog",emits:["register","confirm"],setup(e,{emit:a}){const l=n(!1),o=c((()=>"今日重点作业")),s=m({taskName:"",majorTypes:[],workRiskLevels:[],workProgress:[]}),t=m({pageNum:1,pageSize:10,total:0}),r=u([]),i=z((()=>{return e=this,a=null,o=function*(){r.value=[],l.value=!0;const{pageSize:e,pageNum:a}=t,{majorTypes:o,workRiskLevels:i,workProgress:n,taskName:c}=s;p({majorType:o.join(","),workRiskLevel:i.join(","),workProgress:n.join(","),taskName:c,pageSize:e,pageNum:a}).then((e=>{if(e&&L!==e){const{rows:a=[],total:l=0}=e;r.value=a,t.total=Number(l)||0}})).finally((()=>{l.value=!1}))},new Promise(((l,s)=>{var t=e=>{try{p(o.next(e))}catch(a){s(a)}},r=e=>{try{p(o.throw(e))}catch(a){s(a)}},p=e=>e.done?l(e.value):Promise.resolve(e.value).then(t,r);p((o=o.apply(e,a)).next())}));var e,a,o}),1e3),R=()=>{t.pageNum=1,i()},V=()=>{R()},S=()=>{i()},[T,{closeDialog:U}]=w((e=>{const{type:a,data:l}=e;"view"===a&&(Object.keys(l).forEach((e=>{s[e]=l[e]})),R())})),D=function(){l.value=!1,U(),Object.assign(s,{majorTypes:[],workRiskLevels:[],workProgress:[],taskName:""}),Object.assign(t,{pageNum:1,pageSize:10,total:0}),r.value=[]};return g((()=>{D()})),(e,a)=>{const p=b("el-input"),i=b("el-form-item"),n=b("el-option"),c=b("el-select"),m=b("el-button"),u=b("el-form"),w=b("el-table-column"),g=b("el-table"),z=b("el-pagination");return d(),f(N(_),{width:"80%","show-close":!0,center:"","destroy-on-close":"","close-on-click-modal":!1,title:o.value,onClose:D,onRegister:N(T)},{default:v((()=>[k("div",O,[h(u,{ref:"searchFormRef",inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:v((()=>[h(i,{label:"任务名称",class:"m-0"},{default:v((()=>[h(p,{modelValue:s.taskName,"onUpdate:modelValue":a[0]||(a[0]=e=>s.taskName=e),clearable:"",maxlength:"20",placeholder:"请输入任务名称",formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,"")},null,8,["modelValue","formatter","parser"])])),_:1}),h(i,{label:"专业",class:"m-0"},{default:v((()=>[h(c,{modelValue:s.majorTypes,"onUpdate:modelValue":a[1]||(a[1]=e=>s.majorTypes=e),placeholder:"请选择专业",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:v((()=>[(d(!0),x(y,null,j(N(C)().workerMajorList,(e=>(d(),f(n,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(i,{label:"作业风险等级",class:"m-0"},{default:v((()=>[h(c,{modelValue:s.workRiskLevels,"onUpdate:modelValue":a[2]||(a[2]=e=>s.workRiskLevels=e),placeholder:"请选择作业风险等级",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:v((()=>[(d(!0),x(y,null,j(N(C)().workRiskLevelList,(e=>(d(),f(n,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(i,{label:"作业状态",class:"m-0"},{default:v((()=>[h(c,{modelValue:s.workProgress,"onUpdate:modelValue":a[3]||(a[3]=e=>s.workProgress=e),placeholder:"请选择作业状态",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:v((()=>[(d(!0),x(y,null,j(N(C)().workProgressList.filter((e=>["2101001","2101002","2101004"].includes(e.code))),(e=>(d(),f(n,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(i,{label:"",class:"m-0"},{default:v((()=>[h(m,{class:"basic-button",loading:l.value,onClick:R},{default:v((()=>[P(" 查询 ")])),_:1},8,["loading"])])),_:1})])),_:1},512),h(g,{class:"w-full h-96",data:r.value,"show-overflow-tooltip":""},{default:v((()=>[h(w,{prop:"taskName",align:"center",label:"任务名称","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"voltageLevelName",align:"center",label:"电压等级","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"majorTypeName",align:"center",label:"所属专业","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"beginTime",align:"center",label:"计划开始时间","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"endTime",align:"center",label:"计划结束时间","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"workContent",align:"center",label:"作业内容","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"workRiskLevelName",align:"center",label:"作业风险等级","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"cityName",align:"center",label:"地市","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"countyName",align:"center",label:"区县","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"fzrRealName",align:"center",label:"工作负责人","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),h(w,{prop:"workProgressName",align:"center",label:"作业状态","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}})])),_:1},8,["data"]),h(z,{"current-page":t.pageNum,"onUpdate:currentPage":a[4]||(a[4]=e=>t.pageNum=e),"page-size":t.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>t.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:V,onCurrentChange:S},null,8,["current-page","page-size","total"])])])),_:1},8,["title","onRegister"])}}}))));var V;export{R as _};
