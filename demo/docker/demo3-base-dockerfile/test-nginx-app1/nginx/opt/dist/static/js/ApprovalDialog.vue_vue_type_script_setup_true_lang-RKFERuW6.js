var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{j as i}from"./DeviceManage-aryRM0Sb.js";import{d as u,a8 as n,A as d,n as c,a0 as p,H as f,r as m,o as b,g,h as v,e as O,b as h,f as y,u as w,ab as _,a9 as j,a1 as R,a6 as x}from"./index-OtYEJMgP.js";const P={class:"dialog-footer"},V=u((D=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&s(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&s(e,l,a[l]);return e})({},{name:"ApprovalDialog"}),a(D,l({__name:"ApprovalDialog",emits:["register","confirm"],setup(e,{emit:a}){const l=a,[t,{closeDialog:r}]=n((e=>{const{type:a,data:l}=e;if("approval"===a){const{id:e}=l;Object.assign(V,{replaceId:e})}})),o=d(null),s=d(!1),u=c((()=>({auditResult:[{required:!0,message:"请选择审批结果！",trigger:"change"}],auditOpinion:[{required:"0"==V.auditResult,message:"请填写审批意见！",trigger:"blur"},{max:256,message:"审批意见长度不能超过256位！",trigger:"blur"}]}))),V=p({replaceId:"",auditOpinion:"",auditResult:""}),D=function(){var e;s.value=!1,r(),Object.keys(V).forEach((e=>{V[e]=""})),null==(e=o.value)||e.clearValidate()},I=function(){var e;null==(e=o.value)||e.validate((e=>{return a=this,t=null,r=function*(){if(e){s.value=!0;const{replaceId:e,auditResult:a,auditOpinion:t}=V;i({replaceId:e,auditResult:a,auditOpinion:t}).then((e=>{R!==e&&(x.success("审核成功！"),D(),l("confirm"))})).finally((()=>{s.value=!1}))}},new Promise(((e,l)=>{var o=e=>{try{i(r.next(e))}catch(a){l(a)}},s=e=>{try{i(r.throw(e))}catch(a){l(a)}},i=a=>a.done?e(a.value):Promise.resolve(a.value).then(o,s);i((r=r.apply(a,t)).next())}));var a,t,r}))};return f((()=>{D()})),(e,a)=>{const l=m("el-radio"),r=m("el-radio-group"),i=m("el-form-item"),n=m("el-input"),d=m("el-button");return b(),g(w(j),{width:"600","show-fullscreen":!1,"show-close-icon":!1,"destroy-on-close":"",onClose:D,onRegister:w(t)},{footer:v((()=>[O("span",P,[h(d,{class:"basic-button",disabled:s.value,onClick:D},{default:v((()=>[y(" 取消 ")])),_:1},8,["disabled"]),h(d,{class:"basic-button",loading:s.value,onClick:I},{default:v((()=>[y(" 保存 ")])),_:1},8,["loading"])])])),default:v((()=>[h(w(_),{ref_key:"refApprovalForm",ref:o,model:V,rules:u.value,"label-width":"180px","label-suffix":"："},{default:v((()=>[h(i,{label:"审批结果",prop:"auditResult"},{default:v((()=>[h(r,{modelValue:V.auditResult,"onUpdate:modelValue":a[0]||(a[0]=e=>V.auditResult=e),class:"ml-4"},{default:v((()=>[h(l,{label:"1"},{default:v((()=>[y("通过")])),_:1}),h(l,{label:"-1"},{default:v((()=>[y("回退")])),_:1})])),_:1},8,["modelValue"])])),_:1}),h(i,{label:"审批意见",prop:"auditOpinion"},{default:v((()=>[h(n,{modelValue:V.auditOpinion,"onUpdate:modelValue":a[1]||(a[1]=e=>V.auditOpinion=e),clearable:"",maxlength:"256","show-word-limit":"",rows:4,type:"textarea",placeholder:"请填写审批意见",parser:e=>e.replace(/^\s*|\s*$/g,""),formatter:e=>e.replace(/^\s*|\s*$/g,"")},null,8,["modelValue","parser","formatter"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["onRegister"])}}}))));var D;export{V as _};
