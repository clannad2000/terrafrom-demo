var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{d as n,z as i,Y as p,Z as u,n as d,a0 as c,A as m,V as g,a2 as f,r as h,j as y,w as v,o as b,c as w,b as _,h as k,u as x,aa as S,f as C,g as z,I as V,e as j,ay as P,aL as N,a5 as D,b3 as O,a1 as R}from"./index-OtYEJMgP.js";import{a as Y}from"./constants-uiyZ18jc.js";import{u as T}from"./MediaReview-6GObmu50.js";import A from"./AddAnalysisDialog-bmRFet61.js";const M={class:"flex flex-col items-center"},U=n((W=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e})({},{name:"AnalysisFilter"}),a(W,l({__name:"filter",setup(e){const[a,{showDialog:l,setDialogProps:t}]=i(),s=p(),{width:o,height:r}=u(s),n=p(),{height:U}=u(n),W=p(),{height:H}=u(W),I=d((()=>({width:`${o.value}`,height:""+(r.value-U.value-H.value-32)}))),E=p(),F=e=>{T().setAnalysisParams({type:e.analysisStatus,value:e})},L=c({analysisStatus:"",type:"",time:Y.range.default,keyWord:""}),q=m(!1),Z=p([]),$=m(Math.random()),B=D((()=>{return e=this,a=null,l=function*(){q.value=!0,Z.value=[];const{pageSize:e,pageNum:a}=J,{time:l=[],analysisStatus:t,type:s,keyWord:o}=L,[r="",n=""]=l;var i;yield O({pageSize:e,pageNum:a,analysisStatus:t,type:s,keyWord:o,beginTime:r,endTime:n}).then((e=>{if(e&&R!==e){const{rows:a=[],total:l=0}=e;Z.value=a,J.total=Number(l)||0,$.value=Math.random()}})).finally((()=>{q.value=!1})),Z.value.length?(i=Z.value[0],E.value.setCurrentRow(i)):T().setAnalysisParams({type:null,value:{}})},new Promise(((t,s)=>{var o=e=>{try{n(l.next(e))}catch(a){s(a)}},r=e=>{try{n(l.throw(e))}catch(a){s(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,r);n((l=l.apply(e,a)).next())}));var e,a,l}),1e3),G=()=>{J.pageNum=1,B()},J=c({pageNum:1,pageSize:10,total:0}),K=()=>{B()},Q=()=>{J.pageNum=1,G()},X=()=>{t({title:"新建分析"}),l(!0,{type:"add",data:null})};return g((()=>{f().loadIntelligentAnalysisTypeList(),G()})),(e,l)=>{const t=h("el-date-picker"),o=h("el-form-item"),r=h("el-button"),i=h("el-input"),p=h("el-option"),u=h("el-select"),d=h("el-form"),c=h("el-table-column"),m=h("el-pagination"),g=y("loading");return v((b(),w("div",{ref_key:"containerRef",ref:s,class:"w-full h-full flex flex-col gap-y-4"},[_(d,{ref_key:"searchFormRef",ref:n,inline:!0,class:"w-full table-query"},{default:k((()=>[_(o,{class:"col-span-3 m-0"},{default:k((()=>[_(t,{modelValue:L.time,"onUpdate:modelValue":l[0]||(l[0]=e=>L.time=e),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",editable:!1,clearable:!1,"disabled-date":e=>e.getTime()>Date.now(),onChange:G},null,8,["modelValue","disabled-date"])])),_:1}),_(o,{class:"col-span-3 m-0"},{default:k((()=>[_(i,{modelValue:L.keyWord,"onUpdate:modelValue":l[1]||(l[1]=e=>L.keyWord=e),placeholder:"请输入智能分析名称或作业计划名称",clearable:""},{prepend:k((()=>[_(r,{icon:x(S)},null,8,["icon"])])),append:k((()=>[_(r,{class:"search-text",onClick:G},{default:k((()=>[C("搜索")])),_:1})])),_:1},8,["modelValue"])])),_:1}),_(o,{class:"m-0"},{default:k((()=>[_(u,{modelValue:L.type,"onUpdate:modelValue":l[2]||(l[2]=e=>L.type=e),placeholder:"类型",clearable:"",onChange:G},{default:k((()=>[_(p,{value:"1",label:"人工"}),_(p,{value:"2",label:"自动"})])),_:1},8,["modelValue"])])),_:1}),_(o,{class:"m-0"},{default:k((()=>[_(u,{modelValue:L.analysisStatus,"onUpdate:modelValue":l[3]||(l[3]=e=>L.analysisStatus=e),placeholder:"状态",clearable:"",onChange:G},{default:k((()=>[_(p,{value:"0",label:"待处理"}),_(p,{value:"1",label:"处理中"}),_(p,{value:"2",label:"分析中"}),_(p,{value:"3",label:"分析完成"})])),_:1},8,["modelValue"])])),_:1}),_(o,{class:"m-0"},{default:k((()=>[_(r,{class:"basic-button",onClick:X},{default:k((()=>[C(" 新建分析 ")])),_:1})])),_:1})])),_:1},512),(b(),z(x(N),{ref_key:"tableRef",ref:E,key:$.value,width:I.value.width,height:I.value.height,data:Z.value,"show-overflow-tooltip":"","highlight-current-row":"",onCurrentChange:F},{default:k((()=>[_(c,{prop:"type",align:"center",label:"类型","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:k((({row:e})=>[C(V("1"==e.type?"人工":"2"==e.type?"自动":""),1)])),_:1}),_(c,{prop:"analysisTaskName",align:"center",label:"智能分析名称","min-width":"120","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),_(c,{prop:"beginTime",align:"center",label:"分析时间","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:k((({row:e})=>[j("div",M,[j("div",null,V(x(P)(e.createTime).format("YYYY-MM-DD")),1),j("div",null,V(x(P)(e.createTime).format("HH:mm:ss")),1)])])),_:1}),_(c,{prop:"analysisStatus",align:"center",label:"状态","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:k((({row:e})=>[C(V("0"==e.analysisStatus?"待处理":"1"==e.analysisStatus?"处理中":"2"==e.analysisStatus?"分析中":"3"==e.analysisStatus?"分析完成":""),1)])),_:1}),_(c,{prop:"createRealName",align:"center",label:"创建人","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}})])),_:1},8,["width","height","data"])),_(m,{ref_key:"paginationRef",ref:W,"current-page":J.pageNum,"onUpdate:currentPage":l[4]||(l[4]=e=>J.pageNum=e),"page-size":J.pageSize,"onUpdate:pageSize":l[5]||(l[5]=e=>J.pageSize=e),small:"",background:"",layout:"total, sizes, prev, pager, next",total:J.total,"pager-count":5,"page-sizes":[10,20,30,40,50,100],onSizeChange:Q,onCurrentChange:K},null,8,["current-page","page-size","total"]),_(A,{onRegister:x(a),onConfirm:G},null,8,["onRegister"])])),[[g,q.value]])}}}))));var W;export{U as _};
