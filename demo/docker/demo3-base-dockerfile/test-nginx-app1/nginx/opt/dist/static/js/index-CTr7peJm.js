var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o;import"./linesGL-UdMq74_O.js";import{B as r}from"./index.esm.min-p6OgvXm7.js";import{W as n}from"./StatisticalCenter-fzPo9Omj.js";import{d as c,a0 as u,A as p,n as m,V as d,r as h,o as y,c as f,e as v,b as x,h as b,u as j,a2 as g,J as M,L as w,g as C,I as D,a5 as O,R as S,U as I,a1 as P,_ as z}from"./index-OtYEJMgP.js";import{e as k}from"./mitt-ei5ABelY.js";import{u as R,i as _}from"./installCanvasRenderer-kp6nwiR2.js";import{i as A}from"./install-50C6z8uZ.js";import{i as F}from"./install-nwvgNUQF.js";import"./Axis-xmqQ_bGV.js";import"./installLabelLayout-tlP3-N5v.js";import"./createSeriesData-rVoIjXPv.js";import"./install-FXlg7-M8.js";import"./sectorHelper-nVwTOMBE.js";const E=e=>(S("data-v-545875b0"),e=e(),I(),e),N={class:"item"},V={class:"item-title"},L=E((()=>v("span",{class:"item-title-text"},"今日作业总量",-1))),T={class:"flex-1 flex flex-row justify-end"},$={class:"item-content table-container"},q={class:"content-box"},U={class:"left-box"},H={class:"total-box"},B={class:"total-count"},G=E((()=>v("span",{class:"total-type"},"作业总数",-1))),J={class:"right-box"},W=c((K=((e,t)=>{for(var a in t||(t={}))s.call(t,a)&&l(e,a,t[a]);if(o)for(var a of o(t))i.call(t,a)&&l(e,a,t[a]);return e})({},{name:"TodayPlanCount"}),Q={__name:"index",setup(e){R([_,A,F]);const t=u({cityOrgId:"",majorType:""}),a=p(!1),o=u({allCount:"0",dzxCount:"0",yjsCount:"0",yqxCount:"0",zxzCount:"0"}),s=O((()=>{return e=this,s=null,i=function*(){a.value=!0,Object.keys(o).forEach((e=>{o[e]="0"}));const{cityOrgId:e,majorType:s}=t;n({cityOrgId:e,majorType:s}).then((e=>{P!==e&&Object.keys(o).forEach((t=>{o[t]=e[t]||"0"}))})).finally((()=>{a.value=!1}))},new Promise(((t,a)=>{var o=e=>{try{r(i.next(e))}catch(t){a(t)}},l=e=>{try{r(i.throw(e))}catch(t){a(t)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,l);r((i=i.apply(e,s)).next())}));var e,s,i}),1e3),i=["#E84200","#F78A38","#E3CD00","#409AF3","#0BC467"],l=m((()=>{const e=[];Object.keys(o).forEach(((t,a)=>{"allCount"!==t&&e.push({name:"dzxCount"==t?"待执行":"yjsCount"==t?"已结束":"yqxCount"==t?"已取消":"zxzCount"==t?"执行中":"",value:Number(o[t])+80,itemStyle:{color:i[a],opacity:1}})}));const t=I(e,.85);return t.series.push({label:{show:!0,position:"outside",formatter:function(e){return`{c|${e.data.name}}\n{a| ${e.value-80}}`},rich:{a:{color:"#fff",fontSize:14},c:{fontSize:12,color:"#D8EFFF"}}},labelLine:{show:!0,length:"20",length2:"30",lineStyle:{width:1}},type:"pie",startAngle:-40,clockwise:!1,radius:["60%","60%"],center:["50%","45%"],data:e,itemStyle:{opacity:0},hoverAnimation:!1}),t})),c=(e,t)=>{let a=parseFloat(e);if(isNaN(a))return!1;a=Math.round(e*Math.pow(10,t))/Math.pow(10,t);let o=a.toString(),s=o.indexOf(".");for(s<0&&(s=o.length,o+=".");o.length<=s+t;)o+="0";return o},S=(e,t,a,o,s,i)=>{const l=(e+t)/2,r=e*Math.PI*2,n=t*Math.PI*2,c=l*Math.PI*2;0===e&&1===t&&(a=!1),s=void 0!==s?s:1/3;const u=a?.1*Math.cos(c):0,p=a?.1*Math.sin(c):0,m=o?1.05:1;return{u:{min:-Math.PI,max:3*Math.PI,step:Math.PI/32},v:{min:0,max:2*Math.PI,step:Math.PI/20},x:function(e,t){return e<r?u+Math.cos(r)*(1+Math.cos(t)*s)*m:e>n?u+Math.cos(n)*(1+Math.cos(t)*s)*m:u+Math.cos(e)*(1+Math.cos(t)*s)*m},y:function(e,t){return e<r?p+Math.sin(r)*(1+Math.cos(t)*s)*m:e>n?p+Math.sin(n)*(1+Math.cos(t)*s)*m:p+Math.sin(e)*(1+Math.cos(t)*s)*m},z:function(e,t){return e<.5*-Math.PI?Math.sin(e):e>2.5*Math.PI?Math.sin(e)*i*.1:Math.sin(t)>0?1*i*.1:-1}}},I=(e,t)=>{const a=[];let o=0,s=0,i=0,l=[],r=[];const n=1-t;e.sort(((e,t)=>t.value-e.value));for(let c=0;c<e.length;c++){o+=e[c].value;const t={name:void 0===e[c].name?`series${c}`:e[c].name,type:"surface",parametric:!0,wireframe:{show:!1},pieData:e[c],pieStatus:{selected:!1,hovered:!1,k:n}};if(void 0!==e[c].itemStyle){const a={};void 0!==e[c].itemStyle.color&&(a.color=e[c].itemStyle.color),void 0!==e[c].itemStyle.opacity&&(a.opacity=e[c].itemStyle.opacity),t.itemStyle=a}a.push(t)}l=[],r=[];for(let m=0;m<a.length;m++){i=s+a[m].pieData.value,a[m].pieData.startRatio=s/o,a[m].pieData.endRatio=i/o,a[m].parametricEquation=S(a[m].pieData.startRatio,a[m].pieData.endRatio,!1,!1,n,a[m].pieData.value),s=i;const e=c(a[m].pieData.value/o,4);l.push({name:a[m].name,value:e}),r.push({name:a[m].name,value:e})}const u=((e,t)=>(e.sort(((e,t)=>t.pieData.value-e.pieData.value)),25*t/e[0].pieData.value))(a,6),p={tooltip:{show:!1,formatter:e=>{if("mouseoutSeries"!==e.seriesName&&"pie2d"!==e.seriesName){const t=(100*(p.series[e.seriesIndex].pieData.endRatio-p.series[e.seriesIndex].pieData.startRatio)).toFixed(0);return`${e.seriesName}<br/><span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${e.color};"></span>${t}%`}}},xAxis3D:{min:-1,max:1},yAxis3D:{min:-1,max:1},zAxis3D:{min:-1,max:1},grid3D:{show:!1,boxHeight:u,left:0,top:-10,viewControl:{alpha:30,distance:180,rotateSensitivity:0,zoomSensitivity:0,panSensitivity:0,autoRotate:!1}},series:a};return p};return d((()=>{k.on("StatisticalCenterOverviewReload",(()=>{s()}))})),(e,a)=>{var i;const n=h("el-option"),c=h("el-select"),u=h("el-form-item"),p=h("el-form");return y(),f("div",N,[v("div",V,[L,v("div",T,[x(p,{inline:!0,"label-suffix":"：",class:"w-full table-query",style:{direction:"rtl"}},{default:b((()=>[x(u,{class:"m-0",style:{direction:"ltr"}},{default:b((()=>[x(c,{modelValue:t.cityOrgId,"onUpdate:modelValue":a[0]||(a[0]=e=>t.cityOrgId=e),placeholder:"请选择市级公司",clearable:"",onFocus:j(g)().loadCityOrg,onChange:j(s)},{default:b((()=>[(y(!0),f(M,null,w(j(g)().cityOrg,(e=>(y(),C(n,{key:e.id,value:e.id,label:e.shortName||e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onFocus","onChange"])])),_:1}),x(u,{class:"m-0",style:{direction:"ltr"}},{default:b((()=>[x(c,{modelValue:t.majorType,"onUpdate:modelValue":a[1]||(a[1]=e=>t.majorType=e),placeholder:"请选择专业",clearable:"",onChange:j(s)},{default:b((()=>[(y(!0),f(M,null,w(j(g)().workerMajorList,(e=>(y(),C(n,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1})])]),v("div",$,[v("div",q,[v("div",U,[v("div",H,[v("span",B,D(null!=(i=o.allCount)?i:0),1),G])]),v("div",J,[x(j(r),{ref:"vchart",class:"flex-1 flex",option:l.value,autoresize:""},null,8,["option"])])])])])}}},t(K,a(Q))));var K,Q;const X=z(W,[["__scopeId","data-v-545875b0"]]);export{X as default};
