var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,o=(e,a,t)=>new Promise(((s,l)=>{var i=e=>{try{o(t.next(e))}catch(a){l(a)}},r=e=>{try{o(t.throw(e))}catch(a){l(a)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,r);o((t=t.apply(e,a)).next())}));import{d as n,Y as c,Z as u,n as f,A as p,a0 as d,z as m,at as v,F as g,r as x,j as y,w as h,o as w,c as b,e as j,J as k,L as P,u as _,I as N,b as I,v as z,a5 as O,b5 as R,a1 as S,b6 as D,a6 as C,R as U,U as A,b7 as E,b8 as M,_ as T}from"./index-OtYEJMgP.js";import{E as F}from"./icon_no_data-JkxAPqfn.js";import{a as J,_ as L}from"./AudioViewerDialog.vue_vue_type_script_setup_true_lang-sYS-Yc_E.js";import{i as V,a as Y,b as Z}from"./play-gHG0B82O.js";import{u as q}from"./MediaReview-6GObmu50.js";import"./AdminLog-DD6g2Y3j.js";const B=e=>(U("data-v-e1a818c1"),e=e(),A(),e),G={key:0,class:"w-full grid grid-cols-3 gap-2 overflow-auto"},H=["onClick"],K={class:"title"},Q={class:"flex-1 flex flex-row items-center gap-x-2"},W=["src"],X={class:"text-sm truncate"},$={class:"info flex flex-col"},ee={class:"flex flex-row items-center"},ae={class:"task-title-major text-sm"},te={class:"task-title-name text-sm"},se={class:"flex flex-row items-center justify-between gap-x-4"},le={class:"flex-1 flex flex-row items-center justify-start"},ie=B((()=>j("div",{class:"min-w-fit text-xs"},"班组：",-1))),re={class:"truncate text-xs"},oe={class:"flex-1 flex flex-row items-center justify-end"},ne=B((()=>j("div",{class:"min-w-fit text-xs"},"人员：",-1))),ce={class:"truncate text-xs"},ue=["src"],fe=["src"],pe={key:1,class:"flex-1 flex flex-row items-center justify-center"},de=n((me=((e,a)=>{for(var t in a||(a={}))l.call(a,t)&&r(e,t,a[t]);if(s)for(var t of s(a))i.call(a,t)&&r(e,t,a[t]);return e})({},{name:"JobPlanMainAudio"}),a(me,t({__name:"index",setup(e){const a=c(),t=c(),{height:s}=u(a),{height:l}=u(t),i=f((()=>({width:"100%",height:s.value-l.value-20+"px"}))),r=c([]),n=p(!1),U=d({pageNum:1,pageSize:9,total:0}),A=()=>{B()},T=()=>{const{type:e,value:a={}}=q().jobPlanParams;"audio"===e&&(null==a?void 0:a.taskId)?(U.pageNum=1,B()):r.value=[]},B=O((()=>o(this,null,(function*(){r.value=[];const{pageNum:e,pageSize:a}=U,{type:t,isMarked:s,value:{taskId:l}}=q().jobPlanParams,i={pageNum:e,pageSize:a,taskId:l,fileType:t};"all"!==s&&(i.isMarked=s),yield E(i).then((e=>{if(e&&S!==e){const{rows:a=[],total:t=0}=e;if(U.total=Number(t)||0,a.length){const e=[];a.forEach((a=>{e.push(a.fileId)})),de(e.join(","))}}})).finally((()=>{n.value=!1}))}))),1e3),de=e=>{n.value=!0,r.value=[],M({fileIds:e}).then((e=>{e&&S!==e&&(r.value=e||[])})).finally((()=>{n.value=!1}))},[me,{showDialog:ve,setDialogProps:ge}]=m(),xe=e=>o(this,null,(function*(){const{fileId:a}=e;yield R({fileId:a}).then((a=>{if(a&&S!==a){const t=D(a);if(!t)return void C.error("获取文件信息失败");e.fileUrl=t,ge({title:"音频预览"}),ve(!0,{type:"view",data:e})}})).catch((e=>{console.log(e),C.error("获取文件信息失败")})).finally((()=>{}))}));return v((()=>q().jobPlanParams),(()=>{T()}),{deep:!0,immediate:!0}),g((()=>{T()})),(e,s)=>{const l=x("el-empty"),o=x("el-pagination"),c=y("loading");return h((w(),b("div",{ref_key:"fileContainerRef",ref:a,class:"w-full h-full flex flex-col gap-y-4"},[j("div",{class:"flex flex-col items-center",style:z(i.value)},[r.value.length?(w(),b("div",G,[(w(!0),b(k,null,P(r.value,(e=>(w(),b("div",{key:e.fileId,class:"aspect-video file-info relative cursor-pointer",onClick:a=>xe(e)},[j("div",K,[j("div",Q,[j("img",{class:"w-7 h-7",src:"100002"==e.uploadType?_(V):"100001"==e.uploadType?_(Y):""},null,8,W),j("span",X,N(e.execDeviceName),1)])]),j("div",$,[j("div",ee,[j("span",ae,"（"+N(e.majorTypeName)+"）",1),j("span",te,N(e.taskName),1)]),j("div",se,[j("div",le,[ie,j("div",re,N(e.orgName),1)]),j("div",oe,[ne,j("div",ce,N(e.execUserRealName),1)])])]),j("img",{src:_(J),class:"w-full h-full"},null,8,ue),j("img",{src:_(Z),class:"w-16 h-16 absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 cursor-pointer"},null,8,fe)],8,H)))),128))])):(w(),b("div",pe,[I(l,{description:"暂无数据",image:_(F)},null,8,["image"])]))],4),I(o,{ref_key:"paginationRef",ref:t,"current-page":U.pageNum,"onUpdate:currentPage":s[0]||(s[0]=e=>U.pageNum=e),"page-size":U.pageSize,"onUpdate:pageSize":s[1]||(s[1]=e=>U.pageSize=e),small:"",background:"",layout:"total, prev, pager, next",total:U.total,onCurrentChange:A},null,8,["current-page","page-size","total"]),I(L,{onRegister:_(me)},null,8,["onRegister"])])),[[c,n.value]])}}}))));var me;const ve=T(de,[["__scopeId","data-v-e1a818c1"]]);export{ve as default};
