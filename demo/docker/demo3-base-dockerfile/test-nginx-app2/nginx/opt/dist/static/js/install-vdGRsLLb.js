import{_ as t,G as e,bn as i,S as n,dm as a,dn as o,k as s,s as r,j as l,q as h,dp as u,a4 as c,p,v as d,x as g,o as m,c$ as f,cB as y,h as v,ak as b,n as S,bR as _,f as x,dE as I,eP as A,P as D,cd as M,eQ as w,af as N,W as P,y as k,eR as L,C as O,cS as C,aA as T,a5 as E,eS as z,l as G,b as V,L as R,c8 as X,eT as Y,dC as F}from"./installCanvasRenderer-kp6nwiR2.js";import{c as H}from"./createSeriesData-rVoIjXPv.js";import{g as B,a as W,i as U,b as j,e as q,d as Z}from"./dataSample-MvCW8qRP.js";const J=function(n){function a(){var t=null!==n&&n.apply(this,arguments)||this;return t.type=a.type,t.hasSymbolVisual=!0,t}return t(a,n),a.prototype.getInitialData=function(t){return H(null,this,{useEncodeDefaulter:!0})},a.prototype.getLegendIcon=function(t){var n=new e,a=i("line",0,t.itemHeight/2,t.itemWidth,0,t.lineStyle.stroke,!1);n.add(a),a.setStyle(t.lineStyle);var o=this.getData().getVisual("symbol"),s=this.getData().getVisual("symbolRotate"),r="none"===o?"circle":o,l=.8*t.itemHeight,h=i(r,(t.itemWidth-l)/2,(t.itemHeight-l)/2,l,l,t.itemStyle.fill);n.add(h),h.setStyle(t.itemStyle);var u="inherit"===t.iconRotate?s:t.iconRotate||0;return h.rotation=u*Math.PI/180,h.setOrigin([t.itemWidth/2,t.itemHeight/2]),r.indexOf("empty")>-1&&(h.style.stroke=h.style.fill,h.style.fill="#fff",h.style.lineWidth=2),n},a.type="series.line",a.dependencies=["grid","polar"],a.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:Infinity,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},a}(n);var K=function(e){function n(t,i,n,a){var o=e.call(this)||this;return o.updateData(t,i,n,a),o}return t(n,e),n.prototype._createSymbol=function(t,e,n,a,o){this.removeAll();var s=i(t,-1,-1,2,2,null,o);s.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),s.drift=Q,this._symbolType=t,this.add(s)},n.prototype.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(null,t)},n.prototype.getSymbolType=function(){return this._symbolType},n.prototype.getSymbolPath=function(){return this.childAt(0)},n.prototype.highlight=function(){a(this.childAt(0))},n.prototype.downplay=function(){o(this.childAt(0))},n.prototype.setZ=function(t,e){var i=this.childAt(0);i.zlevel=t,i.z=e},n.prototype.setDraggable=function(t,e){var i=this.childAt(0);i.draggable=t,i.cursor=!e&&t?"move":i.cursor},n.prototype.updateData=function(t,e,i,a){this.silent=!1;var o=t.getItemVisual(e,"symbol")||"circle",h=t.hostModel,u=n.getSymbolSize(t,e),c=o!==this._symbolType,p=a&&a.disableAnimation;if(c){var d=t.getItemVisual(e,"symbolKeepAspect");this._createSymbol(o,t,e,u,d)}else{(m=this.childAt(0)).silent=!1;var g={scaleX:u[0]/2,scaleY:u[1]/2};p?m.attr(g):s(m,g,h,e),r(m)}if(this._updateCommon(t,e,u,i,a),c){var m=this.childAt(0);if(!p){g={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:m.style.opacity}};m.scaleX=m.scaleY=0,m.style.opacity=0,l(m,g,h,e)}}p&&this.childAt(0).stopAnimation("leave")},n.prototype._updateCommon=function(t,e,i,n,a){var o,s,r,l,m,f,y,v,b,S=this.childAt(0),_=t.hostModel;if(n&&(o=n.emphasisItemStyle,s=n.blurItemStyle,r=n.selectItemStyle,l=n.focus,m=n.blurScope,y=n.labelStatesModels,v=n.hoverScale,b=n.cursorStyle,f=n.emphasisDisabled),!n||t.hasItemOption){var x=n&&n.itemModel?n.itemModel:t.getItemModel(e),I=x.getModel("emphasis");o=I.getModel("itemStyle").getItemStyle(),r=x.getModel(["select","itemStyle"]).getItemStyle(),s=x.getModel(["blur","itemStyle"]).getItemStyle(),l=I.get("focus"),m=I.get("blurScope"),f=I.get("disabled"),y=h(x),v=I.getShallow("scale"),b=x.getShallow("cursor")}var A=t.getItemVisual(e,"symbolRotate");S.attr("rotation",(A||0)*Math.PI/180||0);var D=u(t.getItemVisual(e,"symbolOffset"),i);D&&(S.x=D[0],S.y=D[1]),b&&S.attr("cursor",b);var M=t.getItemVisual(e,"style"),w=M.fill;if(S instanceof c){var N=S.style;S.useStyle(p({image:N.image,x:N.x,y:N.y,width:N.width,height:N.height},M))}else S.__isEmptyBrush?S.useStyle(p({},M)):S.useStyle(M),S.style.decal=null,S.setColor(w,a&&a.symbolInnerColor),S.style.strokeNoScale=!0;var P=t.getItemVisual(e,"liftZ"),k=this._z2;null!=P?null==k&&(this._z2=S.z2,S.z2+=P):null!=k&&(S.z2=k,this._z2=null);var L=a&&a.useNameLabel;d(S,y,{labelFetcher:_,labelDataIndex:e,defaultText:function(e){return L?t.getName(e):B(t,e)},inheritColor:w,defaultOpacity:M.opacity}),this._sizeX=i[0]/2,this._sizeY=i[1]/2;var O=S.ensureState("emphasis");O.style=o,S.ensureState("select").style=r,S.ensureState("blur").style=s;var C=null==v||!0===v?Math.max(1.1,3/this._sizeY):isFinite(v)&&v>0?+v:1;O.scaleX=this._sizeX*C,O.scaleY=this._sizeY*C,this.setSymbolScale(1),g(this,l,m,f)},n.prototype.setSymbolScale=function(t){this.scaleX=this.scaleY=t},n.prototype.fadeOut=function(t,e,i){var n=this.childAt(0),a=m(this).dataIndex,o=i&&i.animation;if(this.silent=n.silent=!0,i&&i.fadeLabel){var s=n.getTextContent();s&&f(s,{style:{opacity:0}},e,{dataIndex:a,removeOpt:o,cb:function(){n.removeTextContent()}})}else n.removeTextContent();f(n,{style:{opacity:0},scaleX:0,scaleY:0},e,{dataIndex:a,cb:t,removeOpt:o})},n.getSymbolSize=function(t,e){return y(t.getItemVisual(e,"symbolSize"))},n}(e);function Q(t,e){this.parent.drift(t,e)}function $(t,e,i,n){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(n.isIgnore&&n.isIgnore(i))&&!(n.clipShape&&!n.clipShape.contain(e[0],e[1]))&&"none"!==t.getItemVisual(i,"symbol")}function tt(t){return null==t||b(t)||(t={isIgnore:t}),t||{}}function et(t){var e=t.hostModel,i=e.getModel("emphasis");return{emphasisItemStyle:i.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:i.get("focus"),blurScope:i.get("blurScope"),emphasisDisabled:i.get("disabled"),hoverScale:i.get("scale"),labelStatesModels:h(e),cursorStyle:e.get("cursor")}}var it=function(){function t(t){this.group=new e,this._SymbolCtor=t||K}return t.prototype.updateData=function(t,e){this._progressiveEls=null,e=tt(e);var i=this.group,n=t.hostModel,a=this._data,o=this._SymbolCtor,r=e.disableAnimation,l=et(t),h={disableAnimation:r},u=e.getSymbolPoint||function(e){return t.getItemLayout(e)};a||i.removeAll(),t.diff(a).add((function(n){var a=u(n);if($(t,a,n,e)){var s=new o(t,n,l,h);s.setPosition(a),t.setItemGraphicEl(n,s),i.add(s)}})).update((function(c,p){var d=a.getItemGraphicEl(p),g=u(c);if($(t,g,c,e)){var m=t.getItemVisual(c,"symbol")||"circle",f=d&&d.getSymbolType&&d.getSymbolType();if(!d||f&&f!==m)i.remove(d),(d=new o(t,c,l,h)).setPosition(g);else{d.updateData(t,c,l,h);var y={x:g[0],y:g[1]};r?d.attr(y):s(d,y,n)}i.add(d),t.setItemGraphicEl(c,d)}else i.remove(d)})).remove((function(t){var e=a.getItemGraphicEl(t);e&&e.fadeOut((function(){i.remove(e)}),n)})).execute(),this._getSymbolPoint=u,this._data=t},t.prototype.updateLayout=function(){var t=this,e=this._data;e&&e.eachItemGraphicEl((function(e,i){var n=t._getSymbolPoint(i);e.setPosition(n),e.markRedraw()}))},t.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=et(t),this._data=null,this.group.removeAll()},t.prototype.incrementalUpdate=function(t,e,i){function n(t){t.isGroup||(t.incremental=!0,t.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[],i=tt(i);for(var a=t.start;a<t.end;a++){var o=e.getItemLayout(a);if($(e,o,a,i)){var s=new this._SymbolCtor(e,a,this._seriesScope);s.traverse(n),s.setPosition(o),this.group.add(s),e.setItemGraphicEl(a,s),this._progressiveEls.push(s)}}},t.prototype.eachRendered=function(t){v(this._progressiveEls||this.group,t)},t.prototype.remove=function(t){var e=this.group,i=this._data;i&&t?i.eachItemGraphicEl((function(t){t.fadeOut((function(){e.remove(t)}),i.hostModel)})):e.removeAll()},t}();function nt(t,e,i){var n=t.getBaseAxis(),a=t.getOtherAxis(n),o=function(t,e){var i=0,n=t.scale.getExtent();"start"===e?i=n[0]:"end"===e?i=n[1]:x(e)&&!isNaN(e)?i=e:n[0]>0?i=n[0]:n[1]<0&&(i=n[1]);return i}(a,i),s=n.dim,r=a.dim,l=e.mapDimension(r),h=e.mapDimension(s),u="x"===r||"radius"===r?1:0,c=S(t.dimensions,(function(t){return e.mapDimension(t)})),p=!1,d=e.getCalculationInfo("stackResultDimension");return _(e,c[0])&&(p=!0,c[0]=d),_(e,c[1])&&(p=!0,c[1]=d),{dataDimsForPoint:c,valueStart:o,valueAxisDim:r,baseAxisDim:s,stacked:!!p,valueDim:l,baseDim:h,baseDataOffset:u,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function at(t,e,i,n){var a=NaN;t.stacked&&(a=i.get(i.getCalculationInfo("stackedOverDimension"),n)),isNaN(a)&&(a=t.valueStart);var o=t.baseDataOffset,s=[];return s[o]=i.get(t.baseDim,n),s[1-o]=a,e.dataToPoint(s)}var ot=Math.min,st=Math.max;function rt(t,e){return isNaN(t)||isNaN(e)}function lt(t,e,i,n,a,o,s,r,l){for(var h,u,c,p,d,g,m=i,f=0;f<n;f++){var y=e[2*m],v=e[2*m+1];if(m>=a||m<0)break;if(rt(y,v)){if(l){m+=o;continue}break}if(m===i)t[o>0?"moveTo":"lineTo"](y,v),c=y,p=v;else{var b=y-h,S=v-u;if(b*b+S*S<.5){m+=o;continue}if(s>0){for(var _=m+o,x=e[2*_],I=e[2*_+1];x===y&&I===v&&f<n;)f++,m+=o,x=e[2*(_+=o)],I=e[2*_+1],b=(y=e[2*m])-h,S=(v=e[2*m+1])-u;var A=f+1;if(l)for(;rt(x,I)&&A<n;)A++,x=e[2*(_+=o)],I=e[2*_+1];var D=.5,M=0,w=0,N=void 0,P=void 0;if(A>=n||rt(x,I))d=y,g=v;else{M=x-h,w=I-u;var k=y-h,L=x-y,O=v-u,C=I-v,T=void 0,E=void 0;if("x"===r){var z=M>0?1:-1;d=y-z*(T=Math.abs(k))*s,g=v,N=y+z*(E=Math.abs(L))*s,P=v}else if("y"===r){var G=w>0?1:-1;d=y,g=v-G*(T=Math.abs(O))*s,N=y,P=v+G*(E=Math.abs(C))*s}else T=Math.sqrt(k*k+O*O),d=y-M*s*(1-(D=(E=Math.sqrt(L*L+C*C))/(E+T))),g=v-w*s*(1-D),P=v+w*s*D,N=ot(N=y+M*s*D,st(x,y)),P=ot(P,st(I,v)),N=st(N,ot(x,y)),g=v-(w=(P=st(P,ot(I,v)))-v)*T/E,d=ot(d=y-(M=N-y)*T/E,st(h,y)),g=ot(g,st(u,v)),N=y+(M=y-(d=st(d,ot(h,y))))*E/T,P=v+(w=v-(g=st(g,ot(u,v))))*E/T}t.bezierCurveTo(c,p,d,g,y,v),c=N,p=P}else t.lineTo(y,v)}h=y,u=v,m+=o}return f}var ht=function(){return function(){this.smooth=0,this.smoothConstraint=!0}}(),ut=function(e){function i(t){var i=e.call(this,t)||this;return i.type="ec-polyline",i}return t(i,e),i.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},i.prototype.getDefaultShape=function(){return new ht},i.prototype.buildPath=function(t,e){var i=e.points,n=0,a=i.length/2;if(e.connectNulls){for(;a>0&&rt(i[2*a-2],i[2*a-1]);a--);for(;n<a&&rt(i[2*n],i[2*n+1]);n++);}for(;n<a;)n+=lt(t,i,n,a,a,1,e.smooth,e.smoothMonotone,e.connectNulls)+1},i.prototype.getPointOn=function(t,e){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i,n,a=this.path.data,o=M.CMD,s="x"===e,r=[],l=0;l<a.length;){var h=void 0,u=void 0,c=void 0,p=void 0,d=void 0,g=void 0,m=void 0;switch(a[l++]){case o.M:i=a[l++],n=a[l++];break;case o.L:if(h=a[l++],u=a[l++],(m=s?(t-i)/(h-i):(t-n)/(u-n))<=1&&m>=0){var f=s?(u-n)*m+n:(h-i)*m+i;return s?[t,f]:[f,t]}i=h,n=u;break;case o.C:h=a[l++],u=a[l++],c=a[l++],p=a[l++],d=a[l++],g=a[l++];var y=s?A(i,h,c,d,t,r):A(n,u,p,g,t,r);if(y>0)for(var v=0;v<y;v++){var b=r[v];if(b<=1&&b>=0){f=s?w(n,u,p,g,b):w(i,h,c,d,b);return s?[t,f]:[f,t]}}i=d,n=g}}},i}(D),ct=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return t(i,e),i}(ht),pt=function(e){function i(t){var i=e.call(this,t)||this;return i.type="ec-polygon",i}return t(i,e),i.prototype.getDefaultShape=function(){return new ct},i.prototype.buildPath=function(t,e){var i=e.points,n=e.stackedOnPoints,a=0,o=i.length/2,s=e.smoothMonotone;if(e.connectNulls){for(;o>0&&rt(i[2*o-2],i[2*o-1]);o--);for(;a<o&&rt(i[2*a],i[2*a+1]);a++);}for(;a<o;){var r=lt(t,i,a,o,o,1,e.smooth,s,e.connectNulls);lt(t,n,a+r-1,r,o,-1,e.stackedOnSmooth,s,e.connectNulls),a+=r+1,t.closePath()}},i}(D);function dt(t,e){if(t.length===e.length){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return;return!0}}function gt(t){for(var e=Infinity,i=Infinity,n=-Infinity,a=-Infinity,o=0;o<t.length;){var s=t[o++],r=t[o++];isNaN(s)||(e=Math.min(s,e),n=Math.max(s,n)),isNaN(r)||(i=Math.min(r,i),a=Math.max(r,a))}return[[e,i],[n,a]]}function mt(t,e){var i=gt(t),n=i[0],a=i[1],o=gt(e),s=o[0],r=o[1];return Math.max(Math.abs(n[0]-s[0]),Math.abs(n[1]-s[1]),Math.abs(a[0]-r[0]),Math.abs(a[1]-r[1]))}function ft(t){return x(t)?t:t?.5:0}function yt(t,e,i,n){var a=e.getBaseAxis(),o="x"===a.dim||"radius"===a.dim?0:1,s=[],r=0,l=[],h=[],u=[],c=[];if(n){for(r=0;r<t.length;r+=2)isNaN(t[r])||isNaN(t[r+1])||c.push(t[r],t[r+1]);t=c}for(r=0;r<t.length-2;r+=2)switch(u[0]=t[r+2],u[1]=t[r+3],h[0]=t[r],h[1]=t[r+1],s.push(h[0],h[1]),i){case"end":l[o]=u[o],l[1-o]=h[1-o],s.push(l[0],l[1]);break;case"middle":var p=(h[o]+u[o])/2,d=[];l[o]=d[o]=p,l[1-o]=h[1-o],d[1-o]=u[1-o],s.push(l[0],l[1]),s.push(d[0],d[1]);break;default:l[o]=h[o],l[1-o]=u[1-o],s.push(l[0],l[1])}return s.push(t[r++],t[r++]),s}function vt(t,e,i){var n=t.getVisual("visualMeta");if(n&&n.length&&t.count()&&"cartesian2d"===e.type){for(var a,o,s=n.length-1;s>=0;s--){var r=t.getDimensionInfo(n[s].dimension);if("x"===(a=r&&r.coordDim)||"y"===a){o=n[s];break}}if(o){var l=e.getAxis(a),h=S(o.stops,(function(t){return{coord:l.toGlobalCoord(l.dataToCoord(t.value)),color:t.color}})),u=h.length,c=o.outerColors.slice();u&&h[0].coord>h[u-1].coord&&(h.reverse(),c.reverse());var p=function(t,e){var i,n,a=[],o=t.length;function s(t,e,i){var n=t.coord,a=(i-n)/(e.coord-n);return{coord:i,color:Y(a,[t.color,e.color])}}for(var r=0;r<o;r++){var l=t[r],h=l.coord;if(h<0)i=l;else{if(h>e){n?a.push(s(n,l,e)):i&&a.push(s(i,l,0),s(i,l,e));break}i&&(a.push(s(i,l,0)),i=null),a.push(l),n=l}}return a}(h,"x"===a?i.getWidth():i.getHeight()),d=p.length;if(!d&&u)return h[0].coord<0?c[1]?c[1]:h[u-1].color:c[0]?c[0]:h[0].color;var g=p[0].coord-10,m=p[d-1].coord+10,f=m-g;if(f<.001)return"transparent";V(p,(function(t){t.offset=(t.coord-g)/f})),p.push({offset:d?p[d-1].offset:.5,color:c[1]||"transparent"}),p.unshift({offset:d?p[0].offset:.5,color:c[0]||"transparent"});var y=new R(0,0,0,0,p,!0);return y[a]=g,y[a+"2"]=m,y}}}function bt(t,e,i){var n=t.get("showAllSymbol"),a="auto"===n;if(!n||a){var o=i.getAxesByScale("ordinal")[0];if(o&&(!a||!function(t,e){var i=t.getExtent(),n=Math.abs(i[1]-i[0])/t.scale.count();isNaN(n)&&(n=0);for(var a=e.count(),o=Math.max(1,Math.round(a/5)),s=0;s<a;s+=o)if(1.5*K.getSymbolSize(e,s)[t.isHorizontal()?1:0]>n)return!1;return!0}(o,e))){var s=e.mapDimension(o.dim),r={};return V(o.getViewLabels(),(function(t){var e=o.scale.getRawOrdinalNumber(t.tickValue);r[e]=1})),function(t){return!r.hasOwnProperty(e.get(s,t))}}}}function St(t,e){return[t[2*e],t[2*e+1]]}function _t(t){if(t.get(["endLabel","show"]))return!0;for(var e=0;e<X.length;e++)if(t.get([X[e],"endLabel","show"]))return!0;return!1}function xt(t,e,i,n){if(U(e,"cartesian2d")){var a=n.getModel("endLabel"),o=a.get("valueAnimation"),s=n.getData(),r={lastFrameIndex:0},l=_t(n)?function(i,n){t._endLabelOnDuring(i,n,s,r,o,a,e)}:null,h=e.getBaseAxis().isHorizontal(),u=j(e,i,n,(function(){var e=t._endLabel;e&&i&&null!=r.originalX&&e.attr({x:r.originalX,y:r.originalY})}),l);if(!n.get("clip",!0)){var c=u.shape,p=Math.max(c.width,c.height);h?(c.y-=p,c.height+=2*p):(c.x-=p,c.width+=2*p)}return l&&l(1,u),u}return q(e,i,n)}const It=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return t(n,i),n.prototype.init=function(){var t=new e,i=new it;this.group.add(i.group),this._symbolDraw=i,this._lineGroup=t},n.prototype.render=function(t,e,i){var n=this,a=t.coordinateSystem,o=this.group,s=t.getData(),r=t.getModel("lineStyle"),h=t.getModel("areaStyle"),u=s.getLayout("points")||[],c="polar"===a.type,p=this._coordSys,d=this._symbolDraw,f=this._polyline,y=this._polygon,v=this._lineGroup,b=!e.ssr&&t.isAnimationEnabled(),S=!h.isEmpty(),_=h.get("origin"),x=nt(a,s,_),A=S&&function(t,e,i){if(!i.valueDim)return[];for(var n=e.count(),a=I(2*n),o=0;o<n;o++){var s=at(i,t,e,o);a[2*o]=s[0],a[2*o+1]=s[1]}return a}(a,s,x),D=t.get("showSymbol"),M=t.get("connectNulls"),w=D&&!c&&bt(t,s,a),L=this._data;L&&L.eachItemGraphicEl((function(t,e){t.__temp&&(o.remove(t),L.setItemGraphicEl(e,null))})),D||d.remove(),o.add(v);var O,C=!c&&t.get("step");a&&a.getArea&&t.get("clip",!0)&&(null!=(O=a.getArea()).width?(O.x-=.1,O.y-=.1,O.width+=.2,O.height+=.2):O.r0&&(O.r0-=.5,O.r+=.5)),this._clipShapeForSymbol=O;var T=vt(s,a,i)||s.getVisual("style")[s.getVisual("drawType")];if(f&&p.type===a.type&&C===this._step){S&&!y?y=this._newPolygon(u,A):y&&!S&&(v.remove(y),y=this._polygon=null),c||this._initOrUpdateEndLabel(t,a,N(T));var E=v.getClipPath();if(E){var z=xt(this,a,!1,t);l(E,{shape:z.shape},t)}else v.setClipPath(xt(this,a,!0,t));D&&d.updateData(s,{isIgnore:w,clipShape:O,disableAnimation:!0,getSymbolPoint:function(t){return[u[2*t],u[2*t+1]]}}),dt(this._stackedOnPoints,A)&&dt(this._points,u)||(b?this._doUpdateAnimation(s,A,a,i,C,_,M):(C&&(u=yt(u,a,C,M),A&&(A=yt(A,a,C,M))),f.setShape({points:u}),y&&y.setShape({points:u,stackedOnPoints:A})))}else D&&d.updateData(s,{isIgnore:w,clipShape:O,disableAnimation:!0,getSymbolPoint:function(t){return[u[2*t],u[2*t+1]]}}),b&&this._initSymbolLabelAnimation(s,a,O),C&&(u=yt(u,a,C,M),A&&(A=yt(A,a,C,M))),f=this._newPolyline(u),S?y=this._newPolygon(u,A):y&&(v.remove(y),y=this._polygon=null),c||this._initOrUpdateEndLabel(t,a,N(T)),v.setClipPath(xt(this,a,!0,t));var G=t.getModel("emphasis"),V=G.get("focus"),R=G.get("blurScope"),X=G.get("disabled");(f.useStyle(P(r.getLineStyle(),{fill:"none",stroke:T,lineJoin:"bevel"})),k(f,t,"lineStyle"),f.style.lineWidth>0&&"bolder"===t.get(["emphasis","lineStyle","width"]))&&(f.getState("emphasis").style.lineWidth=+f.style.lineWidth+1);m(f).seriesIndex=t.seriesIndex,g(f,V,R,X);var Y=ft(t.get("smooth")),F=t.get("smoothMonotone");if(f.setShape({smooth:Y,smoothMonotone:F,connectNulls:M}),y){var H=s.getCalculationInfo("stackedOnSeries"),B=0;y.useStyle(P(h.getAreaStyle(),{fill:T,opacity:.7,lineJoin:"bevel",decal:s.getVisual("style").decal})),H&&(B=ft(H.get("smooth"))),y.setShape({smooth:Y,stackedOnSmooth:B,smoothMonotone:F,connectNulls:M}),k(y,t,"areaStyle"),m(y).seriesIndex=t.seriesIndex,g(y,V,R,X)}var W=function(t){n._changePolyState(t)};s.eachItemGraphicEl((function(t){t&&(t.onHoverStateChange=W)})),this._polyline.onHoverStateChange=W,this._data=s,this._coordSys=a,this._stackedOnPoints=A,this._points=u,this._step=C,this._valueOrigin=_,t.get("triggerLineEvent")&&(this.packEventData(t,f),y&&this.packEventData(t,y))},n.prototype.packEventData=function(t,e){m(e).eventData={componentType:"series",componentSubType:"line",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"line"}},n.prototype.highlight=function(t,e,i,n){var a=t.getData(),o=L(a,n);if(this._changePolyState("emphasis"),!(o instanceof Array)&&null!=o&&o>=0){var s=a.getLayout("points"),r=a.getItemGraphicEl(o);if(!r){var l=s[2*o],h=s[2*o+1];if(isNaN(l)||isNaN(h))return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(l,h))return;var u=t.get("zlevel")||0,c=t.get("z")||0;(r=new K(a,o)).x=l,r.y=h,r.setZ(u,c);var p=r.getSymbolPath().getTextContent();p&&(p.zlevel=u,p.z=c,p.z2=this._polyline.z2+1),r.__temp=!0,a.setItemGraphicEl(o,r),r.stopSymbolAnimation(!0),this.group.add(r)}r.highlight()}else O.prototype.highlight.call(this,t,e,i,n)},n.prototype.downplay=function(t,e,i,n){var a=t.getData(),o=L(a,n);if(this._changePolyState("normal"),null!=o&&o>=0){var s=a.getItemGraphicEl(o);s&&(s.__temp?(a.setItemGraphicEl(o,null),this.group.remove(s)):s.downplay())}else O.prototype.downplay.call(this,t,e,i,n)},n.prototype._changePolyState=function(t){var e=this._polygon;C(this._polyline,t),e&&C(e,t)},n.prototype._newPolyline=function(t){var e=this._polyline;return e&&this._lineGroup.remove(e),e=new ut({shape:{points:t},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(e),this._polyline=e,e},n.prototype._newPolygon=function(t,e){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new pt({shape:{points:t,stackedOnPoints:e},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},n.prototype._initSymbolLabelAnimation=function(t,e,i){var n,a,o=e.getBaseAxis(),s=o.inverse;"cartesian2d"===e.type?(n=o.isHorizontal(),a=!1):"polar"===e.type&&(n="angle"===o.dim,a=!0);var r=t.hostModel,l=r.get("animationDuration");T(l)&&(l=l(null));var h=r.get("animationDelay")||0,u=T(h)?h(null):h;t.eachItemGraphicEl((function(t,o){var r=t;if(r){var c=[t.x,t.y],p=void 0,d=void 0,g=void 0;if(i)if(a){var m=i,f=e.pointToCoord(c);n?(p=m.startAngle,d=m.endAngle,g=-f[1]/180*Math.PI):(p=m.r0,d=m.r,g=f[0])}else{var y=i;n?(p=y.x,d=y.x+y.width,g=t.x):(p=y.y+y.height,d=y.y,g=t.y)}var v=d===p?0:(g-p)/(d-p);s&&(v=1-v);var b=T(h)?h(o):l*v+u,S=r.getSymbolPath(),_=S.getTextContent();r.attr({scaleX:0,scaleY:0}),r.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:b}),_&&_.animateFrom({style:{opacity:0}},{duration:300,delay:b}),S.disableLabelAnimation=!0}}))},n.prototype._initOrUpdateEndLabel=function(t,e,i){var n=t.getModel("endLabel");if(_t(t)){var a=t.getData(),o=this._polyline,s=a.getLayout("points");if(!s)return o.removeTextContent(),void(this._endLabel=null);var r=this._endLabel;r||((r=this._endLabel=new E({z2:200})).ignoreClip=!0,o.setTextContent(this._endLabel),o.disableLabelAnimation=!0);var l=function(t){for(var e,i,n=t.length/2;n>0&&(e=t[2*n-2],i=t[2*n-1],isNaN(e)||isNaN(i));n--);return n-1}(s);l>=0&&(d(o,h(t,"endLabel"),{inheritColor:i,labelFetcher:t,labelDataIndex:l,defaultText:function(t,e,i){return null!=i?W(a,i):B(a,t)},enableTextSetter:!0},function(t,e){var i=e.getBaseAxis(),n=i.isHorizontal(),a=i.inverse,o=n?a?"right":"left":"center",s=n?"middle":a?"top":"bottom";return{normal:{align:t.get("align")||o,verticalAlign:t.get("verticalAlign")||s}}}(n,e)),o.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},n.prototype._endLabelOnDuring=function(t,e,i,n,a,o,s){var r=this._endLabel,l=this._polyline;if(r){t<1&&null==n.originalX&&(n.originalX=r.x,n.originalY=r.y);var h=i.getLayout("points"),u=i.hostModel,c=u.get("connectNulls"),p=o.get("precision"),d=o.get("distance")||0,g=s.getBaseAxis(),m=g.isHorizontal(),f=g.inverse,y=e.shape,v=f?m?y.x:y.y+y.height:m?y.x+y.width:y.y,b=(m?d:0)*(f?-1:1),S=(m?0:-d)*(f?-1:1),_=m?"x":"y",x=function(t,e,i){for(var n,a,o=t.length/2,s="x"===i?0:1,r=0,l=-1,h=0;h<o;h++)if(a=t[2*h+s],!isNaN(a)&&!isNaN(t[2*h+1-s]))if(0!==h){if(n<=e&&a>=e||n>=e&&a<=e){l=h;break}r=h,n=a}else n=a;return{range:[r,l],t:(e-n)/(a-n)}}(h,v,_),I=x.range,A=I[1]-I[0],D=void 0;if(A>=1){if(A>1&&!c){var M=St(h,I[0]);r.attr({x:M[0]+b,y:M[1]+S}),a&&(D=u.getRawValue(I[0]))}else{(M=l.getPointOn(v,_))&&r.attr({x:M[0]+b,y:M[1]+S});var w=u.getRawValue(I[0]),N=u.getRawValue(I[1]);a&&(D=z(i,p,w,N,x.t))}n.lastFrameIndex=I[0]}else{var P=1===t||n.lastFrameIndex>0?I[0]:0;M=St(h,P);a&&(D=u.getRawValue(P)),r.attr({x:M[0]+b,y:M[1]+S})}if(a){var k=G(r);"function"==typeof k.setLabelText&&k.setLabelText(D)}}},n.prototype._doUpdateAnimation=function(t,e,i,n,a,o,r){var l=this._polyline,h=this._polygon,u=t.hostModel,c=function(t,e,i,n,a,o,s,r){for(var l=function(t,e){var i=[];return e.diff(t).add((function(t){i.push({cmd:"+",idx:t})})).update((function(t,e){i.push({cmd:"=",idx:e,idx1:t})})).remove((function(t){i.push({cmd:"-",idx:t})})).execute(),i}(t,e),h=[],u=[],c=[],p=[],d=[],g=[],m=[],f=nt(a,e,s),y=t.getLayout("points")||[],v=e.getLayout("points")||[],b=0;b<l.length;b++){var S=l[b],_=!0,x=void 0,A=void 0;switch(S.cmd){case"=":x=2*S.idx,A=2*S.idx1;var D=y[x],M=y[x+1],w=v[A],N=v[A+1];(isNaN(D)||isNaN(M))&&(D=w,M=N),h.push(D,M),u.push(w,N),c.push(i[x],i[x+1]),p.push(n[A],n[A+1]),m.push(e.getRawIndex(S.idx1));break;case"+":var P=S.idx,k=f.dataDimsForPoint,L=a.dataToPoint([e.get(k[0],P),e.get(k[1],P)]);A=2*P,h.push(L[0],L[1]),u.push(v[A],v[A+1]);var O=at(f,a,e,P);c.push(O[0],O[1]),p.push(n[A],n[A+1]),m.push(e.getRawIndex(P));break;case"-":_=!1}_&&(d.push(S),g.push(g.length))}g.sort((function(t,e){return m[t]-m[e]}));var C=h.length,T=I(C),E=I(C),z=I(C),G=I(C),V=[];for(b=0;b<g.length;b++){var R=g[b],X=2*b,Y=2*R;T[X]=h[Y],T[X+1]=h[Y+1],E[X]=u[Y],E[X+1]=u[Y+1],z[X]=c[Y],z[X+1]=c[Y+1],G[X]=p[Y],G[X+1]=p[Y+1],V[b]=d[R]}return{current:T,next:E,stackedOnCurrent:z,stackedOnNext:G,status:V}}(this._data,t,this._stackedOnPoints,e,this._coordSys,0,this._valueOrigin),p=c.current,d=c.stackedOnCurrent,g=c.next,m=c.stackedOnNext;if(a&&(p=yt(c.current,i,a,r),d=yt(c.stackedOnCurrent,i,a,r),g=yt(c.next,i,a,r),m=yt(c.stackedOnNext,i,a,r)),mt(p,g)>3e3||h&&mt(d,m)>3e3)return l.stopAnimation(),l.setShape({points:g}),void(h&&(h.stopAnimation(),h.setShape({points:g,stackedOnPoints:m})));l.shape.__points=c.current,l.shape.points=p;var f={shape:{points:g}};c.current!==p&&(f.shape.__points=c.next),l.stopAnimation(),s(l,f,u),h&&(h.setShape({points:p,stackedOnPoints:d}),h.stopAnimation(),s(h,{shape:{stackedOnPoints:m}},u),l.shape.points!==h.shape.points&&(h.shape.points=l.shape.points));for(var y=[],v=c.status,b=0;b<v.length;b++){if("="===v[b].cmd){var S=t.getItemGraphicEl(v[b].idx1);S&&y.push({el:S,ptIdx:b})}}l.animators&&l.animators.length&&l.animators[0].during((function(){h&&h.dirtyShape();for(var t=l.shape.__points,e=0;e<y.length;e++){var i=y[e].el,n=2*y[e].ptIdx;i.x=t[n],i.y=t[n+1],i.markRedraw()}}))},n.prototype.remove=function(t){var e=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl((function(t,n){t.__temp&&(e.remove(t),i.setItemGraphicEl(n,null))})),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},n.type="line",n}(O);function At(t,e){return{seriesType:t,plan:F(),reset:function(t){var i=t.getData(),n=t.coordinateSystem,a=t.pipelineContext,o=e||a.large;if(n){var s=S(n.dimensions,(function(t){return i.mapDimension(t)})).slice(0,2),r=s.length,l=i.getCalculationInfo("stackResultDimension");_(i,s[0])&&(s[0]=l),_(i,s[1])&&(s[1]=l);var h=i.getStore(),u=i.getDimensionIndex(s[0]),c=i.getDimensionIndex(s[1]);return r&&{progress:function(t,e){for(var i=t.end-t.start,a=o&&I(i*r),s=[],l=[],p=t.start,d=0;p<t.end;p++){var g=void 0;if(1===r){var m=h.get(u,p);g=n.dataToPoint(m,null,l)}else s[0]=h.get(u,p),s[1]=h.get(c,p),g=n.dataToPoint(s,null,l);o?(a[d++]=g[0],a[d++]=g[1]):e.setItemLayout(p,g.slice())}o&&e.setLayout("points",a)}}}}}}function Dt(t){t.registerChartView(It),t.registerSeriesModel(J),t.registerLayout(At("line",!0)),t.registerVisual({seriesType:"line",reset:function(t){var e=t.getData(),i=t.getModel("lineStyle").getLineStyle();i&&!i.stroke&&(i.stroke=e.getVisual("style").fill),e.setVisual("legendLineStyle",i)}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,Z("line"))}export{pt as E,it as S,K as a,Dt as i,At as p};
