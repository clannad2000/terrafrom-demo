var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i;import"./linesGL-UdMq74_O.js";import{B as n}from"./index.esm.min-p6OgvXm7.js";import{g as l}from"./JobOverview-wJdELtdM.js";import{E as c}from"./icon_no_data-JkxAPqfn.js";import{d as p,A as u,Y as m,n as h,V as v,r as f,o as d,c as y,g as x,u as M,b as w,a5 as g,Q as b,a1 as D}from"./index-OtYEJMgP.js";import{i as S}from"./install-50C6z8uZ.js";import{u as P,i as j}from"./installCanvasRenderer-kp6nwiR2.js";import{i as k}from"./install-nwvgNUQF.js";const I={class:"w-full h-full flex flex-col"},O={key:1,class:"flex-1 flex flex-row items-center justify-center"},R=p((A=((e,t)=>{for(var a in t||(t={}))o.call(t,a)&&r(e,a,t[a]);if(i)for(var a of i(t))s.call(t,a)&&r(e,a,t[a]);return e})({},{name:"JobPlanStatOfRiskLevel"}),z={__name:"index",setup(e){P([j,S,k]);const t=u(!1),a=["#E84200","#F78A38","#E3CD00","#409AF3","#0BC467"],i=m([]),o=g((()=>{return e=this,o=null,s=function*(){t.value=!0,i.value=[],l().then((e=>{D!==e&&(i.value=e.map(((e,t)=>({name:e.workRiskLevelName,value:Number(e.count)+20,workRiskLevel:e.workRiskLevel,itemStyle:{color:a[t],opacity:1}}))))})).finally((()=>{t.value=!1}))},new Promise(((t,a)=>{var i=e=>{try{n(s.next(e))}catch(t){a(t)}},r=e=>{try{n(s.throw(e))}catch(t){a(t)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,r);n((s=s.apply(e,o)).next())}));var e,o,s}),1e3),s=h((()=>{const e=R(i.value,.85);return e.series.push({label:{show:!0,position:"outside",formatter:function(e){return`{c|${e.data.name}}\n{a| ${e.value-20}}`},rich:{a:{color:"#fff",fontSize:14},c:{fontSize:12,color:"#D8EFFF"}}},labelLine:{show:!0,length:"40",length2:"30",lineStyle:{width:1}},type:"pie",startAngle:-40,clockwise:!1,radius:["60%","60%"],center:["50%","45%"],data:i.value,itemStyle:{opacity:0},hoverAnimation:!1}),e})),r=(e,t)=>{let a=parseFloat(e);if(isNaN(a))return!1;a=Math.round(e*Math.pow(10,t))/Math.pow(10,t);let i=a.toString(),o=i.indexOf(".");for(o<0&&(o=i.length,i+=".");i.length<=o+t;)i+="0";return i},p=(e,t,a,i,o,s)=>{const r=(e+t)/2,n=e*Math.PI*2,l=t*Math.PI*2,c=r*Math.PI*2;0===e&&1===t&&(a=!1),o=void 0!==o?o:1/3;const p=a?.1*Math.cos(c):0,u=a?.1*Math.sin(c):0,m=i?1.05:1;return{u:{min:-Math.PI,max:3*Math.PI,step:Math.PI/32},v:{min:0,max:2*Math.PI,step:Math.PI/20},x:function(e,t){return e<n?p+Math.cos(n)*(1+Math.cos(t)*o)*m:e>l?p+Math.cos(l)*(1+Math.cos(t)*o)*m:p+Math.cos(e)*(1+Math.cos(t)*o)*m},y:function(e,t){return e<n?u+Math.sin(n)*(1+Math.cos(t)*o)*m:e>l?u+Math.sin(l)*(1+Math.cos(t)*o)*m:u+Math.sin(e)*(1+Math.cos(t)*o)*m},z:function(e,t){return e<.5*-Math.PI?Math.sin(e):e>2.5*Math.PI?Math.sin(e)*s*.1:Math.sin(t)>0?1*s*.1:-1}}},R=(e,t)=>{const a=[];let i=0,o=0,s=0,n=[],l=[];const c=1-t;e.sort(((e,t)=>t.value-e.value));for(let r=0;r<e.length;r++){i+=e[r].value;const t={name:void 0===e[r].name?`series${r}`:e[r].name,type:"surface",parametric:!0,wireframe:{show:!1},pieData:e[r],pieStatus:{selected:!1,hovered:!1,k:c}};if(void 0!==e[r].itemStyle){const a={};void 0!==e[r].itemStyle.color&&(a.color=e[r].itemStyle.color),void 0!==e[r].itemStyle.opacity&&(a.opacity=e[r].itemStyle.opacity),t.itemStyle=a}a.push(t)}n=[],l=[];for(let h=0;h<a.length;h++){s=o+a[h].pieData.value,a[h].pieData.startRatio=o/i,a[h].pieData.endRatio=s/i,a[h].parametricEquation=p(a[h].pieData.startRatio,a[h].pieData.endRatio,!1,!1,c,a[h].pieData.value),o=s;const e=r(a[h].pieData.value/i,4);n.push({name:a[h].name,value:e}),l.push({name:a[h].name,value:e})}const u=((e,t)=>(e.sort(((e,t)=>t.pieData.value-e.pieData.value)),25*t/e[0].pieData.value))(a,6),m={tooltip:{show:!1,formatter:e=>{if("mouseoutSeries"!==e.seriesName&&"pie2d"!==e.seriesName){const t=(100*(m.series[e.seriesIndex].pieData.endRatio-m.series[e.seriesIndex].pieData.startRatio)).toFixed(0);return`${e.seriesName}<br/><span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${e.color};"></span>${t}%`}}},xAxis3D:{min:-1,max:1},yAxis3D:{min:-1,max:1},zAxis3D:{min:-1,max:1},grid3D:{show:!1,boxHeight:u,left:0,top:-10,viewControl:{alpha:30,distance:180,rotateSensitivity:0,zoomSensitivity:0,panSensitivity:0,autoRotate:!1}},series:a};return m},A=()=>{b.push({name:"StatisticalCenter"})};return v((()=>{o()})),(e,t)=>{const a=f("el-empty");return d(),y("div",I,[i.value.length>0?(d(),x(M(n),{key:0,ref:"vchart",class:"flex-1 flex",option:s.value,autoresize:"",onClick:A},null,8,["option"])):(d(),y("div",O,[w(a,{description:"暂无数据",image:M(c),"image-size":80},null,8,["image"])]))])}}},t(A,a(z))));var A,z;export{R as _};
