import{d as e,A as a,a0 as l,Y as t,n as o,V as s,r as i,o as r,c as n,e as d,J as u,L as c,t as m,I as p,b as f,h as v,u as y,a2 as x,g as b,X as h,a5 as g,R as j,U as k,a1 as w,ay as _,_ as S}from"./index-OtYEJMgP.js";import{B as L}from"./index.esm.min-p6OgvXm7.js";import{Z as T}from"./StatisticalCenter-fzPo9Omj.js";import{e as V}from"./mitt-ei5ABelY.js";import{_ as R}from"./DurationSelector.vue_vue_type_style_index_0_lang-9IzWcL2C.js";import{u as B,L as I,i as A}from"./installCanvasRenderer-kp6nwiR2.js";import{i as C}from"./install-wLyK8H0F.js";import{i as D}from"./install-q7ZRUXrs.js";import{i as O}from"./install-nwvgNUQF.js";import{i as Y}from"./install-8-Qe0jiJ.js";import{i as z}from"./install-uIlpgulU.js";import"./weekday-rhQYfdMI.js";import"./Axis-xmqQ_bGV.js";import"./dataSample-MvCW8qRP.js";import"./createSeriesData-rVoIjXPv.js";import"./sectorHelper-nVwTOMBE.js";const P={class:"item"},U={class:"item-title"},M=(e=>(j("data-v-f45b0944"),e=e(),k(),e))((()=>d("span",{class:"item-title-text"},"各单位作业计划",-1))),F={class:"flex-1 flex flex-row justify-end"},X=["onClick"],Z={class:"btn-text"},q={class:"item-content table-container"},E={class:"flex-1 flex flex-col w-full"},H=S(e({__name:"index",setup(e){B([C,D,O,Y,A,z]);const j=[{label:"月",value:"month"},{label:"周",value:"week"},{label:"日",value:"day"}],k=a("month"),S=l({dateType:"month",multiple:!0,cityOrgIds:[],majorTypes:[],workRiskLevels:[],dates:[]}),H=e=>{S.dates=e.selected||[],W()};const J=a(!1),N=t([]),W=g((()=>{return e=this,a=null,l=function*(){J.value=!0,N.value=[];const e=k.value,{cityOrgIds:a,majorTypes:l,workRiskLevels:t,dates:o}=S;let s=[];"day"==e&&"day"!==S.dateType?o.forEach((e=>{s=s.concat(function(e,a){const l=[];let t=_(e);const o=_(a);for(;t.isBefore(o)||t.isSame(o,"day");)l.push(t.format("YYYY-MM-DD")),t=t.add(1,"day");return l}(e.beginDate,e.endDate).map((e=>({beginDate:e,endDate:e,dateCondition:e}))))})):s=o;const i={dateType:e,cityOrgIds:a.join(","),majorType:l.join(","),workRiskLevel:t.join(","),dates:s};T(i).then((e=>{w!==e&&(N.value=e||[])})).finally((()=>{J.value=!1}))},new Promise(((t,o)=>{var s=e=>{try{r(l.next(e))}catch(a){o(a)}},i=e=>{try{r(l.throw(e))}catch(a){o(a)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,i);r((l=l.apply(e,a)).next())}));var e,a,l}),1e3),G=o((()=>{let e={};return e="month"===k.value?{normal:{color:new I(0,0,0,1,[{offset:0,color:"#187fe4"},{offset:1,color:"#71a0fa"}])},barBorderRadius:[2,2,0,0]}:"week"===k.value?{normal:{color:new I(0,0,0,1,[{offset:0,color:"#00c1c1"},{offset:1,color:"#00ffff"}])},barBorderRadius:[2,2,0,0]}:{normal:{color:new I(0,0,0,1,[{offset:0,color:"#f59b26"},{offset:1,color:"#facd91"}])},barBorderRadius:[2,2,0,0]},{tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"15%",right:"5%",left:"8%"},dataZoom:[{show:!0,realtime:!0,startValue:0,endValue:6,xAxisIndex:[0],height:18,bottom:18},{type:"inside",realtime:!0,startValue:0,endValue:6,xAxisIndex:[0]}],xAxis:[{type:"category",data:N.value.map((e=>e.XAxis)),axisLine:{lineStyle:{color:"#1b5059"}},axisLabel:{margin:10,color:"fff",textStyle:{fontSize:10}},axisTick:{show:!1}}],yAxis:[{type:"value",name:"单位(项)",minInterval:1,nameTextStyle:{color:"#fff",fontSize:14},axisLabel:{formatter:"{value}",color:"#fff",fontSize:12,align:"center"},axisTick:{show:!1},axisLine:{show:!1},splitLine:{lineStyle:{color:"#1b5059",type:"solid"}}}],series:[{type:"bar",data:N.value.map((e=>e.YAxis)),barWidth:"24px",itemStyle:e}]}}));return s((()=>{V.on("StatisticalCenterPlanStatisticsReload",(()=>{W()}))})),(e,a)=>{const l=i("el-option"),t=i("el-select"),o=i("el-form-item"),s=i("el-form");return r(),n("div",P,[d("div",U,[M,d("div",F,[(r(),n(u,null,c(j,(e=>d("div",{key:e.value,class:m(["tab-btn cursor-pointer",{active:k.value===e.value}]),onClick:a=>{return l=e.value,k.value=l,void h((()=>{"day"===l?(S.dateType="week",S.multiple=!1):(S.dateType=l,S.multiple=!0)}));var l}},[d("span",Z,p(e.label),1)],10,X))),64))])]),d("div",q,[f(s,{inline:!0,class:"w-full table-query"},{default:v((()=>[f(o,{class:"m-0"},{default:v((()=>[f(t,{modelValue:S.cityOrgIds,"onUpdate:modelValue":a[0]||(a[0]=e=>S.cityOrgIds=e),placeholder:"请选择市级公司",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",onFocus:y(x)().loadCityOrg,onBlur:y(W)},{default:v((()=>[(r(!0),n(u,null,c(y(x)().cityOrg,(e=>(r(),b(l,{key:e.id,value:e.id,label:e.shortName||e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onFocus","onBlur"])])),_:1}),f(o,{class:"m-0"},{default:v((()=>[f(t,{modelValue:S.majorTypes,"onUpdate:modelValue":a[1]||(a[1]=e=>S.majorTypes=e),placeholder:"请选择专业",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",onBlur:y(W)},{default:v((()=>[(r(!0),n(u,null,c(y(x)().workerMajorList,(e=>(r(),b(l,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onBlur"])])),_:1}),f(o,{class:"m-0"},{default:v((()=>[f(t,{modelValue:S.workRiskLevels,"onUpdate:modelValue":a[2]||(a[2]=e=>S.workRiskLevels=e),placeholder:"请选择作业风险等级",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",onBlur:y(W)},{default:v((()=>[(r(!0),n(u,null,c(y(x)().workRiskLevelList,(e=>(r(),b(l,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onBlur"])])),_:1}),f(o,{class:"m-0"},{default:v((()=>[f(R,{"date-type":S.dateType,multiple:S.multiple,onOnSelectionChange:H},null,8,["date-type","multiple"])])),_:1})])),_:1}),d("div",E,[f(y(L),{ref:"vchart",class:"w-full h-full",option:G.value,autoresize:""},null,8,["option"])])])])}}}),[["__scopeId","data-v-f45b0944"]]);export{H as default};
