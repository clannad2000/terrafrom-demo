var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,i=(e,a,l)=>new Promise(((t,s)=>{var n=e=>{try{i(l.next(e))}catch(a){s(a)}},r=e=>{try{i(l.throw(e))}catch(a){s(a)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,r);i((l=l.apply(e,a)).next())}));import{H as o,I as u,J as c,K as p,L as d,M as m}from"./StatisticalCenter-fzPo9Omj.js";import{E as f}from"./icon_no_data-JkxAPqfn.js";import{_ as g,a as v,b as y}from"./insRanking_5-HpXp5MSE.js";import{d as b,z as x,n as h,A as w,a0 as k,bR as D,Y as j,at as _,r as R,j as I,o as N,c as O,e as S,J as P,L as C,t as L,I as T,b as U,h as z,a4 as F,u as K,a2 as V,w as A,g as E,N as M,a5 as B,R as H,U as J,a1 as q,_ as W}from"./index-OtYEJMgP.js";import{d as X}from"./constants-uiyZ18jc.js";import Y from"./PatrolRankByOrgDialog-rkTb0pYj.js";const $=""+new URL("../png/insRanking_1-zF0iNLsd.png",import.meta.url).href,G=""+new URL("../png/insRanking_2-X7pfKAfW.png",import.meta.url).href,Q=""+new URL("../png/insRanking_6-FUhHVKF6.png",import.meta.url).href,Z=""+new URL("../png/insRanking_7-hiyyMwPr.png",import.meta.url).href,ee=e=>(H("data-v-e7492f90"),e=e(),J(),e),ae={class:"item"},le={class:"item-title gap-x-4"},te=ee((()=>S("span",{class:"item-title-text"},"各专业作业计划巡查排名",-1))),se={class:"flex-1 flex flex-row justify-end gap-x-4"},ne={class:"flex flex-row"},re=["onClick"],ie={class:"btn-text"},oe={class:"flex-1 flex flex-row"},ue={class:"item-content table-container gap-y-2"},ce={class:"w-full flex flex-row items-center justify-end"},pe={class:"text-white text-sm"},de={class:"text-[#00e7e8] text-sm font-bold"},me={class:"flex-1 flex w-full"},fe={class:"w-full h-full grid grid-rows-2 grid-cols-12 gap-2"},ge=["onClick"],ve={class:"w-full flex-1 flex flex-col items-center justify-center gap-y-2 relative"},ye=["src"],be={class:"text-sm text-white font-bold z-10 -translate-y-2"},xe={class:"flex flex-row items-end gap-x-1 -translate-y-2 z-10"},he={class:"num"},we=ee((()=>S("span",{class:"unit"},"次",-1))),ke={class:"num"},De=ee((()=>S("span",{class:"unit"},"时",-1))),je={class:"num"},_e=ee((()=>S("span",{class:"unit"},"分",-1))),Re={class:"num"},Ie=ee((()=>S("span",{class:"unit"},"项",-1))),Ne={class:"text-white text-base font-bold"},Oe={key:1,class:"w-full h-full flex flex-row items-center justify-center"},Se=b((Pe=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))n.call(a,l)&&r(e,l,a[l]);return e})({},{name:"PlanPatrolRankByMajorType"}),Ce={__name:"index",props:{ipSource:{default:""},beginDate:{default:X.range.default[0]},endDate:{default:X.range.default[1]}},setup(e,{expose:a}){const l=e,[t,{showDialog:s,setDialogProps:n}]=x(),r={0:$,1:G,2:g,3:v,4:y,5:Q,6:Z},b=[{label:"次数",value:"num"},{label:"时长",value:"duration"},{label:"作业数",value:"taskNum"}],H={num:{page:o,total:u},duration:{page:c,total:p},taskNum:{page:d,total:m}},J=h((()=>({nodeKey:"id",props:{label:e=>e.shortName||e.name,children:"children"}}))),W=w("num"),X=k({orgId:"",ipSource:"",beginDate:"",endDate:""}),ee=h((()=>D(Ce.value,7))),Se=h((()=>e=>{if(!e.includes("时")||!e.includes("分"))return[0,0];const[a,l]=e.split("时").map((e=>parseInt(e.replace("分",""))||0));return[a,l]})),Pe=w(!1),Ce=j([]),Le=B((()=>i(this,null,(function*(){if(!H[W.value])return;stop(),Pe.value=!0,Ce.value=[];const{orgId:e,ipSource:a,beginDate:l,endDate:t}=X,s={orgId:e,ipSource:a,beginDate:l,endDate:t,pageNum:1,pageSize:1e3};H[W.value].page(s).then((e=>{if(q!==e){const{rows:a=[]}=e;Ce.value=a,Ue()}})).catch((e=>{console.log(e)})).finally((()=>{Pe.value=!1}))}))),1e3),Te=w("0"),Ue=B((()=>i(this,null,(function*(){if(!H[W.value])return;const{ipSource:e,beginDate:a,endDate:l,orgId:t}=X,s={ipSource:e,beginDate:a,endDate:l,orgId:t};H[W.value].total(s).then((e=>{q!==e&&(Te.value=e||("num"===W.value||"taskNum"===W.value?"0":"duration"===W.value?"0时0分":""))})).finally((()=>{Pe.value=!1}))}))),1e3);return _((()=>l),(()=>{const{ipSource:e,beginDate:a,endDate:t}=l;Object.assign(X,{beginDate:a,endDate:t,ipSource:e})}),{deep:!0,immediate:!0}),a({loadData:Le}),(e,a)=>{const l=R("el-tree-select"),i=R("el-form-item"),o=R("el-form"),u=R("el-carousel-item"),c=R("el-carousel"),p=R("el-empty"),d=I("loading");return N(),O("div",ae,[S("div",le,[te,S("div",se,[S("div",ne,[(N(),O(P,null,C(b,(e=>S("div",{key:e.value,class:L(["tab-btn cursor-pointer",{active:W.value===e.value}]),onClick:a=>{return l=e.value,W.value=l,Te.value="num"===W.value||"taskNum"===W.value?"0":"duration"===W.value?"0时0分":"",Ce.value=[],void Le();var l}},[S("span",ie,T(e.label),1)],10,re))),64))]),S("div",oe,[U(o,{inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:z((()=>[U(i,{class:"m-0"},{default:z((()=>[U(l,F({modelValue:X.orgId,"onUpdate:modelValue":a[0]||(a[0]=e=>X.orgId=e),data:K(V)().cityOrgTreeAll,"render-after-expand":!1,clearable:""},J.value,{"check-strictly":!0,"highlight-current":!0,"expand-on-click-node":!1,placeholder:"请选择单位",onChange:K(Le)}),null,16,["modelValue","data","onChange"])])),_:1})])),_:1})])])]),A((N(),O("div",ue,[S("div",ce,[S("span",pe,T("num"===W.value?"巡查次数：":"duration"===W.value?"巡查时长：":"taskNum"===W.value?"巡查计划：":""),1),S("span",de,T(Te.value),1)]),S("div",me,[ee.value.length?(N(),E(c,{key:0,class:"w-full h-full","indicator-position":"none"},{default:z((()=>[(N(!0),O(P,null,C(ee.value,((e,a)=>(N(),E(u,{key:a},{default:z((()=>[S("div",fe,[(N(!0),O(P,null,C(e,((e,l)=>(N(),O("div",{key:l,class:"major-carousel-item",onClick:a=>(e=>{const{majorType:a,majorTypeName:l}=e,{ipSource:t,beginDate:r,endDate:i,orgId:o}=X,u={ipSource:t,beginDate:r,endDate:i,orgId:o,majorType:a,rankType:W.value};n({title:`各单位巡查排名（${l}）`}),s(!0,{type:"view",data:u})})(e)},[S("div",ve,[S("img",{class:"absolute h-full",src:r[l]},null,8,ye),S("span",be,"NO."+T(7*a+l+1),1),S("div",xe,["num"===W.value?(N(),O(P,{key:0},[S("span",he,T(e.count),1),we],64)):"duration"===W.value?(N(),O(P,{key:1},[S("span",ke,T(Se.value(e.durationFormat)[0]),1),De,S("span",je,T(Se.value(e.durationFormat)[1]),1),_e],64)):"taskNum"===W.value?(N(),O(P,{key:2},[S("span",Re,T(e.count),1),Ie],64)):M("",!0)])]),S("span",Ne,T(e.majorTypeName),1)],8,ge)))),128))])])),_:2},1024)))),128))])),_:1})):(N(),O("div",Oe,[U(p,{description:"暂无数据",image:K(f),"image-size":80},null,8,["image"])]))])])),[[d,Pe.value]]),U(Y,{onRegister:K(t)},null,8,["onRegister"])])}}},a(Pe,l(Ce))));var Pe,Ce;const Le=W(Se,[["__scopeId","data-v-e7492f90"]]);export{Le as default};
