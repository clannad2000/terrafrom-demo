var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o;import{d as n,z as i,A as p,a0 as c,F as u,r as d,j as g,w as f,o as b,c as m,e as w,b as v,h,f as x,I as _,u as y,a2 as C,M as j,a1 as z,a6 as k}from"./index-OtYEJMgP.js";import{b as O,c as S,f as F,h as N}from"./DeviceManage-aryRM0Sb.js";import{b as P}from"./constants-uiyZ18jc.js";import{_ as V}from"./EditDialog.vue_vue_type_script_setup_true_lang-IKjh3JTy.js";const D={class:"h-full table-container"},U={class:"flex flex-col h-full gap-y-4"},E=n((I=((e,a)=>{for(var l in a||(a={}))t.call(a,l)&&r(e,l,a[l]);if(o)for(var l of o(a))s.call(a,l)&&r(e,l,a[l]);return e})({},{name:"FirmwareRecordIndex"}),a(I,l({__name:"index",setup(e){const[a,{showDialog:l,setDialogProps:o}]=i(),t=p(!1),s=c({condition:""}),r=p([]),n=c({pageNum:1,pageSize:10,total:0}),E=e=>new Promise(((a,l)=>{t.value=!0;let o=null;o="1"==e.enabledFlag?F:N,o({id:e.id}).then((o=>{z!==o?(k.success(("1"==e.enabledFlag?"停用":"启用")+"成功!"),a(!0)):(k.error(("1"==e.enabledFlag?"停用":"启用")+"失败!"),l(!1))})).catch((()=>{k.error(("1"==e.enabledFlag?"停用":"启用")+"失败!"),l(!1)})).finally((()=>{t.value=!1}))})),I=()=>{t.value=!0;const{pageSize:e,pageNum:a}=n,{condition:l}=s;O({condition:l,pageSize:e,pageNum:a}).then((e=>{if(e&&z!==e){const{rows:a=[],total:l=0}=e;r.value=a,n.total=Number(l)||0}})).finally((()=>{t.value=!1}))},R=()=>{n.pageNum=1,I()},T=()=>{I()},M=()=>{l(!0,{type:"add"}),o({title:"上传程序"})};return u((()=>{I()})),(e,l)=>{const o=d("el-input"),i=d("el-form-item"),p=d("el-button"),c=d("el-form"),u=d("el-table-column"),O=d("el-switch"),F=d("el-popconfirm"),N=d("el-table"),I=d("el-pagination"),q=g("loading");return f((b(),m("div",D,[w("div",U,[v(c,{inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:h((()=>[v(i,{label:"程序",class:"m-0"},{default:h((()=>[v(o,{modelValue:s.condition,"onUpdate:modelValue":l[0]||(l[0]=e=>s.condition=e),clearable:"",placeholder:"请输入程序版本/文件名",maxlength:"20"},null,8,["modelValue"])])),_:1}),v(i,{label:"",class:"m-0"},{default:h((()=>[v(p,{class:"basic-button",onClick:R},{default:h((()=>[x(" 查询 ")])),_:1}),v(p,{class:"basic-button",onClick:M},{default:h((()=>[x(" 上传程序 ")])),_:1})])),_:1})])),_:1}),v(N,{class:"w-full h-full",data:r.value},{default:h((()=>[v(u,{prop:"deviceType",align:"center",label:"设备类型","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:h((({row:e})=>[x(_(y(C)().groupCodeObj(y(C)().deviceTypeList,"code",e.deviceType).name),1)])),_:1}),v(u,{prop:"version",align:"center",label:"程序版本","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),v(u,{prop:"fileName",align:"center",label:"文件名","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),v(u,{prop:"fileSize",align:"center",label:"文件大小",formatter:y(P),"show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},null,8,["formatter"]),v(u,{prop:"enabledFlag",align:"left",label:"状态"},{default:h((({row:e})=>[v(O,{modelValue:e.enabledFlag,"onUpdate:modelValue":a=>e.enabledFlag=a,"active-value":"1","inactive-value":"0",loading:t.value,"before-change":E.bind(this,e)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])])),_:1}),v(u,{prop:"uploadDt",align:"center",label:"上传时间","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),v(u,{prop:"remark",align:"center",label:"文件说明","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),v(u,{fixed:"right",align:"center",label:"操作",width:"240"},{default:h((({row:e})=>[v(F,{title:"确认删除?",onConfirm:a=>(e=>{t.value=!0,S({id:e.id}).then((e=>{z!==e&&(k.success("删除成功!"),R())})).finally((()=>{t.value=!1}))})(e)},{reference:h((()=>[v(p,{link:"",type:"danger",onClick:l[1]||(l[1]=j((()=>{}),["stop"]))},{default:h((()=>[x(" 删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),v(I,{"current-page":n.pageNum,"onUpdate:currentPage":l[2]||(l[2]=e=>n.pageNum=e),"page-size":n.pageSize,"onUpdate:pageSize":l[3]||(l[3]=e=>n.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:n.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:R,onCurrentChange:T},null,8,["current-page","page-size","total"])]),v(V,{onRegister:y(a),onConfirm:R},null,8,["onRegister"])])),[[q,t.value]])}}}))));var I;export{E as _};
