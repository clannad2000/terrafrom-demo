var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o;import{d as s,z as n,A as p,a0 as d,n as c,V as u,F as m,H as w,r as v,j as g,w as f,o as h,c as b,e as y,b as x,h as C,a4 as _,u as k,a2 as j,J as T,L as N,g as P,f as V,I as z,M as I,a1 as D,_ as O}from"./index-OtYEJMgP.js";import{x as S,y as U}from"./DeviceManage-aryRM0Sb.js";import{u as R}from"./useThrottle-fY6V1GyW.js";import{d as M}from"./download-z--BcN7F.js";import L from"./editTerminalDialog-shrFlXQ_.js";import{_ as F}from"./ReplaceDialog.vue_vue_type_script_setup_true_lang-AyglQlmZ.js";import{_ as A}from"./ScrapDialog.vue_vue_type_script_setup_true_lang-whEF2bGf.js";import"./index-fHT9WYUA.js";const B={class:"w-full h-full flex flex-col gap-y-4 table-container"},K={class:"flex flex-col h-full gap-y-4"},$=s((q=((e,a)=>{for(var l in a||(a={}))t.call(a,l)&&i(e,l,a[l]);if(o)for(var l of o(a))r.call(a,l)&&i(e,l,a[l]);return e})({},{name:"TerminalUnitIndex"}),a(q,l({__name:"index",setup(e){const[a,{showDialog:l,setDialogProps:o}]=n(),[t,{showDialog:r,setDialogProps:i}]=n(),[s,{showDialog:O,setDialogProps:$}]=n(),q=p(!1),E=d({orgId:"",majorTypes:[],deviceCondition:"",deviceType:"",deviceNetworkProvider:""}),H=d({pageNum:1,pageSize:10,total:0}),J=c((()=>({nodeKey:"id",props:{label:e=>e.shortName||e.name,children:"children"}}))),Q=p([]),[G,W]=R((()=>{H.pageNum=1,Y()}),800,{debounce:!0}),X=()=>{o({title:"新增设备"}),l(!0,{type:"add",data:null})},Y=()=>{q.value=!0;const{pageSize:e,pageNum:a}=H,{orgId:l,majorTypes:o=[],deviceCondition:t,deviceType:r,deviceNetworkProvider:i}=E;S({orgId:l,majorType:o.join(","),deviceCondition:t,deviceType:r,deviceNetworkProvider:i,pageSize:e,pageNum:a}).then((e=>{if(e&&D!==e){const{rows:a=[],total:l=0}=e;Q.value=a,H.total=Number(l)||0}})).finally((()=>{q.value=!1}))},Z=()=>{return e=this,a=null,l=function*(){q.value=!0;const{orgId:e,majorTypes:a=[],deviceCondition:l,deviceType:o,deviceNetworkProvider:t}=E;yield U({orgId:e,majorType:a.join(","),deviceCondition:l,deviceType:o,deviceNetworkProvider:t}).then((e=>{if(e&&(null==e?void 0:e.data)){const a=e.headers["content-disposition"];let l="unknown";a&&(l=window.decodeURI(a.split("=")[1])),M(e.data,l)}})).finally((()=>{q.value=!1}))},new Promise(((o,t)=>{var r=e=>{try{s(l.next(e))}catch(a){t(a)}},i=e=>{try{s(l.throw(e))}catch(a){t(a)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,i);s((l=l.apply(e,a)).next())}));var e,a,l};return u((()=>{})),m((()=>{G()})),w((()=>{W()})),(e,n)=>{const p=v("el-tree-select"),d=v("el-form-item"),c=v("el-option"),u=v("el-select"),m=v("el-input"),w=v("el-button"),D=v("el-form"),S=v("el-table-column"),U=v("el-popconfirm"),R=v("el-table"),M=v("el-pagination"),W=g("loading");return f((h(),b("div",B,[y("div",K,[x(D,{inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:C((()=>[x(d,{label:"管理部门",class:"m-0"},{default:C((()=>[x(p,_({modelValue:E.orgId,"onUpdate:modelValue":n[0]||(n[0]=e=>E.orgId=e),data:k(j)().orgTreeByUser,"render-after-expand":!1,clearable:""},J.value,{"check-strictly":!0,"highlight-current":!0,"expand-on-click-node":!1,placeholder:"请选择管理部门",onFocus:k(j)().loadOrgTreeByUser}),null,16,["modelValue","data","onFocus"])])),_:1}),x(d,{label:"专业",class:"m-0"},{default:C((()=>[x(u,{modelValue:E.majorTypes,"onUpdate:modelValue":n[1]||(n[1]=e=>E.majorTypes=e),placeholder:"请选择专业",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:C((()=>[(h(!0),b(T,null,N(k(j)().workerMajorList,(e=>(h(),P(c,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),x(d,{label:"设备名称",class:"m-0"},{default:C((()=>[x(m,{modelValue:E.deviceCondition,"onUpdate:modelValue":n[2]||(n[2]=e=>E.deviceCondition=e),clearable:"",placeholder:"请输入设备名称/编号",maxlength:"20"},null,8,["modelValue"])])),_:1}),x(d,{label:"设备类型",class:"m-0"},{default:C((()=>[x(u,{modelValue:E.deviceType,"onUpdate:modelValue":n[3]||(n[3]=e=>E.deviceType=e),placeholder:"请选择设备类型",clearable:""},{default:C((()=>[(h(!0),b(T,null,N(k(j)().deviceTypeList,(e=>(h(),P(c,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),x(d,{label:"运营商",class:"m-0"},{default:C((()=>[x(u,{modelValue:E.deviceNetworkProvider,"onUpdate:modelValue":n[4]||(n[4]=e=>E.deviceNetworkProvider=e),placeholder:"请选择运营商",clearable:""},{default:C((()=>[(h(!0),b(T,null,N(k(j)().providerList,(e=>(h(),P(c,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),x(d,{label:"",class:"m-0"},{default:C((()=>[x(w,{class:"basic-button",onClick:k(G)},{default:C((()=>[V(" 查询 ")])),_:1},8,["onClick"]),x(w,{class:"basic-button",onClick:X},{default:C((()=>[V(" 新增 ")])),_:1}),x(w,{class:"basic-button",onClick:Z},{default:C((()=>[V(" 导出 ")])),_:1})])),_:1})])),_:1}),x(R,{class:"w-full h-full",data:Q.value,"show-overflow-tooltip":""},{default:C((()=>[x(S,{type:"index",label:"序号",width:"80",align:"center"},{default:C((e=>[y("span",null,z((H.pageNum-1)*H.pageSize+e.$index+1),1)])),_:1}),x(S,{prop:"cityOrgName",align:"center",label:"市级公司","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"orgName",align:"center",label:"管理部门","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceName",align:"center",label:"设备名称","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceCode",align:"center",label:"设备编码","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceTypeName",align:"center",label:"设备类型","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"majorTypeName",align:"center",label:"专业","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceManufactor",align:"center",label:"设备厂家","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceModel",align:"center",label:"设备型号","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceNetworkProviderName",align:"center",label:"运营商","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"registerTime",align:"center",label:"注册时间","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"lastLoginTime",align:"center",label:"最近上线时间","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceAdmin",align:"center",label:"设备管理员","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{prop:"deviceAdminTel",align:"center",label:"设备管理员联系方式","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),x(S,{fixed:"right",label:"操作",width:"240",align:"center"},{default:C((({row:e})=>[x(w,{type:"primary",link:"",onClick:a=>{return t=e,o({title:"编辑设备"}),void l(!0,{type:"edit",data:t});var t}},{default:C((()=>[V(" 编辑 ")])),_:2},1032,["onClick"]),x(U,{title:"完成更换后，原设备中的文件将无法上传，请知悉。",width:"300",onConfirm:a=>{return l=e,$({title:"更换设备"}),void O(!0,{type:"replace",data:l});var l}},{reference:C((()=>[x(w,{link:"",type:"warning",onClick:n[5]||(n[5]=I((()=>{}),["stop"]))},{default:C((()=>[V("更换")])),_:1})])),_:2},1032,["onConfirm"]),x(U,{title:"完成报废后，原设备中的文件将无法上传，请知悉。",width:"300",onConfirm:a=>{return l=e,i({title:"报废设备"}),void r(!0,{type:"scrap",data:l});var l}},{reference:C((()=>[x(w,{link:"",type:"danger",onClick:n[6]||(n[6]=I((()=>{}),["stop"]))},{default:C((()=>[V("报废")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),x(M,{"current-page":H.pageNum,"onUpdate:currentPage":n[7]||(n[7]=e=>H.pageNum=e),"page-size":H.pageSize,"onUpdate:pageSize":n[8]||(n[8]=e=>H.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:H.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:k(G),onCurrentChange:Y},null,8,["current-page","page-size","total","onSizeChange"])]),x(L,{onRegister:k(a),onConfirm:k(G)},null,8,["onRegister","onConfirm"]),x(A,{onRegister:k(t),onConfirm:k(G)},null,8,["onRegister","onConfirm"]),x(F,{onRegister:k(s),onConfirm:k(G)},null,8,["onRegister","onConfirm"])])),[[W,q.value]])}}}))));var q;const E=O($,[["__scopeId","data-v-62c2c69a"]]);export{E as default};
