import{v as e,w as a}from"./DeviceManage-aryRM0Sb.js";import{d as l,a8 as r,a2 as d,A as o,n as i,a0 as t,H as c,r as s,o as n,g as u,h as m,e as v,b as g,f as p,u as b,ab as f,c as y,J as h,L as T,a4 as V,a9 as w,a1 as x,a6 as I,R as _,U as M,aK as O,_ as A}from"./index-OtYEJMgP.js";const N=e=>(_("data-v-693e3810"),e=e(),M(),e),k=N((()=>v("p",{class:"text-[#aeaeae] text-[14px]"},[p(" 1.设备名称命名规则："),v("br"),p(" ①地市公司名称简称:超特高压公司、南京公司、苏州公司"),v("br"),p(" ②工区/县/供服中心名称规范要求：单位规范全称中剔除“国网”、“供电”这两词语，示例：国网南京市供电公司应缩写为南京市公司。"),v("br"),p("③设备名称格式为：地市公司名称简称-工区/县/供服中心名称-班组名称全称-01 ")],-1))),C=N((()=>v("br",null,null,-1))),j=N((()=>v("p",{class:"text-[#aeaeae] text-[14px]"},"2.设备编码规范：使用数字和小写字母",-1))),U={class:"dialog-footer"},$=A(l({__name:"editTerminalDialog",emits:["register","confirm"],setup(l,{emit:_}){let M="";const A=_,[N,{closeDialog:$}]=r((e=>{const{type:a,data:l}=e;if(M=a,d().loadCityOrgByUser(),"edit"===a){const{id:e,cityOrgId:a,orgId:r,deviceCode:o,deviceName:i,majorType:t,deviceType:c,deviceManufactor:s,deviceNetworkProvider:n,deviceModel:u,deviceAdmin:m,deviceAdminTel:v}=l||{};Object.assign(L,{id:e,cityOrgId:a,orgId:r,deviceCode:o,deviceName:i,majorType:t,deviceType:c,deviceManufactor:s,deviceNetworkProvider:n,deviceModel:u,deviceAdmin:m,deviceAdminTel:v}),d().loadOrgTreeByOrgId(a)}})),P=o(!1),q=o(null),B={cityOrgId:[{required:!0,message:"请选择市级公司！",trigger:"change"}],orgId:[{required:!0,message:"请选择管理部门！",trigger:"change"}],majorType:[{required:!0,message:"请选择专业！",trigger:"change"}],deviceType:[{required:!0,message:"请选择设备类型！",trigger:"change"}],deviceCode:[{required:!0,message:"请填写设备编码！",trigger:"blur"},{validator(e,a,l){/^[a-z0-9]+$/.test(a)?l():l(new Error("设备编码仅包含数字和小写字母！"))},trigger:"blur"},{max:32,message:"设备编码长度不能超过32位！",trigger:"blur"}],deviceName:[{required:!0,message:"请填写设备名称！",trigger:"blur"},{max:256,message:"设备名称长度不能超过256位！",trigger:"blur"}],deviceManufactor:[{required:!0,message:"请填写设备厂家！",trigger:"blur"},{max:32,message:"设备厂家长度不能超过32位！",trigger:"blur"}],deviceModel:[{required:!0,message:"请填写设备型号！",trigger:"blur"},{max:32,message:"设备型号长度不能超过32位！",trigger:"blur"}],deviceAdmin:[{required:!0,message:"请填写设备管理人员！",trigger:"blur"},{max:32,message:"设备管理人员长度不能超过32位！",trigger:"blur"}],deviceAdminTel:[{required:!0,message:"请填写设备管理人员联系方式！",trigger:"blur"},{validator(e,a,l){O.mobile.test(a)?l():l(new Error("请填写正确的联系方式！"))},trigger:"blur"},{max:32,message:"设备管理人员联系方式长度不能超过32位！",trigger:"blur"}]},D=i((()=>({nodeKey:"id",props:{label:e=>e.shortName||e.name,children:"children"}}))),L=t({id:"",cityOrgId:"",orgId:"",deviceCode:"",deviceName:"",majorType:"",deviceType:"",deviceManufactor:"",deviceNetworkProvider:"",deviceModel:"",deviceAdmin:"",deviceAdminTel:""}),E=()=>{L.orgId="",d().loadOrgTreeByOrgId(L.cityOrgId)},F=function(){var e;P.value=!1,$(),M="",Object.keys(L).forEach((e=>{L[e]=""})),null==(e=q.value)||e.clearValidate()},R=function(){var l;null==(l=q.value)||l.validate((l=>{return r=this,d=null,o=function*(){if(l){P.value=!0;const{id:l,cityOrgId:r,orgId:d,deviceCode:o,deviceName:i,majorType:t,deviceType:c,deviceManufactor:s,deviceNetworkProvider:n,deviceModel:u,deviceAdmin:m,deviceAdminTel:v}=L;"add"===M?e({cityOrgId:r,orgId:d,deviceCode:o,deviceName:i,majorType:t,deviceType:c,deviceManufactor:s,deviceNetworkProvider:n,deviceModel:u,deviceAdmin:m,deviceAdminTel:v}).then((e=>{x!==e&&(I.success("添加设备成功！"),F(),A("confirm"))})).finally((()=>{P.value=!1})):"edit"===M?a({id:l,cityOrgId:r,orgId:d,deviceCode:o,deviceName:i,majorType:t,deviceType:c,deviceManufactor:s,deviceNetworkProvider:n,deviceModel:u,deviceAdmin:m,deviceAdminTel:v}).then((e=>{x!==e&&(I.success("编辑设备成功！"),F(),A("confirm"))})).finally((()=>{P.value=!1})):P.value=!1}},new Promise(((e,a)=>{var l=e=>{try{t(o.next(e))}catch(l){a(l)}},i=e=>{try{t(o.throw(e))}catch(l){a(l)}},t=a=>a.done?e(a.value):Promise.resolve(a.value).then(l,i);t((o=o.apply(r,d)).next())}));var r,d,o}))};return c((()=>{F()})),(e,a)=>{const l=s("el-option"),r=s("el-select"),o=s("el-form-item"),i=s("el-tree-select"),t=s("el-input"),c=s("el-alert"),x=s("el-button");return n(),u(b(w),{width:"960","show-fullscreen":!1,"show-close":!1,"destroy-on-close":"",center:"",onClose:F,onRegister:b(N)},{footer:m((()=>[v("span",U,[g(x,{class:"basic-button",disabled:P.value,onClick:F},{default:m((()=>[p(" 取消 ")])),_:1},8,["disabled"]),g(x,{class:"basic-button",loading:P.value,onClick:R},{default:m((()=>[p(" 保存 ")])),_:1},8,["loading"])])])),default:m((()=>[g(b(f),{ref_key:"refDeviceForm",ref:q,model:L,rules:B,inline:"","label-width":"184px","label-suffix":"："},{default:m((()=>[g(o,{label:"市级公司",prop:"cityOrgId"},{default:m((()=>[g(r,{modelValue:L.cityOrgId,"onUpdate:modelValue":a[0]||(a[0]=e=>L.cityOrgId=e),placeholder:"请选择市级公司",clearable:"",onFocus:b(d)().loadCityOrgByUser,onChange:E},{default:m((()=>[(n(!0),y(h,null,T(b(d)().cityOrgByUser,(e=>(n(),u(l,{key:e.id,value:e.id,label:e.shortName||e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onFocus"])])),_:1}),g(o,{label:"管理部门",prop:"orgId"},{default:m((()=>[g(i,V({modelValue:L.orgId,"onUpdate:modelValue":a[1]||(a[1]=e=>L.orgId=e),data:b(d)().orgTreeByOrgId,clearable:"","render-after-expand":!1,disabled:!L.cityOrgId},D.value,{"check-strictly":!0,"highlight-current":!0,"expand-on-click-node":!1,placeholder:"请选择管理部门"}),null,16,["modelValue","data","disabled"])])),_:1}),g(o,{label:"专业",prop:"majorType"},{default:m((()=>[g(r,{modelValue:L.majorType,"onUpdate:modelValue":a[2]||(a[2]=e=>L.majorType=e),placeholder:"请选择专业",clearable:""},{default:m((()=>[(n(!0),y(h,null,T(b(d)().workerMajorList,(e=>(n(),u(l,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(o,{label:"设备类型",prop:"deviceType"},{default:m((()=>[g(r,{modelValue:L.deviceType,"onUpdate:modelValue":a[3]||(a[3]=e=>L.deviceType=e),placeholder:"请选择设备类型",clearable:"",disabled:"edit"===b(M)},{default:m((()=>[(n(!0),y(h,null,T(b(d)().deviceTypeList,(e=>(n(),u(l,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),g(o,{label:"设备编码",prop:"deviceCode"},{default:m((()=>[g(t,{modelValue:L.deviceCode,"onUpdate:modelValue":a[4]||(a[4]=e=>L.deviceCode=e),clearable:"",maxlength:"32","show-word-limit":"",placeholder:"请填写设备编码",disabled:"edit"===b(M),formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1}),g(o,{label:"设备名称",prop:"deviceName"},{default:m((()=>[g(t,{modelValue:L.deviceName,"onUpdate:modelValue":a[5]||(a[5]=e=>L.deviceName=e),clearable:"",placeholder:"请填写设备名称",maxlength:"256",rows:4,type:"textarea","show-word-limit":"",formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","formatter","parser"])])),_:1}),g(o,{label:"设备厂家",prop:"deviceManufactor"},{default:m((()=>[g(t,{modelValue:L.deviceManufactor,"onUpdate:modelValue":a[6]||(a[6]=e=>L.deviceManufactor=e),clearable:"",placeholder:"请填写设备厂家",maxlength:"32","show-word-limit":"",formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","formatter","parser"])])),_:1}),g(o,{label:"设备型号",prop:"deviceModel"},{default:m((()=>[g(t,{modelValue:L.deviceModel,"onUpdate:modelValue":a[7]||(a[7]=e=>L.deviceModel=e),clearable:"",placeholder:"请填写设备型号",maxlength:"32","show-word-limit":"",formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","formatter","parser"])])),_:1}),g(o,{label:"设备管理人员",prop:"deviceAdmin"},{default:m((()=>[g(t,{modelValue:L.deviceAdmin,"onUpdate:modelValue":a[8]||(a[8]=e=>L.deviceAdmin=e),clearable:"",placeholder:"请填写设备管理人员",maxlength:"32","show-word-limit":"",formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","formatter","parser"])])),_:1}),g(o,{label:"设备管理人员联系方式",prop:"deviceAdminTel"},{default:m((()=>[g(t,{modelValue:L.deviceAdminTel,"onUpdate:modelValue":a[9]||(a[9]=e=>L.deviceAdminTel=e),clearable:"",placeholder:"请填写设备管理人员联系方式",maxlength:"32","show-word-limit":"",formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","formatter","parser"])])),_:1}),g(o,{label:"运营商",prop:"deviceNetworkProvider"},{default:m((()=>[g(r,{modelValue:L.deviceNetworkProvider,"onUpdate:modelValue":a[10]||(a[10]=e=>L.deviceNetworkProvider=e),placeholder:"请选择运营商",clearable:""},{default:m((()=>[(n(!0),y(h,null,T(b(d)().providerList,(e=>(n(),u(l,{key:e.code,value:e.code,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(c,{type:"info",closable:!1,class:"bg-[#09455b]"},{default:m((()=>[k,C,j])),_:1})])),_:1},8,["model"])])),_:1},8,["onRegister"])}}}),[["__scopeId","data-v-693e3810"]]);export{$ as default};
