var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,p=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o;import{r as l,s as n,t as i,u as c}from"./StatisticalCenter-fzPo9Omj.js";import{d as u,A as g,a0 as m,Y as w,a8 as y,X as b,H as d,r as v,j as f,o as h,g as k,h as x,w as C,c as j,b as O,e as S,I as z,J as N,f as P,N as T,u as D,a9 as _,a5 as I,a1 as R,_ as E}from"./index-OtYEJMgP.js";const B={class:"flex-1 flex flex-col gap-y-2 my-2"},U=u((A=((e,a)=>{for(var t in a||(a={}))r.call(a,t)&&p(e,t,a[t]);if(o)for(var t of o(a))s.call(a,t)&&p(e,t,a[t]);return e})({},{name:"PatrolRankByOrgDialog"}),a(A,t({__name:"PatrolRankByOrgDialog",emits:["register","confirm"],setup(e,{emit:a}){const t=g(!1),o=m({ipSource:"",beginDate:"",endDate:"",majorType:"",orgId:"",rankType:""}),r=m({pageNum:1,pageSize:10,total:0}),s=()=>{r.pageNum=1,E()},p={num:{page:l},duration:{page:n},taskNum:{page:i},taskCover:{page:c}},u=w([]),E=I((()=>{return e=this,a=null,s=function*(){if(!p[o.rankType])return;t.value=!0,u.value=[];const{pageNum:e,pageSize:a}=r,{orgId:s,ipSource:l,beginDate:n,endDate:i,majorType:c}=o;yield p[o.rankType].page({orgId:s,ipSource:l,beginDate:n,endDate:i,majorType:c,pageNum:e,pageSize:a}).then((e=>{if(e&&R!==e){const{rows:a,total:t}=e;u.value=a||[],r.total=Number(t)||0}})).finally((()=>{t.value=!1}))},new Promise(((t,o)=>{var r=e=>{try{l(s.next(e))}catch(a){o(a)}},p=e=>{try{l(s.throw(e))}catch(a){o(a)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,p);l((s=s.apply(e,a)).next())}));var e,a,s}),1e3),U=g("view"),[A,{closeDialog:F}]=y((e=>{const{type:a,data:t}=e;U.value=a,"view"===a&&(console.log(t),Object.keys(t).forEach((e=>{o[e]=t[e]})),b((()=>{E()})))})),H=function(){t.value=!1,F(),Object.keys(o).forEach((e=>{o[e]=""})),u.value=[]};return d((()=>{H()})),(e,a)=>{const p=v("el-table-column"),l=v("el-table"),n=v("el-pagination"),i=f("loading");return h(),k(D(_),{width:"960","show-close":!0,center:"","destroy-on-close":"","close-on-click-modal":!1,onClose:H,onRegister:D(A)},{default:x((()=>[C((h(),j("div",B,[O(l,{class:"w-full h-[480px]",data:u.value},{default:x((()=>[O(p,{type:"index",label:"排名",width:"80",align:"center"},{default:x((e=>[S("span",null,z((r.pageNum-1)*r.pageSize+e.$index+1),1)])),_:1}),O(p,{prop:"orgName",align:"center",label:"单位名称","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),"num"==o.rankType?(h(),k(p,{key:0,prop:"count",align:"center",label:"巡查次数","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}})):"duration"==o.rankType?(h(),k(p,{key:1,prop:"durationFormat",align:"center",label:"巡查时长","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}})):"taskNum"==o.rankType?(h(),k(p,{key:2,prop:"count",align:"center",label:"作业数","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}})):"taskCover"==o.rankType?(h(),j(N,{key:3},[O(p,{prop:"taskCount",align:"center",label:"计划总数","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),O(p,{prop:"patrolTaskCount",align:"center",label:"被巡查作业数","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),O(p,{prop:"patrolCoverPercent",align:"center",label:"覆盖率","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}},{default:x((({row:e})=>[P(z(e.patrolCoverPercent||"0%"),1)])),_:1})],64)):T("",!0)])),_:1},8,["data"])])),[[i,t.value]]),O(n,{"current-page":r.pageNum,"onUpdate:currentPage":a[0]||(a[0]=e=>r.pageNum=e),"page-size":r.pageSize,"onUpdate:pageSize":a[1]||(a[1]=e=>r.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:r.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:s,onCurrentChange:D(E)},null,8,["current-page","page-size","total","onCurrentChange"])])),_:1},8,["onRegister"])}}}))));var A;const F=E(U,[["__scopeId","data-v-ecacc487"]]);export{F as default};
