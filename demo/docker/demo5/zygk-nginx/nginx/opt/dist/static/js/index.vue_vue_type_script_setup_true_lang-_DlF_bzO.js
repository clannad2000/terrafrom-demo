var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,i=(e,a,l)=>new Promise(((t,s)=>{var o=e=>{try{i(l.next(e))}catch(a){s(a)}},r=e=>{try{i(l.throw(e))}catch(a){s(a)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,r);i((l=l.apply(e,a)).next())}));import{d as p,z as n,n as c,a0 as u,A as d,Y as w,at as m,F as g,r as h,j as f,w as b,o as v,c as y,b as k,h as x,u as C,a2 as N,J as _,L as O,g as z,f as I,v as j,e as P,I as S,a5 as T,a$ as R,a1 as U,b0 as D}from"./index-OtYEJMgP.js";import{u as V}from"./MediaReview-6GObmu50.js";import{d as F}from"./download-z--BcN7F.js";import{_ as $}from"./DetailDialog.vue_vue_type_script_setup_true_lang-qfAV3e_l.js";const A={class:"w-full h-full flex flex-col gap-y-4"},B=p((L=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e})({},{name:"AnalysisMainDetail"}),a(L,l({__name:"index",setup(e){const[a,{showDialog:l,setDialogProps:t}]=n(),s=c((()=>V().analysisParams)),o=u({aiTaskId:"",taskName:"",cityOrgId:""}),r=d(!1),p=w([]),B=u({pageNum:1,pageSize:10,total:0}),L=T((()=>i(this,null,(function*(){r.value=!0,p.value=[];const{pageSize:e,pageNum:a}=B,{aiTaskId:l,taskName:t,cityOrgId:s}=o;yield R({pageNum:a,pageSize:e,aiTaskId:l,taskName:t,cityOrgId:s}).then((e=>{if(e&&U!==e){const{rows:a=[],total:l=0}=e;p.value=a,B.total=Number(l)||0}})).finally((()=>{r.value=!1}))}))),1e3),M=T((()=>i(this,null,(function*(){r.value=!0;const{aiTaskId:e,taskName:a,cityOrgId:l}=o;yield D({aiTaskId:e,taskName:a,cityOrgId:l}).then((e=>{if(e&&(null==e?void 0:e.data)){const a=e.headers["content-disposition"];let l="unknown";a&&(l=window.decodeURI(a.split("=")[1])),F(e.data,l)}})).finally((()=>{r.value=!1}))}))),1e3),q=()=>{B.pageNum=1,L()};return m((()=>s.value),(()=>{const{type:e,value:a}=s.value;if("3"===e&&a){const{id:e}=a;Object.assign(o,{aiTaskId:e}),q()}}),{deep:!0,immediate:!0}),g((()=>{})),(e,s)=>{const i=h("el-option"),n=h("el-select"),c=h("el-form-item"),u=h("el-input"),d=h("el-button"),w=h("el-form"),m=h("el-table-column"),g=h("el-table"),T=h("el-auto-resizer"),R=h("el-pagination"),U=f("loading");return b((v(),y("div",A,[k(w,{inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:x((()=>[k(c,{label:"市级公司",class:"m-0"},{default:x((()=>[k(n,{modelValue:o.cityOrgId,"onUpdate:modelValue":s[0]||(s[0]=e=>o.cityOrgId=e),placeholder:"请选择市级公司",clearable:"",onFocus:C(N)().loadCityOrgByUser},{default:x((()=>[(v(!0),y(_,null,O(C(N)().cityOrgByUser,(e=>(v(),z(i,{key:e.id,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onFocus"])])),_:1}),k(c,{label:"任务名称",class:"m-0"},{default:x((()=>[k(u,{modelValue:o.taskName,"onUpdate:modelValue":s[1]||(s[1]=e=>o.taskName=e),clearable:"",maxlength:"20",placeholder:"请输入任务名称",formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,"")},null,8,["modelValue","formatter","parser"])])),_:1}),k(c,{class:"m-0"},{default:x((()=>[k(d,{class:"basic-button",onClick:q},{default:x((()=>[I(" 查询 ")])),_:1}),k(d,{class:"basic-button",onClick:C(M)},{default:x((()=>[I(" 导出 ")])),_:1},8,["onClick"])])),_:1})])),_:1}),k(T,null,{default:x((({height:e,width:a})=>[k(g,{ref:"tableRef",class:"cursor-pointer",height:e,data:p.value,"show-overflow-tooltip":"",style:j({width:a+"px"})},{default:x((()=>[k(m,{type:"index",label:"序号",width:"80",align:"center"},{default:x((e=>[P("span",null,S((B.pageNum-1)*B.pageSize+e.$index+1),1)])),_:1}),k(m,{prop:"cityOrgName",align:"center",label:"市级公司",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"orgName",align:"center",label:"管理部门",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"taskName",align:"center",label:"任务名称",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"majorTypeName",align:"center",label:"所属专业",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"beginTime",align:"center",label:"计划开始时间",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"endTime",align:"center",label:"计划结束时间",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"workContent",align:"center",label:"作业内容",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"workRiskLevelName",align:"center",label:"作业风险等级",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"fzrRealName",align:"center",label:"工作负责人",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{prop:"sjWzNum",align:"center",label:"实际发现问题数",width:"160","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),k(m,{fixed:"right",label:"操作",width:"200",align:"center"},{default:x((({row:e})=>[k(d,{type:"primary",link:"",onClick:a=>(e=>{t({title:"分析详情"}),l(!0,{type:"view",data:e})})(e)},{default:x((()=>[I(" 分析详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:2},1032,["height","data","style"])])),_:1}),k(R,{"current-page":B.pageNum,"onUpdate:currentPage":s[2]||(s[2]=e=>B.pageNum=e),"page-size":B.pageSize,"onUpdate:pageSize":s[3]||(s[3]=e=>B.pageSize=e),background:"",layout:"total, sizes, prev, pager, next, jumper",total:B.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:q,onCurrentChange:C(L)},null,8,["current-page","page-size","total","onCurrentChange"]),k($,{onRegister:C(a)},null,8,["onRegister"])])),[[U,r.value]])}}}))));var L;export{B as _};
