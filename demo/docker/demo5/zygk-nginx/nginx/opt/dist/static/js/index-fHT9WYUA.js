var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,i=(e,l,a)=>new Promise(((t,o)=>{var s=e=>{try{i(a.next(e))}catch(l){o(l)}},n=e=>{try{i(a.throw(e))}catch(l){o(l)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,n);i((a=a.apply(e,l)).next())}));import{d as r,a0 as u,Y as c,Z as p,n as d,A as g,F as f,H as m,r as v,j as h,o as b,c as w,e as y,w as x,v as S,b as _,h as N,f as k,J as C,L as z,t as R,I as O,g as V,az as I,a1 as j,$ as U,X as P,aA as $,_ as A,a4 as F,aB as T,aC as q,a8 as B,N as D,u as E,a9 as M,y as H,aD as J,a6 as K,R as L,U as X}from"./index-OtYEJMgP.js";const Y={class:"w-full h-full grid grid-cols-[25%_75%]"},Z=["data-id"],G=A(r({__name:"outsourceOrg",props:{singleSelect:{type:Boolean,default:!1}},emits:["selected"],setup(e,{expose:l,emit:a}){const t=e,o=a,s=u({orgId:"",userName:"",realName:""}),n=u({pageNum:1,pageSize:10,total:0}),r=c(),{height:A}=p(r),F=c(),{height:T}=p(F),q=d((()=>({height:`${A.value}px`}))),B=d((()=>({height:A.value-T.value+"px"}))),D=c(),{width:E,height:M}=p(D),H=c(),J=c(),{height:K}=p(H),{height:L}=p(J),X=d((()=>({width:`${E.value}px`,height:M.value-K.value-L.value-32+"px"}))),G=g(!1),Q=u({condition:""}),W=c([]),ee=()=>i(this,null,(function*(){G.value=!0;const{condition:e}=Q;I({condition:e,pageSize:999999,pageNum:1}).then((e=>{if(e&&j!==e){const{rows:l=[],total:a=0}=e;W.value=l,n.total=Number(a)||0,l&&U(l)&&ae(l[0])}})).finally((()=>{G.value=!1}))})),le=e=>{if("org-item"===e.target.className){const l=e.target.dataset.id,a=W.value.find((e=>e.id===l));a&&ae(a)}},ae=e=>{const{id:l}=e;Object.assign(s,{orgId:l}),de(),ge()},te=g(!1),oe=c([]),se=()=>{te.value=!0;const{pageSize:e,pageNum:l}=n,{orgId:a,userName:t,realName:o}=s;$({outCompanyId:a,userName:t,realName:o,pageSize:e,pageNum:l}).then((e=>{if(j!==e){const{rows:l=[],total:a=0}=e;oe.value=l,n.total=Number(a)||0,oe.value.map((e=>{P((()=>{re(e)&&ne.value.toggleRowSelection(e,!0)}))}))}})).finally((()=>{te.value=!1}))},ne=c(null),ie=u(new Map),re=e=>ie.has(e.id),ue=e=>{const l=e.id;ie.has(l)?(ie.delete(l),ne.value.toggleRowSelection(e,!1)):(ie.set(l,e),ne.value.toggleRowSelection(e,!0))},ce=(e,l)=>{const a=l.id;ie.has(a)?ie.delete(a):(t.singleSelect&&(ne.value.clearSelection(),ie.clear()),ie.set(a,l),ne.value.toggleRowSelection(l,!0)),o("selected",{personnel:[...ie.values()]})},pe=e=>{t.singleSelect?ne.value.clearSelection():(oe.value.map((l=>{0===e.length?re(l)&&ue(l):re(l)||ue(l)})),o("selected",{personnel:[...ie.values()]}))},de=()=>{ie.clear(),ne.value.clearSelection(),o("selected",{personnel:[]})},ge=function(){n.pageNum=1,se()},fe=()=>i(this,null,(function*(){ge()})),me=()=>i(this,null,(function*(){se()}));return l({setSelection:e=>{ie.clear(),ne.value.clearSelection(),e.map((e=>{ie.set(e.id,e)})),oe.value.map((e=>{P((()=>{re(e)&&ne.value.toggleRowSelection(e,!0)}))}))}}),f((()=>{ee()})),m((()=>{de()})),(e,l)=>{const a=v("el-input"),t=v("el-form-item"),o=v("el-button"),i=v("el-form"),u=v("el-table-column"),c=v("el-table"),p=v("el-pagination"),d=h("loading");return b(),w("div",Y,[y("div",{ref_key:"orgContainerRef",ref:r,class:"content-item h-full flex flex-col org-content"},[x((b(),w("div",{class:"flex flex-col gap-y-4",style:S(q.value)},[_(i,{ref_key:"orgSearchFormRef",ref:F,inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:N((()=>[_(t,{class:"m-0"},{default:N((()=>[_(a,{modelValue:Q.condition,"onUpdate:modelValue":l[0]||(l[0]=e=>Q.condition=e),clearable:"",class:"mb-4",placeholder:"请输入部门",maxlength:"20"},null,8,["modelValue"])])),_:1}),_(t,{label:"",class:"m-0"},{default:N((()=>[_(o,{class:"basic-button",loading:G.value,onClick:ee},{default:N((()=>[k(" 查询 ")])),_:1},8,["loading"])])),_:1})])),_:1},512),y("div",{style:S(B.value),class:"flex flex-col overflow-y-auto",onClick:le},[(b(!0),w(C,null,z(W.value,(e=>(b(),w("div",{key:e.id,class:R(["org-item",{selected:e.id==s.orgId}]),"data-id":e.id},O(e.companyName),11,Z)))),128))],4)],4)),[[d,G.value]])],512),y("div",{ref_key:"tableContainerRef",ref:D,class:"content-item h-full flex flex-col gap-y-4 personnel-content"},[_(i,{ref_key:"searchFormRef",ref:H,inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:N((()=>[_(t,{label:"姓名",class:"m-0"},{default:N((()=>[_(a,{modelValue:s.realName,"onUpdate:modelValue":l[1]||(l[1]=e=>s.realName=e),clearable:"",class:"mb-4",placeholder:"请输入姓名",maxlength:"20"},null,8,["modelValue"])])),_:1}),_(t,{label:"身份证",class:"m-0"},{default:N((()=>[_(a,{modelValue:s.userName,"onUpdate:modelValue":l[2]||(l[2]=e=>s.userName=e),clearable:"",class:"mb-4",placeholder:"请输入身份证",maxlength:"20"},null,8,["modelValue"])])),_:1}),_(t,{label:"",class:"m-0"},{default:N((()=>[_(o,{class:"basic-button",loading:te.value,onClick:ge},{default:N((()=>[k(" 查询 ")])),_:1},8,["loading"])])),_:1})])),_:1},512),y("div",{style:S(X.value)},[x((b(),V(c,{ref_key:"multipleTableRef",ref:ne,data:oe.value,height:"100%","show-overflow-tooltip":"",onSelect:ce,onSelectAll:pe},{default:N((()=>[_(u,{type:"selection",width:"80"}),_(u,{prop:"outCompanyName",label:"公司名称","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"},align:"center"}),_(u,{prop:"realName",label:"姓名","min-width":"180",align:"center","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),_(u,{prop:"userName",label:"身份证","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"},align:"center"})])),_:1},8,["data"])),[[d,te.value]])],4),_(p,{ref_key:"paginationRef",ref:J,"current-page":n.pageNum,"onUpdate:currentPage":l[3]||(l[3]=e=>n.pageNum=e),"page-size":n.pageSize,"onUpdate:pageSize":l[4]||(l[4]=e=>n.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:n.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:fe,onCurrentChange:me},null,8,["current-page","page-size","total"])],512)])}}}),[["__scopeId","data-v-95da9d5d"]]),Q={class:"w-full h-full grid grid-cols-[25%_75%]"},W=A(r({__name:"principalOrg",props:{singleSelect:{type:Boolean,default:!1}},emits:["selected"],setup(e,{expose:l,emit:a}){const t=e,o=a,s=u({orgId:"",orgName:"",userName:"",realName:""}),n=u({pageNum:1,pageSize:10,total:0}),r=c(),{height:C}=p(r),z=d((()=>({height:`${C.value}px`}))),R=c(),{width:I,height:$}=p(R),A=c(),B=c(),{height:D}=p(A),{height:E}=p(B),M=d((()=>({width:`${I.value}px`,height:$.value-D.value-E.value-32+"px"}))),H=c(null),J=g(!1),K=c([]),L=d((()=>({nodeKey:"id",props:{label:e=>e.shortName||e.name,children:"children"}}))),X=e=>{const{id:l,name:a}=e;Object.assign(s,{orgId:l,orgName:a}),se(),ne()},Y=g(!1),Z=c([]),G=()=>{Y.value=!0;const{pageSize:e,pageNum:l}=n,{orgId:a,userName:t,realName:o}=s;q({orgId:a,userName:t,realName:o,pageSize:e,pageNum:l}).then((e=>{if(j!==e){const{rows:l=[],total:a=0}=e;Z.value=l,n.total=Number(a)||0,Z.value.map((e=>{P((()=>{le(e)&&W.value.toggleRowSelection(e,!0)}))}))}})).finally((()=>{Y.value=!1}))},W=c(null),ee=u(new Map),le=e=>ee.has(e.id),ae=e=>{const l=e.id;ee.has(l)?(ee.delete(l),W.value.toggleRowSelection(e,!1)):(ee.set(l,e),W.value.toggleRowSelection(e,!0))},te=(e,l)=>{const a=l.id;ee.has(a)?ee.delete(a):(t.singleSelect&&(W.value.clearSelection(),ee.clear()),ee.set(a,l),W.value.toggleRowSelection(l,!0)),o("selected",{personnel:[...ee.values()]})},oe=e=>{t.singleSelect?W.value.clearSelection():(Z.value.map((l=>{0===e.length?le(l)&&ae(l):le(l)||ae(l)})),o("selected",{personnel:[...ee.values()]}))},se=()=>{ee.clear(),W.value.clearSelection(),o("selected",{personnel:[]})},ne=function(){n.pageNum=1,G()},ie=()=>i(this,null,(function*(){ne()})),re=()=>i(this,null,(function*(){G()}));return l({setSelection:e=>{ee.clear(),W.value.clearSelection(),e.map((e=>{ee.set(e.id,e)})),Z.value.map((e=>{P((()=>{le(e)&&W.value.toggleRowSelection(e,!0)}))}))}}),f((()=>{J.value=!0,T({enable:"1"}).then((e=>{if(j!==e&&(K.value=e,e&&U(e))){const{id:l,name:a}=e[0];X({id:l,name:a})}})).finally((()=>{J.value=!1}))})),m((()=>{se()})),(e,l)=>{const a=v("el-tree"),t=v("el-input"),o=v("el-form-item"),i=v("el-button"),u=v("el-form"),c=v("el-table-column"),p=v("el-table"),d=v("el-pagination"),g=h("loading");return b(),w("div",Q,[y("div",{ref_key:"treeContainerRef",ref:r,class:"content-item h-full flex flex-col"},[x((b(),w("div",{style:S([{"overflow-y":"auto"},z.value])},[_(a,F({ref_key:"orgTreeRef",ref:H},L.value,{data:K.value,"check-strictly":!0,"highlight-current":!0,"expand-on-click-node":!1,onCurrentChange:X}),null,16,["data"])],4)),[[g,J.value]])],512),y("div",{ref_key:"tableContainerRef",ref:R,class:"content-item h-full flex flex-col gap-y-4"},[_(u,{ref_key:"searchFormRef",ref:A,inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:N((()=>[_(o,{label:"姓名",class:"m-0"},{default:N((()=>[_(t,{modelValue:s.realName,"onUpdate:modelValue":l[0]||(l[0]=e=>s.realName=e),clearable:"",class:"mb-4",placeholder:"请输入姓名",maxlength:"20"},null,8,["modelValue"])])),_:1}),_(o,{label:"账号",class:"m-0"},{default:N((()=>[_(t,{modelValue:s.userName,"onUpdate:modelValue":l[1]||(l[1]=e=>s.userName=e),clearable:"",class:"mb-4",placeholder:"请输入账号",maxlength:"20"},null,8,["modelValue"])])),_:1}),_(o,{label:"",class:"m-0"},{default:N((()=>[_(i,{class:"basic-button",loading:Y.value,onClick:ne},{default:N((()=>[k(" 查询 ")])),_:1},8,["loading"])])),_:1})])),_:1},512),y("div",{style:S(M.value)},[x((b(),V(p,{ref_key:"multipleTableRef",ref:W,data:Z.value,height:"100%","show-overflow-tooltip":"",onSelect:te,onSelectAll:oe},{default:N((()=>[_(c,{type:"selection",width:"80"}),_(c,{prop:"organization",label:"管理部门","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"},align:"center"},{default:N((({row:e})=>[k(O(e.organization.shortName||e.organization.name),1)])),_:1}),_(c,{prop:"realName",label:"姓名","min-width":"180",align:"center","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),_(c,{prop:"userName",label:"账号","min-width":"180","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"},align:"center"})])),_:1},8,["data"])),[[g,Y.value]])],4),_(d,{ref_key:"paginationRef",ref:B,"current-page":n.pageNum,"onUpdate:currentPage":l[2]||(l[2]=e=>n.pageNum=e),"page-size":n.pageSize,"onUpdate:pageSize":l[3]||(l[3]=e=>n.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:n.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:ie,onCurrentChange:re},null,8,["current-page","page-size","total"])],512)])}}}),[["__scopeId","data-v-ccf99687"]]),ee={class:"w-full h-[540px] grid grid-cols-[36px_1fr_15%] content-body"},le={class:"content-item h-full flex flex-col py-4 gap-y-4"},ae=["onClick"],te={class:"content-item h-full"},oe={class:"content-item h-full p-[10px] flex flex-col overflow-y-auto"},se=(e=>(L("data-v-af743421"),e=e(),X(),e))((()=>y("span",{class:"text-white"},"已选择人员",-1))),ne={class:"flex flex-col flex-1"},ie={class:"flex flex-row flex-wrap items-center gap-2"},re={class:"dialog-footer"},ue=r((ce=((e,l)=>{for(var a in l||(l={}))o.call(l,a)&&n(e,a,l[a]);if(t)for(var a of t(l))s.call(l,a)&&n(e,a,l[a]);return e})({},{name:"UserSelect"}),l(ce,a({__name:"index",emits:["register","confirm"],setup(e,{emit:l}){const a=g(!1),t=c(["principalOrg","outsourceOrg"]),o=g("principalOrg"),s=d((()=>{const e=[],l=t.value;return U(l)&&l.forEach((l=>{const a="principalOrg"===l?"管理部门":"outsourceOrg"===l?"外委单位":"";e.push({label:a,value:l})})),e})),n=l,[i,{closeDialog:r}]=B((e=>{const{type:l,tabs:o=["principalOrg","outsourceOrg"],isSingle:s=!1}=e;t.value=o,a.value=s})),u=c(),p=c(),f=c([]),h=e=>{const{personnel:l=[]}=e;U(l)&&(f.value=l)},x=()=>{f.value.length?(I(),n("confirm",{personnel:f.value,orgType:o.value})):K.warning("请选择人员！")},S=g(!1),I=function(){S.value=!1,r()};return m((()=>{I()})),(e,l)=>{const t=v("el-tag"),n=v("el-button");return b(),V(E(M),{width:"1400px","show-fullscreen":!1,"show-close-icon":!1,"destroy-on-close":"",center:"",onClose:I,onRegister:E(i)},{footer:N((()=>[y("span",re,[_(n,{class:"basic-button",disabled:S.value,onClick:I},{default:N((()=>[k(" 取消 ")])),_:1},8,["disabled"]),_(n,{class:"basic-button",loading:S.value,onClick:x},{default:N((()=>[k(" 保存 ")])),_:1},8,["loading"])])])),default:N((()=>[y("div",ee,[y("div",le,[(b(!0),w(C,null,z(s.value,(e=>(b(),w("div",{key:e.value,class:"flex flex-row items-center justify-center cursor-pointer",onClick:l=>{return a=e.value,void(o.value=a);var a}},[y("span",{class:R(["tab-item",{active:o.value==e.value}])},O(e.label),3)],8,ae)))),128))]),y("div",te,["principalOrg"==o.value?(b(),V(W,{key:0,ref_key:"principalOrgRef",ref:u,"single-select":a.value,onSelected:h},null,8,["single-select"])):"outsourceOrg"==o.value?(b(),V(G,{key:1,ref_key:"outsourceOrgRef",ref:p,"single-select":a.value,onSelected:h},null,8,["single-select"])):D("",!0)]),y("div",oe,[se,y("div",ne,[y("div",ie,[(b(!0),w(C,null,z(f.value,(e=>(b(),V(t,{key:e.id,closable:"","disable-transitions":!1,onClose:l=>(e=>{const l=H(f.value,(l=>l.id!==e.id));f.value=J(l),u.value?u.value.setSelection(l):p.value&&p.value.setSelection(l)})(e)},{default:N((()=>[k(O(e.realName),1)])),_:2},1032,["onClose"])))),128))])])])])])),_:1},8,["onRegister"])}}}))));var ce;const pe=A(ue,[["__scopeId","data-v-af743421"]]);export{pe as U};
