var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{d as r,z as n,A as c,a0 as u,Y as p,n as d,aG as f,a8 as v,X as g,H as m,r as x,j as w,o as b,g as y,h,w as j,c as z,J as O,L as S,b as I,u as N,M as P,e as D,I as R,f as _,a9 as k,a5 as C,bh as E,a1 as M,_ as U}from"./index-OtYEJMgP.js";import{I as A}from"./index-mErxNL28.js";import{e as H}from"./constants-uiyZ18jc.js";import"./MediaReview-6GObmu50.js";import"./AdminLog-DD6g2Y3j.js";const J={class:"h-[480px] flex flex-col gap-y-4 overflow-auto my-2 record-list"},L={class:"fixed top-12 right-36"},F={class:"flex flex-col"},G={class:"flex-1 flex flex-col"},V={class:"text-sm truncate title"},X={class:"w-full flex flex-row items-center justify-between"},Y={class:"info flex-1 flex flex-row truncate"},q={class:"info"},B=r((K=((e,a)=>{for(var t in a||(a={}))s.call(a,t)&&i(e,t,a[t]);if(l)for(var t of l(a))o.call(a,t)&&i(e,t,a[t]);return e})({},{name:"JobPlanMainVideoRecordDialog"}),a(K,t({__name:"RecordDialog",emits:["register","confirm"],setup(e,{emit:a}){const[t,{showDialog:l,setDialogProps:s}]=n(),o=c(!1),i=u({fileId:""}),r=u({pageNum:1,pageSize:9,total:0}),U=p([]),B=C((()=>{return e=this,a=null,t=function*(){o.value=!0,U.value=[];const{pageNum:e,pageSize:a}=r,{fileId:t}=i;yield E({videoFileId:t,pageNum:e,pageSize:a}).then((e=>{if(e&&M!==e){const{rows:a,total:t}=e;U.value=a||[],r.total=Number(t)||0}})).finally((()=>{o.value=!1}))},new Promise(((l,s)=>{var o=e=>{try{r(t.next(e))}catch(a){s(a)}},i=e=>{try{r(t.throw(e))}catch(a){s(a)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,i);r((t=t.apply(e,a)).next())}));var e,a,t}),1e3),K=d((()=>U.value.map((e=>f(e.fileId))))),Q=c(0),T=e=>{Q.value=e},[W,{closeDialog:Z}]=v((e=>{const{type:a,data:t}=e;"view"===a&&(Object.keys(t).forEach((e=>{i[e]=t[e]})),g((()=>{B()})))})),$=function(){o.value=!1,Z(),Object.keys(i).forEach((e=>{i[e]=""}))};return m((()=>{$()})),(e,a)=>{const l=x("el-button"),s=x("el-tooltip"),i=x("el-image"),n=x("el-pagination"),c=w("loading");return b(),y(N(k),{width:"640","show-close":!0,center:"","destroy-on-close":"","close-on-click-modal":!1,onClose:$,onRegister:N(W)},{default:h((()=>[j((b(),z("div",J,[(b(!0),z(O,null,S(U.value,((e,t)=>(b(),z("div",{key:e.fileId,class:"flex flex-row items-center py-1 px-2 gap-x-4 bg-[#09455b] rounded item"},[I(i,{class:"w-1/4 aspect-video",src:N(f)(e.fileId),"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":K.value,"show-progress":"","initial-index":t,fit:"cover",onDragstart:a[0]||(a[0]=P((()=>{}),["prevent"])),onSwitch:T,onShow:e=>(e=>{Q.value=e})(t)},{viewer:h((()=>[D("div",L,[I(s,{class:"box-item",effect:"dark",placement:"top-start"},{content:h((()=>[D("div",F,[D("div",null,"设备编号："+R(U.value[Q.value].execDeviceCode),1),D("div",null," 文件大小："+R(N(H)(U.value[Q.value].fileSize)),1),D("div",null,"文件名称："+R(U.value[Q.value].fileName),1)])])),default:h((()=>[I(l,{class:"basic-button"},{default:h((()=>[_(" 图片信息 ")])),_:1})])),_:1})])])),_:2},1032,["src","preview-src-list","initial-index","onShow"]),D("div",G,[D("div",V,R(e.taskName),1),D("div",X,[D("div",Y,"班组："+R(e.orgName),1),D("div",q,"人员："+R(e.execUserRealName),1)])])])))),128))])),[[c,o.value]]),I(n,{ref:"paginationRef","current-page":r.pageNum,"onUpdate:currentPage":a[1]||(a[1]=e=>r.pageNum=e),"page-size":r.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>r.pageSize=e),small:"",background:"",layout:"total, prev, pager, next",total:r.total,onCurrentChange:N(B)},null,8,["current-page","page-size","total","onCurrentChange"]),I(A,{onRegister:N(t)},null,8,["onRegister"])])),_:1},8,["onRegister"])}}}))));var K;const Q=U(B,[["__scopeId","data-v-025141c4"]]);export{Q as default};
