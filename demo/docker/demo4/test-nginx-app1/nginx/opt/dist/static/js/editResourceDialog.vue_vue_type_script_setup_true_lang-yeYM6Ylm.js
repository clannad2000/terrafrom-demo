var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,t=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,s=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&t(e,l,a[l]);if(r)for(var l of r(a))n.call(a,l)&&t(e,l,a[l]);return e},i=(e,r)=>a(e,l(r)),d=(e,a,l)=>new Promise(((r,o)=>{var n=e=>{try{s(l.next(e))}catch(a){o(a)}},t=e=>{try{s(l.throw(e))}catch(a){o(a)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,t);s((l=l.apply(e,a)).next())}));import{a3 as u,A as c,aQ as m,u as p,bI as f,at as g,av as h,d as b,aa as v,S as _,bJ as y,bK as w,_ as V,r as I,j as k,o as C,g as O,h as x,e as j,b as S,f as $,w as E,c as U,J as P,L as R,t as D,M as F,bf as L,a8 as N,a0 as T,ab as q,bx as z,N as A,a9 as M,a1 as Z,a6 as J}from"./index-OtYEJMgP.js";import{u as K}from"./useThrottle-fY6V1GyW.js";const Q=(e={type:"menu"})=>u.get({url:"/sys/resource/tree",params:e}),W=e=>u.post({url:"/sys/resource/delete",params:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}});for(let se=0;se<=15;se++)se.toString(16);let B=0;function G(e=""){const a=Date.now(),l=Math.floor(1e9*Math.random());return B++,e+"_"+l+B+String(a)}const H=b({components:{Search:v},props:{iconSize:{require:!1,type:String,default:"32px"}},emits:["register","confirmIcon"],setup(e,a){const l=c(!1),r=c(!0),o=c(!1);let n=[];const t=c([]),s=c(""),i=c(""),[u,p]=K((e=>{r.value=!0;let a=!0;t.value.forEach((l=>{l.name.includes(e)?(a=!1,l.show=!0):l.show=!1})),o.value=a,r.value=!1}),600,{debounce:!0}),f=function(){l.value=!1,h()},g=function(){a.emit("confirmIcon",i.value),f()},h=function(){n=[],s.value="",i.value="",o.value=!1,t.value=[]};return m((()=>{h(),p()})),a.emit("register",{showIconPicker:function(e,a){return d(this,null,(function*(){var o;if(l.value=e,a)try{r.value=!0,i.value=null!=(o=null==a?void 0:a.iconName)?o:"";const e=yield function(){return d(this,null,(function*(){const e=yield Object.assign({"../../assets/icons/more.svg":()=>y((()=>import("./more-v4kQLNVr.js")),__vite__mapDeps([0,1,2]),import.meta.url),"../../assets/icons/user-add.svg":()=>y((()=>import("./user-add-XB_0QZm6.js")),__vite__mapDeps([3,1,2]),import.meta.url)});return Object.keys(e).map(((e,a)=>({id:G()+"x"+a,name:_+e.replace(/^.*\/assets\/icons\/(.+)\.svg$/i,"$1"),show:!0})))}))}(),l=yield new Promise((e=>{y((()=>import("./iconsNameList-jxX5A9xD.js")),__vite__mapDeps([]),import.meta.url).then((a=>{const l=null==a?void 0:a.default;n=l.map(((e,a)=>({id:G()+a,name:e,show:!0}))),e(w.cloneDeep(n))})).catch((()=>{e([])}))}));t.value=[...e,...l],r.value=!1}catch(s){t.value=[],r.value=!1}}))},handleConfirmIcon:g,handleCancel:f}),{iconDialogVisible:l,loadingIcon:r,searchText:s,iconList:t,isEmpty:o,isSvgIcon:function(e){return e.startsWith(_)},selectedIcon:i,throttleSearch:u,clearSearch:function(){t.value.forEach((e=>{e.show=!0}))},changeIcon:function(e){i.value=e===i.value?"":e},handleConfirmIcon:g,handleCancel:f}}}),X={class:"mb-4"},Y={class:"icon_contain"},ee={key:1,class:"icon_list"},ae=["onClick"],le={class:"icon_border"},re={class:"dialog-footer"};const oe=V(H,[["render",function(e,a,l,r,o,n){const t=I("Search"),s=I("el-icon"),i=I("el-input"),d=I("el-empty"),u=I("SvgIcon"),c=I("IconifyIconOffline"),m=I("el-tooltip"),p=I("el-button"),f=I("el-dialog"),g=k("loading");return C(),O(f,{modelValue:e.iconDialogVisible,"onUpdate:modelValue":a[1]||(a[1]=a=>e.iconDialogVisible=a),title:"图标资源",top:"56px",width:"760px",draggable:"",class:"icon_picker_dialog","close-on-click-modal":!1,onClose:e.handleCancel},{footer:x((()=>[j("span",re,[S(p,{type:"success",onClick:e.handleConfirmIcon},{default:x((()=>[$(" 保存 ")])),_:1},8,["onClick"]),S(p,{type:"success",plain:"",onClick:e.handleCancel},{default:x((()=>[$("返回")])),_:1},8,["onClick"])])])),default:x((()=>[E((C(),U("div",null,[j("div",X,[S(i,{modelValue:e.searchText,"onUpdate:modelValue":a[0]||(a[0]=a=>e.searchText=a),clearable:"",maxlength:"20",class:"w-80","show-word-limit":"",placeholder:"请输入图标名称搜索图标",formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,""),onInput:e.throttleSearch,onClear:e.clearSearch},{prefix:x((()=>[S(s,{class:"el-input__icon"},{default:x((()=>[S(t)])),_:1})])),_:1},8,["modelValue","formatter","parser","onInput","onClear"])]),j("div",Y,[e.isEmpty?(C(),O(d,{key:0,description:"暂无搜索结果"})):(C(),U("ul",ee,[(C(!0),U(P,null,R(e.iconList,(a=>E((C(),U("li",{key:a.id,class:D({selected_icon:a.name===e.selectedIcon}),onClick:F((l=>e.changeIcon(a.name)),["stop"])},[j("div",le,[S(m,{effect:"dark",content:a.name},{default:x((()=>[e.isSvgIcon(a.name)?(C(),O(u,{key:0,name:a.name,width:e.iconSize,height:e.iconSize},null,8,["name","width","height"])):(C(),O(c,{key:1,icon:a.name,width:e.iconSize,height:e.iconSize},null,8,["icon","width","height"]))])),_:2},1032,["content"])])],10,ae)),[[L,a.show]]))),128))]))])])),[[g,e.loadingIcon]])])),_:1},8,["modelValue","onClose"])}]]),ne={class:"dialog-footer"},te=b(i(s({},{name:"EditResourceDialog"}),{__name:"editResourceDialog",emits:["register","confirm"],setup(e,{emit:a}){let l="";const r=a,[o,{closeDialog:n}]=N((e=>{l=e.type||"";const{data:a}=e;if("edit"===l){const{id:e,parentId:l,parentName:r,name:o,identifier:n,type:t,url:s,permission:i,method:d,icon:u,enabledFlag:c,showOrder:m}=a||{};Object.assign(V,{id:e,parentId:l,parentName:r,name:o,identifier:n,type:t,url:s,permission:i,method:d,icon:u,enabledFlag:c,showOrder:m}),"3"==t&&(V.identifier=n.slice(4))}else if("add"===l&&a){const{id:e,name:l}=a||{};Object.assign(V,{parentId:e,parentName:l})}})),[t,{showIconPicker:b}]=function(e){const a=c(null),l=c(!1);let r;function o(){return p(a)||(h.error("表实例尚未获取，请确保在执行表操作时显示该表!"),null)}return[function(o){m((()=>{a.value=null,l.value=null})),p(l)&&f()&&o===p(a)||(a.value=o,l.value=!0,null==r||r(),r=g((()=>e),(()=>{}),{immediate:!0,deep:!0}))},{showIconPicker:(e,a)=>{var l;return null==(l=o())?void 0:l.showIconPicker(e,a)},handleConfirmIcon:()=>{var e;return null==(e=o())?void 0:e.handleConfirmIcon()},handleCancel:()=>{var e;return null==(e=o())?void 0:e.handleCancel()}}]}(),_=c(null),y={name:[{required:!0,message:"请填写资源名称！",trigger:"blur"},{validator(e,a,l){/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(a)?l():l(new Error("资源名称仅包含汉字,数字,大小写字母和特殊字符(-_)！"))},trigger:"blur"},{max:20,message:"资源名称长度不能超过20位！",trigger:"blur"}],identifier:[{required:!0,message:"请填写资源标识！",trigger:"blur"},{validator(e,a,l){/^[a-zA-Z0-9_-]+$/.test(a)?l():l(new Error("资源标识仅包含数字,大小写字母和特殊字符(-_)！"))},trigger:"blur"},{max:40,message:"资源标识长度不能超过40位！",trigger:"blur"}],url:[{required:!0,message:"请填写资源URL！",trigger:"blur"},{max:128,message:"资源URL长度不能超过128位！",trigger:"blur"}],permission:[{required:!0,message:"请填写权限字符串！",trigger:"blur",validator(e,a,l){/^[a-zA-Z0-9_-]+$/.test(a)?l():l(new Error("权限字符串仅包含数字,大小写字母和特殊字符(-_)！"))}},{max:64,message:"权限字符串长度不能超过64位！",trigger:"blur"}],method:[{required:!0,message:"请选择请求方法！",trigger:"change"}],type:[{required:!0,message:"请选择资源类型！",trigger:"change"}],enabledFlag:[{required:!0,message:"请选择是否启用！",trigger:"change"}]},w=c(!1),V=T({id:"",parentId:"",parentName:"",name:"",identifier:"",type:"",url:"",permission:"",method:"",icon:"",enabledFlag:"",showOrder:""}),k=function(){b(!0,{iconName:V.icon})},E=function(e){V.icon=e},R=()=>{Object.assign(V,{url:"",permission:"",method:"",showOrder:""})},D=function(){var e;w.value=!1,n(),Object.keys(V).forEach((e=>{V[e]=""})),null==(e=_.value)||e.resetFields()},F=function(){var e;null==(e=_.value)||e.validate((e=>d(this,null,(function*(){if(e){w.value=!0;const{id:e,parentId:a,name:o,identifier:n,type:t,enabledFlag:d,showOrder:c,url:m,permission:p,method:f,icon:g}=V,h={parentId:a,name:o,identifier:n,type:t,enabledFlag:d,showOrder:c};"1"===t?Object.assign(h,{url:m,permission:p,method:f}):"0"==t||"2"==t?Object.assign(h,{icon:g}):h.identifier="btn-"+(n||""),"add"===l?(e=>u.post({url:"/sys/resource/add",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:e}))(h).then((e=>{Z!==e&&(J.success("添加资源成功！"),D(),r("confirm"))})).finally((()=>{w.value=!1})):"edit"===l?(e=>u.post({url:"/sys/resource/edit",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:e}))(i(s({},h),{id:e})).then((e=>{Z!==e&&(J.success("编辑资源成功！"),D(),r("confirm"))})).finally((()=>{w.value=!1})):w.value=!1}}))))};return(e,a)=>{const l=I("el-input"),r=I("el-form-item"),n=I("el-option"),s=I("el-select"),i=I("el-button"),d=I("el-radio"),u=I("el-radio-group");return C(),U("div",null,[S(p(M),{width:"720","show-fullscreen":!1,"show-close":!1,"close-on-click-modal":!1,"destroy-on-close":"",center:"","before-close":D,onRegister:p(o)},{footer:x((()=>[j("span",ne,[S(i,{disabled:w.value,class:"basic-button",onClick:D},{default:x((()=>[$(" 取消 ")])),_:1},8,["disabled"]),S(i,{class:"basic-button",loading:w.value,onClick:F},{default:x((()=>[$(" 保存 ")])),_:1},8,["loading"])])])),default:x((()=>[S(p(q),{ref_key:"refEditForm",ref:_,model:V,rules:y,"label-suffix":"：","label-width":"112px"},{default:x((()=>[S(r,{label:"上级资源",prop:"parentName"},{default:x((()=>[S(l,{modelValue:V.parentName,"onUpdate:modelValue":a[0]||(a[0]=e=>V.parentName=e),readonly:""},null,8,["modelValue"])])),_:1}),S(r,{label:"资源名称",prop:"name"},{default:x((()=>[S(l,{modelValue:V.name,"onUpdate:modelValue":a[1]||(a[1]=e=>V.name=e),clearable:"",maxlength:"20","show-word-limit":"",placeholder:"请填写资源名称",disabled:w.value,formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1}),S(r,{label:"资源标识",prop:"identifier"},{default:x((()=>[S(l,{modelValue:V.identifier,"onUpdate:modelValue":a[2]||(a[2]=e=>V.identifier=e),clearable:"",maxlength:"40","show-word-limit":"",placeholder:"请填写资源标识",disabled:w.value,formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,"")},z({_:2},["3"==V.type?{name:"prepend",fn:x((()=>[$("btn-")])),key:"0"}:void 0]),1032,["modelValue","disabled","formatter","parser"])])),_:1}),S(r,{label:"资源类型",prop:"type"},{default:x((()=>[S(s,{modelValue:V.type,"onUpdate:modelValue":a[3]||(a[3]=e=>V.type=e),disabled:w.value,placeholder:"请选择资源类型",onChange:R},{default:x((()=>[S(n,{label:"菜单",value:"0"}),S(n,{label:"功能",value:"1"}),S(n,{label:"模块",value:"2"}),S(n,{label:"按钮",value:"3"})])),_:1},8,["modelValue","disabled"])])),_:1}),"1"===V.type?(C(),U(P,{key:0},[S(r,{label:"资源URL",prop:"url"},{default:x((()=>[S(l,{modelValue:V.url,"onUpdate:modelValue":a[4]||(a[4]=e=>V.url=e),clearable:"",maxlength:"128","show-word-limit":"",placeholder:"请填写资源URL",disabled:w.value,formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1}),S(r,{label:"权限字符串",prop:"permission"},{default:x((()=>[S(l,{modelValue:V.permission,"onUpdate:modelValue":a[5]||(a[5]=e=>V.permission=e),clearable:"",maxlength:"64","show-word-limit":"",placeholder:"请填写权限字符串",disabled:w.value,formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1}),S(r,{label:"请求方法",prop:"method"},{default:x((()=>[S(s,{modelValue:V.method,"onUpdate:modelValue":a[6]||(a[6]=e=>V.method=e),disabled:w.value},{default:x((()=>[S(n,{label:"get",value:"get"}),S(n,{label:"post",value:"post"}),S(n,{label:"put",value:"put"}),S(n,{label:"delete",value:"delete"})])),_:1},8,["modelValue","disabled"])])),_:1})],64)):"3"!==V.type?(C(),O(r,{key:1,label:"图标",prop:"icon"},{default:x((()=>[S(l,{modelValue:V.icon,"onUpdate:modelValue":a[7]||(a[7]=e=>V.icon=e),readonly:"",placeholder:"请选择图标",disabled:w.value},{append:x((()=>[S(i,{icon:p(v),onClick:k},null,8,["icon"])])),_:1},8,["modelValue","disabled"])])),_:1})):A("",!0),"1"!==V.type?(C(),O(r,{key:2,label:"排序值",prop:"sort"},{default:x((()=>[S(l,{modelValue:V.showOrder,"onUpdate:modelValue":a[8]||(a[8]=e=>V.showOrder=e),clearable:"",type:"number",maxlength:"32","show-word-limit":"",placeholder:"请填写排序值",disabled:w.value,parser:e=>e.replace(/^\s*|\s*$|\n/g,""),formatter:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","disabled","parser","formatter"])])),_:1})):A("",!0),S(r,{label:"是否启用",prop:"enabledFlag"},{default:x((()=>[S(u,{modelValue:V.enabledFlag,"onUpdate:modelValue":a[9]||(a[9]=e=>V.enabledFlag=e),disabled:w.value,class:"ml-4"},{default:x((()=>[S(d,{label:"1"},{default:x((()=>[$("启用")])),_:1}),S(d,{label:"0"},{default:x((()=>[$("停用")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1},8,["model"])])),_:1},8,["onRegister"]),S(oe,{onRegister:p(t),onConfirmIcon:E},null,8,["onRegister"])])}}}));export{te as _,W as d,Q as g};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./more-v4kQLNVr.js","./index-OtYEJMgP.js","../css/index-paQ-l_6q.css","./user-add-XB_0QZm6.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
