var e=Object.defineProperty,a=Object.defineProperties,o=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(a,o,l)=>o in a?e(a,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[o]=l,n=(e,a)=>{for(var o in a||(a={}))t.call(a,o)&&r(e,o,a[o]);if(l)for(var o of l(a))s.call(a,o)&&r(e,o,a[o]);return e},i=(e,l)=>a(e,o(l)),p=(e,a,o)=>new Promise(((l,t)=>{var s=e=>{try{n(o.next(e))}catch(a){t(a)}},r=e=>{try{n(o.throw(e))}catch(a){t(a)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(s,r);n((o=o.apply(e,a)).next())}));import{z as c,A as u}from"./StatisticalCenter-fzPo9Omj.js";import{d as g,z as d,A as m,a0 as f,Y as w,a8 as b,X as h,H as v,r as y,j as x,o as C,g as k,h as N,w as j,c as z,b as D,f as O,e as S,I as _,u as R,a9 as P,a5 as I,a1 as U,_ as E}from"./index-OtYEJMgP.js";import{d as F}from"./download-z--BcN7F.js";import V from"./PersonPatrolLogDialog-csbkDa4f.js";const A={class:"flex-1 flex flex-col gap-y-2 my-2"},L=E(g(i(n({},{name:"RankDialog"}),{__name:"RankDialog",emits:["register","confirm"],setup(e,{emit:a}){const[o,{showDialog:l,setDialogProps:t}]=d(),s=m(!1),r=f({ipSource:"",beginDate:"",endDate:"",source:"",orgId:"",userCondition:""}),g=f({pageNum:1,pageSize:10,total:0}),E=()=>{g.pageNum=1,H()},L=()=>p(this,null,(function*(){s.value=!0,yield c(r).then((e=>{if(e&&(null==e?void 0:e.data)){const a=e.headers["content-disposition"];let o="unknown";a&&(o=window.decodeURI(a.split("=")[1])),F(e.data,o)}})).finally((()=>{s.value=!1}))})),q=w([]),H=I((()=>p(this,null,(function*(){s.value=!0,q.value=[];const{pageNum:e,pageSize:a}=g;yield u(i(n({},r),{pageNum:e,pageSize:a})).then((e=>{if(e&&U!==e){const{rows:a,total:o}=e;q.value=a||[],g.total=Number(o)||0}})).finally((()=>{s.value=!1}))}))),1e3),T=e=>{const{ipSource:a,beginDate:o,endDate:s,source:n,orgId:i}=r,p={ipSource:a,beginDate:o,endDate:s,source:n,orgId:i,userName:e.userName,userRealName:e.userRealName};t({title:"人员巡查明细"}),l(!0,{type:"view",data:p})},[X,{closeDialog:Y}]=b((e=>{const{type:a,data:o}=e;"view"===a&&(Object.keys(o).forEach((e=>{r[e]=o[e]})),h((()=>{E()})))})),$=function(){s.value=!1,Y(),Object.keys(r).forEach((e=>{r[e]=""}))};return v((()=>{$()})),(e,a)=>{const l=y("el-input"),t=y("el-form-item"),n=y("el-button"),i=y("el-form"),p=y("el-table-column"),c=y("el-table"),u=y("el-pagination"),d=x("loading");return C(),k(R(P),{width:"960","show-close":!0,center:"","destroy-on-close":"","close-on-click-modal":!1,onClose:$,onRegister:R(X)},{default:N((()=>[j((C(),z("div",A,[D(i,{ref:"searchFormRef",inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:N((()=>[D(t,{label:"用户",class:"m-0"},{default:N((()=>[D(l,{modelValue:r.userCondition,"onUpdate:modelValue":a[0]||(a[0]=e=>r.userCondition=e),clearable:"",placeholder:"请输入用户姓名/账号",maxlength:"20"},null,8,["modelValue"])])),_:1}),D(t,{label:"",class:"m-0"},{default:N((()=>[D(n,{class:"basic-button",loading:s.value,onClick:E},{default:N((()=>[O(" 查询 ")])),_:1},8,["loading"]),D(n,{class:"basic-button",loading:s.value,onClick:L},{default:N((()=>[O(" 导出 ")])),_:1},8,["loading"])])),_:1})])),_:1},512),D(c,{class:"w-full h-[480px] cursor-pointer",data:q.value,onRowClick:T},{default:N((()=>[D(p,{type:"index",label:"排名",width:"80",align:"center"},{default:N((e=>[S("span",null,_((g.pageNum-1)*g.pageSize+e.$index+1),1)])),_:1}),D(p,{prop:"userRealName",align:"center",label:"用户","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),D(p,{prop:"userName",align:"center",label:"账号","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),D(p,{prop:"userCityOrgName",align:"center",label:"所属单位","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),D(p,{prop:"userOrgName",align:"center",label:"所属组织","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),D(p,{prop:"patrolTimeLongFormat",align:"center",label:"巡查时长","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),D(p,{prop:"patrolCount",align:"center",label:"巡查次数","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}})])),_:1},8,["data"])])),[[d,s.value]]),D(u,{"current-page":g.pageNum,"onUpdate:currentPage":a[1]||(a[1]=e=>g.pageNum=e),"page-size":g.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>g.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:g.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:E,onCurrentChange:R(H)},null,8,["current-page","page-size","total","onCurrentChange"]),D(V,{onRegister:R(o)},null,8,["onRegister"])])),_:1},8,["onRegister"])}}})),[["__scopeId","data-v-d6e06728"]]);export{L as default};
