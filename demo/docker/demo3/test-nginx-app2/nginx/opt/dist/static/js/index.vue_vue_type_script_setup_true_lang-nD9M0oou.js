var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{d as r,z as o,A as d,a0 as c,Y as u,F as p,r as f,j as h,w as m,o as y,c as g,b,h as w,u as k,bn as x,f as v,e as N,bo as C,bp as _,J as E,aB as O,a1 as R,bq as j,$ as P,br as D,a6 as K}from"./index-OtYEJMgP.js";import{_ as S}from"./editOrganDialog.vue_vue_type_script_setup_true_lang-x7PXl95Z.js";const T={class:"flex flex-col gap-y-4 h-full table-container"},G=N("div",{class:"flex items-center justify-center w-full h-full"},[N("span",{class:"empty-text"},"暂无数据")],-1),W=r((F=((e,a)=>{for(var l in a||(a={}))n.call(a,l)&&i(e,l,a[l]);if(t)for(var l of t(a))s.call(a,l)&&i(e,l,a[l]);return e})({},{name:"PrincipalOrgIndex"}),a(F,l({__name:"index",setup(e){const[a,{showDialog:l,setDialogProps:t}]=o({title:"新增组织"}),n=d(!1),s=c({orgName:""}),i=u([]),r=function(e){const a=Math.round((e-326)/3);return[{title:"单位名称",width:a,minWidth:180,flexGrow:1,flexShrink:1,class:"whitespace-break-spaces",dataKey:"name",key:"name"},{title:"单位简称",width:a,minWidth:180,flexGrow:1,flexShrink:1,class:"whitespace-break-spaces",dataKey:"shortName",key:"shortName",align:C.CENTER},{title:"上级单位",width:a,minWidth:180,flexGrow:1,flexShrink:1,class:"whitespace-break-spaces",dataKey:"parentName",key:"parentName",align:C.CENTER},{title:"行政地市",width:a,minWidth:180,flexGrow:1,flexShrink:1,class:"whitespace-break-spaces",dataKey:"belongCityName",key:"belongCityName",align:C.CENTER},{title:"行政区县",width:a,minWidth:180,flexGrow:1,flexShrink:1,class:"whitespace-break-spaces",dataKey:"belongCountyName",key:"belongCountyName",align:C.CENTER},{title:"状态",width:120,dataKey:"enabledFlag",key:"enabledFlag",align:C.CENTER,cellRenderer:({cellData:e})=>"1"==e?b(_,{type:"success"},{default:()=>[v("启用")]}):b(_,{type:"danger"},{default:()=>[v("禁用")]})},{title:"操作",width:240,dataKey:"status",align:C.CENTER,cellRenderer:({rowData:e})=>b(E,null,["1"!==e.type&&e.parentId?b(x,{link:!0,type:"primary",onClick:()=>I(e)},{default:()=>[v("编辑")]}):b(E,null,null),/\d/.test(e.type)&&e.type<4?b(x,{link:!0,type:"primary",onClick:()=>F(e)},{default:()=>[v("添加")]}):b(E,null,null),(()=>{const a={reference:()=>b(x,{link:!0,type:"danger",onClick:e=>{e.stopPropagation(),e.preventDefault()}},{default:()=>[v("删除")]})};return"1"!==e.type&&e.isLeaf?b(j,{title:"确认删除?",onConfirm:()=>L(e)},a):b(E,null,null)})()])}]},N=e=>P(e)?(e.forEach((e=>{delete e.hasChildren,e.isLeaf=!(P(e.children)&&e.children.length),e.isLeaf||N(e.children)})),e):[],W=function(){n.value=!0;const{orgName:e}=s;O({orgName:e}).then((e=>{R!==e&&(i.value=N(e))})).finally((()=>{n.value=!1}))},F=(e=null)=>{l(!0,{data:e,type:"add"}),t({title:"新增组织"})},I=e=>{l(!0,{data:e,type:"edit"}),t({title:"编辑组织"})},L=e=>{const{id:a}=e;n.value=!0,D({orgId:a}).then((e=>{R!==e&&K.success("删除组织成功!")})).finally((()=>{n.value=!1,W()}))},V=()=>{W()};return p((()=>{W()})),(e,l)=>{const t=f("el-input"),o=f("el-form-item"),d=f("el-form"),c=f("el-table-v2"),u=f("el-auto-resizer"),p=h("loading");return m((y(),g("div",T,[b(d,{ref:"searchFormRef",inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:w((()=>[b(o,{label:"单位名称",class:"m-0"},{default:w((()=>[b(t,{modelValue:s.orgName,"onUpdate:modelValue":l[0]||(l[0]=e=>s.orgName=e),clearable:"",class:"mb-4",placeholder:"请输入单位名称",maxlength:"20"},null,8,["modelValue"])])),_:1}),b(o,{label:"",class:"m-0"},{default:w((()=>[b(k(x),{class:"basic-button",loading:n.value,onClick:W},{default:w((()=>[v(" 查询 ")])),_:1},8,["loading"])])),_:1})])),_:1},512),b(u,null,{default:w((({height:e,width:a})=>[b(c,{columns:r(a),"expand-column-key":"name",data:i.value,width:a,height:e},{empty:w((()=>[G])),_:2},1032,["columns","data","width","height"])])),_:1}),b(S,{onRegister:k(a),onConfirm:V},null,8,["onRegister"])])),[[p,n.value]])}}}))));var F;export{W as _};
