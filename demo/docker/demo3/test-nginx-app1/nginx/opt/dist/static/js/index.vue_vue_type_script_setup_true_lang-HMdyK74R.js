var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,a,l)=>new Promise(((t,o)=>{var s=e=>{try{r(l.next(e))}catch(a){o(a)}},n=e=>{try{r(l.throw(e))}catch(a){o(a)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,n);r((l=l.apply(e,a)).next())}));import{d as i,z as p,A as u,a0 as c,F as m,H as d,r as f,j as g,w as b,o as h,c as w,e as v,b as _,h as y,u as x,aa as N,f as C,M as j,a1 as z,a6 as k}from"./index-OtYEJMgP.js";import{g as P,d as S,i as I}from"./ConfigManage-kSH0aid8.js";import{u as O}from"./useThrottle-fY6V1GyW.js";import{d as V}from"./download-z--BcN7F.js";import{_ as U}from"./IpWhitelistDialog.vue_vue_type_script_setup_true_lang-MOXPAHj7.js";const D={class:"w-full h-full flex flex-col gap-y-4 table-container"},M={class:"flex flex-col h-full gap-y-4"},R=i((F=((e,a)=>{for(var l in a||(a={}))o.call(a,l)&&n(e,l,a[l]);if(t)for(var l of t(a))s.call(a,l)&&n(e,l,a[l]);return e})({},{name:"IpWhitelistIndex"}),a(F,l({__name:"index",setup(e){const[a,{showDialog:l,setDialogProps:t}]=p(),o=u(!1),s=c({ip:"",userName:"",realName:""}),n=c({pageNum:1,pageSize:10,total:0}),i=u([]),R=e=>{i.value=e},F=u([]),[W,$]=O((()=>{n.pageNum=1,A()}),800,{debounce:!0}),q=function(){t({title:"新增白名单"}),l(!0,{type:"add",data:null})},A=()=>{o.value=!0;const{pageSize:e,pageNum:a}=n,{ip:l,userName:t,realName:r}=s;P({ip:l,userName:t,realName:r,pageSize:e,pageNum:a}).then((e=>{if(e&&z!==e){const{rows:a=[],total:l=0}=e;F.value=a,n.total=Number(l)||0}})).finally((()=>{o.value=!1}))},E=e=>r(this,null,(function*(){if(!e||!e.length)return void k.warning("请选择要删除的白名单!");o.value=!0;const a=e.map((e=>e.id)).join(",");yield S({ids:a}).then((e=>{z!==e&&k.success("删除白名单成功!")})).finally((()=>{o.value=!1,A()}))})),H=()=>{i.value&&i.value.length?E(i.value):k.warning("请选择要删除的白名单!")},J=()=>r(this,null,(function*(){o.value=!0;const{ip:e,userName:a,realName:l}=s;yield I({ip:e,userName:a,realName:l}).then((e=>{if(e&&(null==e?void 0:e.data)){const a=e.headers["content-disposition"];let l="unknown";a&&(l=window.decodeURI(a.split("=")[1])),V(e.data,l)}})).finally((()=>{o.value=!1}))}));return m((()=>{W()})),d((()=>{$()})),(e,l)=>{const t=f("el-input"),r=f("el-form-item"),i=f("el-icon"),p=f("el-button"),u=f("el-form"),c=f("el-table-column"),m=f("el-popconfirm"),d=f("el-table"),z=f("el-pagination"),k=g("loading");return b((h(),w("div",D,[v("div",M,[_(u,{inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:y((()=>[_(r,{label:"姓名",class:"m-0"},{default:y((()=>[_(t,{modelValue:s.realName,"onUpdate:modelValue":l[0]||(l[0]=e=>s.realName=e),clearable:"",class:"mb-4",placeholder:"请输入姓名",maxlength:"20"},null,8,["modelValue"])])),_:1}),_(r,{label:"账号",class:"m-0"},{default:y((()=>[_(t,{modelValue:s.userName,"onUpdate:modelValue":l[1]||(l[1]=e=>s.userName=e),clearable:"",class:"mb-4",placeholder:"请输入账号",maxlength:"20"},null,8,["modelValue"])])),_:1}),_(r,{label:"IP地址",class:"m-0"},{default:y((()=>[_(t,{modelValue:s.ip,"onUpdate:modelValue":l[2]||(l[2]=e=>s.ip=e),class:"mb-4",clearable:"",maxlength:"20",placeholder:"请输入IP地址",formatter:e=>e.replace(/^\s*|\s*$/g,""),parser:e=>e.replace(/^\s*|\s*$/g,"")},{prefix:y((()=>[_(i,{class:"el-input__icon"},{default:y((()=>[_(x(N))])),_:1})])),_:1},8,["modelValue","formatter","parser"])])),_:1}),_(r,{label:"",class:"m-0"},{default:y((()=>[_(p,{class:"basic-button",onClick:x(W)},{default:y((()=>[C(" 查询 ")])),_:1},8,["onClick"]),_(p,{class:"basic-button",onClick:q},{default:y((()=>[C(" 新增 ")])),_:1}),_(p,{class:"basic-button",onClick:J},{default:y((()=>[C(" 导出 ")])),_:1}),_(p,{class:"basic-button",onClick:H},{default:y((()=>[C(" 批量删除 ")])),_:1})])),_:1})])),_:1}),_(d,{class:"w-full h-full",data:F.value,onSelectionChange:R},{default:y((()=>[_(c,{type:"selection",width:"80"}),_(c,{prop:"realName",align:"center",label:"姓名","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),_(c,{prop:"userName",align:"center",label:"账号","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),_(c,{prop:"ip",align:"center",label:"IP地址","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),_(c,{fixed:"right",label:"操作",width:"200",align:"center"},{default:y((({row:e})=>[_(m,{title:"确认删除?",onConfirm:a=>E([e])},{reference:y((()=>[_(p,{link:"",type:"danger",onClick:l[3]||(l[3]=j((()=>{}),["stop"]))},{default:y((()=>[C(" 删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),_(z,{"current-page":n.pageNum,"onUpdate:currentPage":l[4]||(l[4]=e=>n.pageNum=e),"page-size":n.pageSize,"onUpdate:pageSize":l[5]||(l[5]=e=>n.pageSize=e),background:"",small:"",layout:"total, sizes, prev, pager, next, jumper",total:n.total,"page-sizes":[10,20,30,40,50,100],onSizeChange:x(W),onCurrentChange:A},null,8,["current-page","page-size","total","onSizeChange"])]),_(U,{onRegister:x(a),onConfirm:x(W)},null,8,["onRegister","onConfirm"])])),[[k,o.value]])}}}))));var F;export{R as _};
