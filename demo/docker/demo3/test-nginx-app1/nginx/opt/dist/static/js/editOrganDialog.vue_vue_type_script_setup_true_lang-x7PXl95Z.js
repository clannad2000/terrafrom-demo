var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,d=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o;import{d as n,A as s,a0 as u,Y as i,a8 as b,r as m,o as p,g as c,h as g,e as f,b as h,f as y,u as v,ab as C,N as _,c as w,J as V,L as N,a9 as O,bj as x,a1 as j,bk as F,bl as $,a6 as I,bm as S}from"./index-OtYEJMgP.js";const U={class:"dialog-footer"},k=n((P=((e,l)=>{for(var a in l||(l={}))t.call(l,a)&&d(e,a,l[a]);if(o)for(var a of o(l))r.call(l,a)&&d(e,a,l[a]);return e})({},{name:"EditOrgDialog"}),l(P,a({__name:"editOrganDialog",emits:["visible-change","register","confirm"],setup(e,{emit:l}){const a=l;let o="";const t=s(null),r={parentId:[{required:!0,message:"请选择所属单位！",trigger:"blur"}],name:[{required:!0,message:"请填写单位名称！",trigger:"blur"},{validator(e,l,a){/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(l)?a():a(new Error("单位名称仅包含汉字,数字,大小写字母和特殊字符(-_)！"))},trigger:"blur"},{max:20,message:"单位名称长度不能超过20位！",trigger:"blur"}],code:[{required:!0,message:"请填写单位代码！",trigger:"blur"},{trigger:"blur",validator(e,l,a){/^[a-zA-Z0-9_-]+$/.test(l)?a():a(new Error("单位代码仅包含数字,大小写字母和特殊字符(-_)！"))}},{max:32,message:"单位代码长度不能超过32位！",trigger:"blur"}],enabledFlag:[{required:!0,message:"请选择是否启用！",trigger:"change"}]},d=s(!1),n=u({id:"",parentId:"",parentName:"",name:"",shortName:"",code:"",belongCityCode:"",belongCountyCode:"",sort:"",isShown:"",type:"",enabledFlag:""}),k=i([]),P=i([]),E=()=>{P.value=[],n.belongCityCode&&F(n.belongCityCode).then((e=>{j!==e&&(P.value=e)}))},q=()=>{n.belongCountyCode="",E()},[D,{closeDialog:A}]=b((e=>{const{type:l,data:a}=e;if(o=l,a){const{id:e,parentId:l,parentName:t,name:r,code:d,type:s,enabledFlag:u,shortName:i,belongCityCode:b,belongCountyCode:m,sort:p,isShown:c}=a||{};"add"===o?Object.assign(n,{parentId:e,parentName:r,type:`${Number(s)+1}`}):"edit"===o&&Object.assign(n,{id:e,name:r,code:d,type:s,parentId:l,parentName:t,enabledFlag:u,shortName:i,belongCityCode:b,belongCountyCode:m,sort:p,isShown:c}),k.value=[],x("320000").then((e=>{j!==e&&(k.value=e)})),E()}})),z=function(){var e,l;A(),d.value=!1,Object.keys(n).forEach((e=>{n[e]=""})),null==(e=t.value)||e.clearValidate(),null==(l=t.value)||l.resetFields()},R=function(){var e;null==(e=t.value)||e.validate((e=>{return l=this,t=null,r=function*(){if(e){d.value=!0;const{id:e,parentId:l,name:t,code:r,type:s,enabledFlag:u,shortName:i,belongCityCode:b,belongCountyCode:m,sort:p,isShown:c}=n,g={parentId:l,name:t,code:r,type:s,enabledFlag:u,shortName:i,belongCityCode:b,belongCountyCode:m,sort:p,isShown:c};"add"===o?$(g).then((e=>{j!==e&&(I.success("新增单位成功!"),A(),z(),a("confirm"))})).finally((()=>{d.value=!1})):"edit"===o?(g.id=e,S(g).then((e=>{j!==e&&(I.success("修改单位成功!"),A(),z(),a("confirm"))})).finally((()=>{d.value=!1}))):d.value=!1}},new Promise(((e,a)=>{var o=e=>{try{n(r.next(e))}catch(l){a(l)}},d=e=>{try{n(r.throw(e))}catch(l){a(l)}},n=l=>l.done?e(l.value):Promise.resolve(l.value).then(o,d);n((r=r.apply(l,t)).next())}));var l,t,r}))};return(e,l)=>{const a=m("el-input"),o=m("el-form-item"),s=m("el-option"),u=m("el-select"),i=m("el-radio"),b=m("el-radio-group"),x=m("el-button");return p(),c(v(O),{width:"720","show-fullscreen":!1,"show-close":!1,"destroy-on-close":"",center:"",onClose:z,onRegister:v(D)},{footer:g((()=>[f("span",U,[h(x,{class:"basic-button",disabled:d.value,onClick:z},{default:g((()=>[y(" 取消 ")])),_:1},8,["disabled"]),h(x,{class:"basic-button",loading:d.value,onClick:R},{default:g((()=>[y(" 保存 ")])),_:1},8,["loading"])])])),default:g((()=>[h(v(C),{ref_key:"refEditForm",ref:t,model:n,rules:r,"label-suffix":"：","label-width":"120px"},{default:g((()=>["1"!=n.type?(p(),c(o,{key:0,label:"上级单位",prop:"parentId"},{default:g((()=>[h(a,{modelValue:n.parentName,"onUpdate:modelValue":l[0]||(l[0]=e=>n.parentName=e),readonly:""},null,8,["modelValue"])])),_:1})):_("",!0),h(o,{label:"单位名称",prop:"name"},{default:g((()=>[h(a,{modelValue:n.name,"onUpdate:modelValue":l[1]||(l[1]=e=>n.name=e),clearable:"",maxlength:"20","show-word-limit":"",placeholder:"请填写单位名称",disabled:d.value,formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1}),h(o,{label:"单位简称",prop:"shortName"},{default:g((()=>[h(a,{modelValue:n.shortName,"onUpdate:modelValue":l[2]||(l[2]=e=>n.shortName=e),clearable:"",maxlength:"20","show-word-limit":"",placeholder:"请填写单位简称",disabled:d.value,formatter:e=>e.replace(/^\s*|\s*$|\n/g,""),parser:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1}),h(o,{label:"单位代码",prop:"code"},{default:g((()=>[h(a,{modelValue:n.code,"onUpdate:modelValue":l[3]||(l[3]=e=>n.code=e),clearable:"",maxlength:"32","show-word-limit":"",placeholder:"请填写单位代码",disabled:d.value,parser:e=>e.replace(/^\s*|\s*$|\n/g,""),formatter:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","disabled","parser","formatter"])])),_:1}),h(o,{label:"地市",prop:"belongCityCode"},{default:g((()=>[h(u,{modelValue:n.belongCityCode,"onUpdate:modelValue":l[4]||(l[4]=e=>n.belongCityCode=e),disabled:d.value,placeholder:"请选择地市",onChange:q},{default:g((()=>[(p(!0),w(V,null,N(k.value,(e=>(p(),c(s,{key:e.code,label:e.name,value:e.code},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),h(o,{label:"区县",prop:"belongCountyCode"},{default:g((()=>[h(u,{modelValue:n.belongCountyCode,"onUpdate:modelValue":l[5]||(l[5]=e=>n.belongCountyCode=e),disabled:d.value||!n.belongCityCode,placeholder:"请选择区县"},{default:g((()=>[(p(!0),w(V,null,N(P.value,(e=>(p(),c(s,{key:e.code,label:e.name,value:e.code},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),h(o,{label:"排序值",prop:"sort"},{default:g((()=>[h(a,{modelValue:n.sort,"onUpdate:modelValue":l[6]||(l[6]=e=>n.sort=e),clearable:"",type:"number",maxlength:"32","show-word-limit":"",placeholder:"请填写排序值",disabled:d.value,parser:e=>e.replace(/^\s*|\s*$|\n/g,""),formatter:e=>e.replace(/^\s*|\s*$|\n/g,"")},null,8,["modelValue","disabled","parser","formatter"])])),_:1}),h(o,{label:"展示统计",prop:"isShown"},{default:g((()=>[h(b,{modelValue:n.isShown,"onUpdate:modelValue":l[7]||(l[7]=e=>n.isShown=e),disabled:d.value,class:"ml-4"},{default:g((()=>[h(i,{label:"1"},{default:g((()=>[y("展示")])),_:1}),h(i,{label:"0"},{default:g((()=>[y("不展示")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1}),h(o,{label:"是否启用",prop:"enabledFlag"},{default:g((()=>[h(b,{modelValue:n.enabledFlag,"onUpdate:modelValue":l[8]||(l[8]=e=>n.enabledFlag=e),disabled:d.value,class:"ml-4"},{default:g((()=>[h(i,{label:"1"},{default:g((()=>[y("启用")])),_:1}),h(i,{label:"0"},{default:g((()=>[y("停用")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1},8,["model"])])),_:1},8,["onRegister"])}}}))));var P;export{k as _};
