var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,n=(e,a,t)=>new Promise(((l,o)=>{var s=e=>{try{n(t.next(e))}catch(a){o(a)}},r=e=>{try{n(t.throw(e))}catch(a){o(a)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(s,r);n((t=t.apply(e,a)).next())}));import{A as i,B as c}from"./StatisticalCenter-fzPo9Omj.js";import{d as p,z as u,n as d,a0 as f,Y as g,A as b,at as m,r as v,o as h,c as w,e as x,J as D,L as y,t as C,I as S,b as j,h as k,a4 as I,u as O,a2 as P,v as R,a5 as N,R as _,U as A,a1 as E,X,_ as z}from"./index-OtYEJMgP.js";import{d as L}from"./constants-uiyZ18jc.js";import{u as V}from"./useAutoScroll-cuZfK63C.js";import F from"./PersonPatrolLogDialog-csbkDa4f.js";import M from"./RankDialog-VYZfg4FO.js";import"./download-z--BcN7F.js";const T=e=>(_("data-v-430e43bb"),e=e(),A(),e),U={class:"item"},Z={class:"item-title gap-x-4"},q=T((()=>x("span",{class:"item-title-text"},"人员巡查排名",-1))),B={class:"flex-1 flex flex-row justify-end gap-x-4"},H={class:"flex flex-row"},J=["onClick"],K={class:"btn-text"},W={class:"flex-1 flex flex-row"},Y={class:"item-content table-container gap-y-2"},G={class:"w-full flex flex-row items-center justify-end"},Q=T((()=>x("span",{class:"text-white text-sm"},"巡查人数：",-1))),$={class:"text-[#00e7e8] text-sm font-bold"},ee={class:"flex-1 flex w-full"},ae=p((te=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&r(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&r(e,t,a[t]);return e})({},{name:"PersonnelPatrolRank"}),le={__name:"index",props:{ipSource:{default:""},beginDate:{default:L.range.default[0]},endDate:{default:L.range.default[1]}},setup(e,{expose:a}){const t=e,[l,{showDialog:o,setDialogProps:s}]=u(),[r,{showDialog:p,setDialogProps:_}]=u(),A=[{label:"全部",value:"all"},{label:"巡查中心",value:"XCZX"},{label:"回溯中心",value:"HSZX"}],z=d((()=>({nodeKey:"id",props:{label:e=>e.shortName||e.name,children:"children"}}))),L=f({ipSource:"",beginDate:"",endDate:"",source:"all",orgId:""}),T=g(),ae=d((()=>T.value.layout.table.refs.bodyWrapper.firstElementChild.firstElementChild)),{start:te,stop:le}=V({scrollRef:ae}),oe=()=>{le()},se=()=>{ne.value.length>7&&te()},re=b(!1),ne=g([]),ie=N((()=>n(this,null,(function*(){const{ipSource:e,beginDate:a,endDate:t,source:l,orgId:o}=L,s={ipSource:e,beginDate:a,endDate:t,source:"all"==l?"":l,orgId:o,pageNum:1,pageSize:10};le(),re.value=!0,ne.value=[],i(s).then((e=>{if(E!==e){const{rows:a=[]}=e;ne.value=a,pe(),X((()=>{a.length>7&&te()}))}})).catch((e=>{console.log(e)})).finally((()=>{re.value=!1}))}))),1e3),ce=b("0"),pe=N((()=>n(this,null,(function*(){const{ipSource:e,beginDate:a,endDate:t,source:l,orgId:o}=L,s={ipSource:e,beginDate:a,endDate:t,source:"all"==l?"":l,orgId:o};re.value=!0,c(s).then((e=>{E!==e&&(ce.value=e||"0")})).finally((()=>{re.value=!1}))}))),1e3),ue=e=>{const{ipSource:a,beginDate:t,endDate:l,source:r,orgId:n}=L,i={ipSource:a,beginDate:t,endDate:l,source:"all"==r?"":r,orgId:n,userName:e.userName,userRealName:e.userRealName};s({title:"人员巡查明细"}),o(!0,{type:"view",data:i})},de=()=>{const{ipSource:e,beginDate:a,endDate:t,source:l,orgId:o}=L,s={ipSource:e,beginDate:a,endDate:t,source:"all"==l?"":l,orgId:o};_({title:"人员巡查排名"}),p(!0,{type:"view",data:s})};return m((()=>t),(()=>{const{ipSource:e,beginDate:a,endDate:l}=t;Object.assign(L,{beginDate:a,endDate:l,ipSource:e})}),{deep:!0,immediate:!0}),a({loadData:ie}),(e,a)=>{const t=v("el-tree-select"),o=v("el-form-item"),s=v("el-form"),n=v("el-table-column"),i=v("el-table"),c=v("el-auto-resizer");return h(),w("div",U,[x("div",Z,[q,x("div",B,[x("div",H,[(h(),w(D,null,y(A,(e=>x("div",{key:e.value,class:C(["tab-btn cursor-pointer",{active:L.source===e.value}]),onClick:a=>{return t=e.value,L.source=t,void ie();var t}},[x("span",K,S(e.label),1)],10,J))),64))]),x("div",W,[j(s,{inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:k((()=>[j(o,{class:"m-0"},{default:k((()=>[j(t,I({modelValue:L.orgId,"onUpdate:modelValue":a[0]||(a[0]=e=>L.orgId=e),data:O(P)().cityOrgTreeAll,"render-after-expand":!1,clearable:""},z.value,{"check-strictly":!0,"highlight-current":!0,"expand-on-click-node":!1,placeholder:"请选择单位",onChange:O(ie)}),null,16,["modelValue","data","onChange"])])),_:1})])),_:1})])]),x("span",{class:"text-[#02e8ff] text-sm cursor-pointer",onClick:de},"更多>>>")]),x("div",Y,[x("div",G,[Q,x("span",$,S(ce.value),1)]),x("div",ee,[j(c,null,{default:k((({height:e,width:a})=>[j(i,{ref_key:"tableRef",ref:T,class:"cursor-pointer",height:e,data:ne.value,"show-overflow-tooltip":"",style:R({width:a+"px"}),onMouseover:oe,onMouseleave:se,onRowClick:ue},{default:k((()=>[j(n,{type:"index",label:"排名",width:"80",align:"center"}),j(n,{prop:"userRealName",align:"center",label:"用户","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),j(n,{prop:"userName",align:"center",label:"账号","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),j(n,{prop:"userCityOrgName",align:"center",label:"所属单位","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),j(n,{prop:"userOrgName",align:"center",label:"所属组织","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),j(n,{prop:"patrolTimeLongFormat",align:"center",label:"巡查时长","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}}),j(n,{prop:"patrolCount",align:"center",label:"巡查次数","show-overflow-tooltip":{popperClass:"max-w-xs whitespace-break-spaces"}})])),_:2},1032,["height","data","style"])])),_:1})])]),j(F,{onRegister:O(l)},null,8,["onRegister"]),j(M,{onRegister:O(r)},null,8,["onRegister"])])}}},a(te,t(le))));var te,le;const oe=z(ae,[["__scopeId","data-v-430e43bb"]]);export{oe as default};
