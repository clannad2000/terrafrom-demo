var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{c as i}from"./index-5mLQMBux.js";import{B as s}from"./index.esm.min-p6OgvXm7.js";import{p as c}from"./StatisticalCenter-fzPo9Omj.js";import{d as u,a0 as m,A as d,n as f,V as p,r as g,o as v,c as b,e as C,b as h,h as y,u as F,a2 as w,J as j,L as x,g as O,I as R,a5 as S,R as E,U as I,a1 as _,_ as V}from"./index-OtYEJMgP.js";import{e as A}from"./mitt-ei5ABelY.js";import{u as P,L as D,i as L}from"./installCanvasRenderer-kp6nwiR2.js";import{i as B}from"./install-wLyK8H0F.js";import{i as N}from"./install-q7ZRUXrs.js";import{i as k}from"./install-50C6z8uZ.js";import"./Axis-xmqQ_bGV.js";import"./sectorHelper-nVwTOMBE.js";const z={class:"item"},W=(e=>(E("data-v-632ba65d"),e=e(),I(),e))((()=>C("div",{class:"item-title"},[C("span",{class:"item-title-text"},"设备版本统计")],-1))),U={class:"item-content table-container"},q={class:"flex-1 flex w-full"},G={class:"w-full h-full grid grid-cols-3 px-4"},H=u((J=((e,a)=>{for(var t in a||(a={}))o.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))r.call(a,t)&&n(e,t,a[t]);return e})({},{name:"DeviceVersion"}),a(J,t({__name:"index",setup(e){P([B,N,k,L]);const a=m({cityOrgId:""}),t=d(0),l=d([{innerRingColorEnd:"#FEE069",innerRingColorStart:"#F88F3B",outerRingColor:"#ffed7133",percentage:0,percentageColor:"#FFED71",value:0,name:"最新版本",field:"newVersionCount"},{innerRingColorEnd:"#05C2FA",innerRingColorStart:"#1680E7",outerRingColor:"#2790cf33",percentage:0,percentageColor:"#38B5F7",value:0,name:"无版本号",field:"notVersionCount"},{innerRingColorEnd:"#FCFCFC",innerRingColorStart:"#B9C4C5",outerRingColor:"#aab7b833",percentage:0,percentageColor:"#AAB7B8",value:0,name:"未及时更新",field:"oldVersionCount"}]),o=f((()=>e=>({grid:{left:0,bottom:0,top:0,containLabel:!0},title:{text:"{a|"+e.percentage+"}{b|%}\n{c|"+e.value+"}",x:"center",y:"center",itemGap:0,textStyle:{rich:{a:{color:e.percentageColor,fontSize:24,fontWeight:900,fontFamily:"DIN"},b:{color:e.percentageColor,fontSize:12,padding:[10,0,0,2]},c:{color:"#FFFFFF",fontSize:14,fontWeight:900,fontFamily:"DIN"}}}},series:[{name:"内环",type:"pie",clockWise:!0,radius:["80%","70%"],center:["50%","50%"],itemStyle:{normal:{borderRadius:0,label:{show:!1},labelLine:{show:!1}}},hoverAnimation:!1,color:[new D(0,0,0,1,[{offset:0,color:e.innerRingColorStart},{offset:1,color:e.innerRingColorEnd}])],data:[{value:100-e.percentage,name:"",itemStyle:{normal:{color:"#fff0",label:{show:!1},labelLine:{show:!1}}}},{name:"",value:e.percentage}]},{name:"外环",radius:["80%","70%"],center:["50%","50%"],type:"pie",silent:!0,animation:!1,color:e.outerRingColor,data:[{label:{show:!1},labelLine:{normal:{smooth:!0,lineStyle:{width:0}}},value:0,hoverAnimation:!1}]}]}))),r=d(!1),n=S((()=>{return e=this,o=null,n=function*(){r.value=!0,t.value=0,l.value.forEach((e=>{e.percentage=0,e.value=0}));const{cityOrgId:e}=a;c({cityOrgId:e}).then((e=>{_!==e&&(t.value=e.allCount||0,l.value.forEach((a=>{a.percentage=e[a.field]?Number(i("a / b * 100 | <=2",{a:e[a.field],b:e.totalCount})):0,a.value=Number(e[a.field])||0})))})).finally((()=>{r.value=!1}))},new Promise(((a,t)=>{var l=e=>{try{i(n.next(e))}catch(a){t(a)}},r=e=>{try{i(n.throw(e))}catch(a){t(a)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,r);i((n=n.apply(e,o)).next())}));var e,o,n}),1e3);return p((()=>{A.on("StatisticalCenterDeviceStatisticsReload",(()=>{n()}))})),(e,t)=>{const r=g("el-option"),i=g("el-select"),c=g("el-form-item"),u=g("el-form");return v(),b("div",z,[W,C("div",U,[h(u,{inline:!0,"label-suffix":"：",class:"w-full table-query"},{default:y((()=>[h(c,{class:"m-0"},{default:y((()=>[h(i,{modelValue:a.cityOrgId,"onUpdate:modelValue":t[0]||(t[0]=e=>a.cityOrgId=e),placeholder:"请选择市级公司",clearable:"",onFocus:F(w)().loadCityOrg,onChange:F(n)},{default:y((()=>[(v(!0),b(j,null,x(F(w)().cityOrg,(e=>(v(),O(r,{key:e.id,value:e.id,label:e.shortName||e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onFocus","onChange"])])),_:1})])),_:1}),C("div",q,[C("div",G,[(v(!0),b(j,null,x(l.value,(e=>(v(),b("div",{key:e.field,class:"chart-item"},[h(F(s),{ref_for:!0,ref:"vchart",class:"w-full h-3/5",option:o.value(e),autoresize:""},null,8,["option"]),C("span",null,R(e.name),1)])))),128))])])])])}}}))));var J;const K=V(H,[["__scopeId","data-v-632ba65d"]]);export{K as default};
