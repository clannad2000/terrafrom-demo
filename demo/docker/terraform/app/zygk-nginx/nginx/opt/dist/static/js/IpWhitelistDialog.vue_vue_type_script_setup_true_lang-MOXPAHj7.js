var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r;import{a as i}from"./ConfigManage-kSH0aid8.js";import{d as n,z as u,a8 as c,A as d,Y as m,a0 as p,H as f,r as g,o as b,g as v,h,e as y,b as w,f as P,u as N,ab as O,c as _,J as j,L as x,a9 as I,ac as k,$ as V,a1 as C,a6 as D}from"./index-OtYEJMgP.js";import{U as R}from"./index-fHT9WYUA.js";const E={class:"dialog-footer"},U=n((q=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&o(e,l,a[l]);if(r)for(var l of r(a))t.call(a,l)&&o(e,l,a[l]);return e})({},{name:"IpWhitelistDialog"}),a(q,l({__name:"IpWhitelistDialog",emits:["register","confirm"],setup(e,{emit:a}){const[l,{showDialog:r,setDialogProps:s}]=u();let t="";const o=a,[n,{closeDialog:U}]=c((e=>{const{type:a,data:l}=e;if(t=a,"edit"===a){const{id:e,name:a,value:r,remark:s}=l||{};Object.assign(K,{id:e,name:a,value:r,remark:s})}})),q=d(!1),J=d(null),W={userNames:[{required:!0,message:"请选择用户！",trigger:"change"}],ip:[{required:!0,message:"请填写IP地址！",trigger:"blur"},{validator(e,a,l){""===a||void 0===a||null==a?l(new Error("请输入正确的IP地址")):k(a)||""===a?l():l(new Error("请输入正确的IP地址"))},trigger:"blur"},{max:64,message:"IP地址长度不能超过64位！",trigger:"blur"}]},z=e=>{const{personnel:a=[]}=e;V(a)&&(K.userNames=a.map((e=>e.userName)),H.value=a)},A=d(null),F=e=>{var a;e&&(null==(a=A.value)||a.blur(),s({title:"选择人员"}),r(!0,{type:"add",tabs:["principalOrg"]}))},H=m([]),K=p({id:"",userNames:[],ip:""}),L=function(){var e;q.value=!1,U(),t="",Object.assign(K,{id:"",userNames:[],ip:""}),null==(e=J.value)||e.clearValidate()},M=function(){var e;null==(e=J.value)||e.validate((e=>{return a=this,l=null,r=function*(){if(e){q.value=!0;const{userNames:e,ip:a}=K;"add"===t?i({userNames:e,ip:a}).then((e=>{C!==e&&(D.success("添加成功！"),L(),o("confirm"))})).finally((()=>{q.value=!1})):q.value=!1}},new Promise(((e,s)=>{var t=e=>{try{i(r.next(e))}catch(a){s(a)}},o=e=>{try{i(r.throw(e))}catch(a){s(a)}},i=a=>a.done?e(a.value):Promise.resolve(a.value).then(t,o);i((r=r.apply(a,l)).next())}));var a,l,r}))};return f((()=>{L()})),(e,a)=>{const r=g("el-option"),s=g("el-select"),t=g("el-form-item"),o=g("el-input"),i=g("el-button");return b(),v(N(I),{width:"480px","show-fullscreen":!1,"show-close":!1,"close-on-click-modal":!1,"destroy-on-close":"",center:"",onClose:L,onRegister:N(n)},{footer:h((()=>[y("span",E,[w(i,{class:"basic-button",disabled:q.value,onClick:L},{default:h((()=>[P(" 取消 ")])),_:1},8,["disabled"]),w(i,{class:"basic-button",loading:q.value,onClick:M},{default:h((()=>[P(" 保存 ")])),_:1},8,["loading"])])])),default:h((()=>[w(N(O),{ref_key:"refConfigForm",ref:J,model:K,rules:W,"label-width":"120px"},{default:h((()=>[w(t,{label:"用户",prop:"userNames"},{default:h((()=>[w(s,{ref_key:"refPersonnel",ref:A,modelValue:K.userNames,"onUpdate:modelValue":a[0]||(a[0]=e=>K.userNames=e),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"请选择用户",onVisibleChange:F},{default:h((()=>[(b(!0),_(j,null,x(H.value,(e=>(b(),v(r,{key:e.userName,label:e.realName,value:e.userName},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),w(t,{label:"IP地址",prop:"ip"},{default:h((()=>[w(o,{modelValue:K.ip,"onUpdate:modelValue":a[1]||(a[1]=e=>K.ip=e),clearable:"",maxlength:"64","show-word-limit":"",placeholder:"请填写IP地址",disabled:q.value,formatter:e=>e.replace(/[^0-9.]/g,""),parser:e=>e.replace(/[^0-9.]/g,"")},null,8,["modelValue","disabled","formatter","parser"])])),_:1})])),_:1},8,["model"]),w(R,{onRegister:N(l),onConfirm:z},null,8,["onRegister"])])),_:1},8,["onRegister"])}}}))));var q;export{U as _};
